数据库查询是 IO 操作，这比内存中的操作慢数个数量级，因此将常用的数据存储到缓存中，可以极大地减少数据库查询操作，从而提高网站性能和响应速度。
常用缓存系统有 Memcached 和 Redis，前者轻量级，纯内存缓存软件，不能自动同步数据到硬盘；后者功能强大、重量级。

## 1. Memcached
这是一种高性能的分布式内存对象缓存系统，通过在内存中维护一张统一的、巨大的 Hash 表来存储各种各样的数据，包括图像、视频等。因为数据存储在内存中，且不能自动同步到硬盘，因此不建议存储重要的数据。其存储方式是以键值对形式。

### 安装
```shell
sudo pacman -S memcached
```

### telnet 操作 Memcached

### python 操作 Memcached

### Memcached 的安全性

## 2. Redis
Redis 是一种 NoSQL 数据库，数据默认存储在内存中，也可以同步到硬盘，比 Memcached 支持更多的数据结构（list、set、sorted set、hash 等）

### 使用场景
- 登录会话存储
- 在线人数/计数器
- 作为消息队列
- 常用的数据缓存
- 首页数据缓存
- 好友关系
- 发布和订阅功能

### 与 Memcached 比较

### 安装与使用
```shell
sudo pacman -S redis
```

Redis 安装完成后会自动启动：
![[redis-start.png]]
手动启动可以使用 `service redis-server start` 启动。

停止运行：`service redis-server stop`

使用：连接之前先要启动 `redis-server` 服务，然后使用 `redis-cli` 连接：
```shell
redis-cli -h [ip] -p [port]
```
redis-server 默认端口是 6379，连接本机的 redis-server 命令如下：
```shell
redis-cli -h 127.0.0.1 -p 6379
```

![[redis-server-cli.png]]

### 操作命令
#### 添加数据
```redis
set key value EX timeout
```

#### 删除数据


#### 设置过期时间


#### 查看过期时间


#### 查看所有 key


#### 列表操作


#### 集合操作


#### 哈希操作


#### 事务操作


#### 发布、订阅操作


### 同步数据到硬盘
同步策略有两种，RDB（Redis DataBase）和 AOF（Append Only File），可以通过修改 `/etc/redis/redis.conf` 切换不同的同步策略。

#### RDB

#### AOF

### 设置密码
配置 `/etc/redis/redis.conf` 中的 `requirepass` 实现加密访问，这样更安全。

### Python 操作 Redis