## 初识Python

### Python简介

#### Python的历史

1. 1989年圣诞节：Guido von Rossum开始写Python语言的编译器。
2. 1991年2月：第一个Python编译器（同时也是解释器）诞生，它是用C语言实现的（后面），可以调用C语言的库函数。在最早的版本中，Python已经提供了对“类”，“函数”，“异常处理”等构造块的支持，还有对列表、字典等核心数据类型，同时支持以模块为基础来构造应用程序。
3. 1994年1月：Python 1.0正式发布。
4. 2000年10月16日：Python 2.0发布，增加了完整的[垃圾回收](https://zh.wikipedia.org/wiki/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6_(%E8%A8%88%E7%AE%97%E6%A9%9F%E7%A7%91%E5%AD%B8))，提供了对[Unicode](https://zh.wikipedia.org/wiki/Unicode)的支持。与此同时，Python的整个开发过程更加透明，社区对开发进度的影响逐渐扩大，生态圈开始慢慢形成。
5. 2008年12月3日：Python 3.0发布，它并不完全兼容之前的Python代码，不过因为目前还有不少公司在项目和运维中使用Python 2.x版本，所以Python 3.x的很多新特性后来也被移植到Python 2.6/2.7版本中。

目前我使用的Python 3.7.x的版本是在2018年发布的，Python的版本号分为三段，形如A.B.C。其中A表示大版本号，一般当整体重写，或出现不向后兼容的改变时，增加A；B表示功能更新，出现新功能时增加B；C表示小的改动（例如：修复了某个Bug），只要有修改就增加C。如果对Python的历史感兴趣，可以阅读名为[《Python简史》](http://www.cnblogs.com/vamei/archive/2013/02/06/2892628.html)的网络文章。

#### Python的优缺点

Python的优点很多，简单的可以总结为以下几点。

1. 简单明了，学习曲线低，比很多编程语言都容易上手。
2. 开放源代码，拥有强大的社区和生态圈，尤其是在数据分析和机器学习领域。
3. 解释型语言，天生具有平台可移植性，代码可以工作于不同的操作系统。
4. 对两种主流的编程范式（面向对象编程和函数式编程）都提供了支持。
5. 代码规范程度高，可读性强，适合有代码洁癖和强迫症的人群。

Python的缺点主要集中在以下几点。

1. 执行效率稍低，对执行效率要求高的部分可以由其他语言（如：C、C++）编写。
2. 代码无法加密，但是现在很多公司都不销售卖软件而是销售服务，这个问题会被弱化。
3. 在开发时可以选择的框架太多（如Web框架就有100多个），有选择的地方就有错误。

#### Python的应用领域

目前Python在Web应用后端开发、云基础设施建设、DevOps、网络数据采集（爬虫）、自动化测试、数据分析、机器学习等领域都有着广泛的应用。

### 安装Python解释器

想要开始Python编程之旅，首先得在自己使用的计算机上安装Python解释器环境，下面将以安装官方的Python解释器为例，讲解如何在不同的操作系统上安装Python环境。官方的Python解释器是用C语言实现的，也是使用最为广泛的Python解释器，通常称之为CPython。除此之外，Python解释器还有Java语言实现的Jython、C#语言实现的IronPython以及PyPy、Brython、Pyston等版本，有兴趣的读者可以自行了解。

#### Windows环境

可以在[Python官方网站](https://www.python.org)下载到Python的Windows安装程序（exe文件），需要注意的是如果在Windows 7环境下安装Python 3.x，需要先安装Service Pack 1补丁包（可以通过一些工具软件自动安装系统补丁的功能来安装），安装过程建议勾选“Add Python 3.x to PATH”（将Python 3.x添加到PATH环境变量）并选择自定义安装，在设置“Optional Features”界面最好将“pip”、“tcl/tk”、“Python test suite”等项全部勾选上。强烈建议选择自定义的安装路径并保证路径中没有中文。安装完成会看到“Setup was successful”的提示。如果稍后运行Python程序时，出现因为缺失一些动态链接库文件而导致Python解释器无法工作的问题，可以按照下面的方法加以解决。

如果系统显示api-ms-win-crt\*.dll文件缺失，可以参照[《api-ms-win-crt\*.dll缺失原因分析和解决方法》](<https://zhuanlan.zhihu.com/p/32087135>)一文讲解的方法进行处理或者直接在[微软官网](https://www.microsoft.com/zh-cn/download/details.aspx?id=48145)下载Visual C++ Redistributable for Visual Studio 2015文件进行修复；如果是因为更新Windows的DirectX之后导致某些动态链接库文件缺失问题，可以下载一个[DirectX修复工具](<https://dl.pconline.com.cn/download/360074-1.html>)进行修复。

#### Linux环境

在ArchLinux中安装Python非常简便，只需要`sudo pacman -S python`即可，这会默认安装最新的稳定版python。其他Linux发行版使用各自软件包管理器大多也可以简便地完成安装。

##### 管理不同版本的Python
- 使用`conda`可以便捷地管理Python环境，在AUR中提供两个版本的`conda`：
	- `Anaconda`：参考博客：[Linux环境下使用Conda搭建和自由切换Python环境](https://cloud.tencent.com/developer/article/1949339)
		- 安装`Anaconda`及激活（解除）`anaconda environment`：
			- `yay -S anaconda`
			- `source /opt/anaconda/bin/activate root`
			- or `source /opt/anaconda/bin/deactivate root`
			- ![[activate-conda-env.png]]
		- `Anaconda`官方文档：[CONDA](https://docs.conda.io/projects/conda/en/stable/)，以及简要介绍[[Conda常用命令]]；
		- 使用`anaconda`创建python环境的步骤：
			1. `conda create -n py39 python=3.9.15 -y`，其输出结果应为：[[`conda create py39 python=3.9.15` output]]
			2. 激活`python3.9`环境：`conda activate py39`，
			3. 解除`python3.9`环境：`conda deactivate`,
			4. 查看当前已安装多少个python环境：`conda env list`
			5. ![[conda-switch-python-env.png]]
		- 其他conda的基础操作：[[Conda常用命令]]；
	- `Miniconda`：Anaconda 的轻量级替代方案，它安装软件包管理器，但默认不安装科学计算软件包
		- （判断自己需要`anaconda`还是`miniconda`：[Anaconda or Miniconda?](https://docs.conda.io/projects/conda/en/stable/user-guide/install/download.html#id1)）
- 以及安装`python-virtualenv`包可以为Python建立独立的虚拟环境，使得其中的项目可以使用指定的python版本和对应软件包，而不影响其他virtualenv环境或系统python软件包
	- `sudo pacman -S python-vitualenv`，
	- 

#### macOS环境

macOS也自带了Python 2.x版本，可以通过[Python的官方网站](https://www.python.org)提供的安装文件（pkg文件）安装Python 3.x的版本。默认安装完成后，可以通过在终端执行`python`命令来启动2.x版本的Python解释器，启动3.x版本的Python解释器需要执行`python3`命令。

### 运行Python程序

#### 确认Python的版本

可以Windows的命令行提示符中键入下面的命令。

```Shell
python --version
```
在Linux或macOS系统的终端中键入下面的命令。

```Shell
python3 --version
```

当然也可以先输入`python`或`python3`进入交互式环境，再执行以下的代码检查Python的版本。

```Python
import sys

print(sys.version_info)
print(sys.version)
```

#### 编写Python源代码

可以用文本编辑工具（推荐使用[Sublime](<https://www.sublimetext.com/>)、[Visual Studio Code](<https://code.visualstudio.com/>)等高级文本编辑工具）编写Python源代码并用py作为后缀名保存该文件，代码内容如下所示。

```Python
print('hello, world!')
```

#### 运行程序

切换到源代码所在的目录并执行下面的命令，看看屏幕上是否输出了"hello, world!"。

```Shell
python hello.py
```

或

```Shell
python3 hello.py
```

#### 代码中的注释

注释是编程语言的一个重要组成部分，用于在源代码中解释代码的作用从而增强程序的可读性和可维护性，当然也可以将源代码中不需要参与运行的代码段通过注释来去掉，这一点在调试程序的时候经常用到。

注释在随源代码进入预处理器或编译时会被移除，不会在目标代码中保留也不会影响程序的执行结果。

1. 单行注释 - 以#和空格开头的部分
2. 多行注释 - 三个引号开头，三个引号结尾

```Python
"""
第一个Python程序 - hello, world!
向伟大的Dennis M. Ritchie先生致敬

Version: 0.1
Author: Lsj
"""
print('hello, world!')
# print("你好, 世界！")
```

### Python开发工具

#### IDLE - 自带的集成开发工具

IDLE是安装Python环境时自带的集成开发工具，如下图所示：

![](python-idle.png)
用来快速简单的编写或运行脚本，IDLE或许是可行的选择。但在稍大的软件开发中，它就会力不从心

#### IPython - 更好的交互式编程工具

IPython是一种基于Python的交互式解释器。相较于原生的Python交互式环境，IPython提供了更为强大的编辑和交互功能。可以通过Python的包管理工具pip安装IPython，具体的操作如下所示。

```Shell
pip install ipython
```

或

```Shell
pip3 install ipython
```

安装成功后，可以通过下面的ipython命令启动IPython，如下图所示。

![](python-ipython.png)

#### Sublime Text - 高级文本编辑器

![](python-sublime.png)

- 首先可以通过[官方网站](https://www.sublimetext.com/)下载安装程序安装Sublime Text 3或Sublime Text 2。

- 安装包管理工具。
  1. 通过快捷键Ctrl+`或者在View菜单中选择Show Console打开控制台，输入下面的代码。

  - Sublime 3

  ```Python
  import  urllib.request,os;pf='Package Control.sublime-package';ipp=sublime.installed_packages_path();urllib.request.install_opener(urllib.request.build_opener(urllib.request.ProxyHandler()));open(os.path.join(ipp,pf),'wb').write(urllib.request.urlopen('http://sublime.wbond.net/'+pf.replace(' ','%20')).read())
  ```
  - Sublime 2

  ```Python
  import  urllib2,os;pf='Package Control.sublime-package';ipp=sublime.installed_packages_path();os.makedirs(ipp)ifnotos.path.exists(ipp)elseNone;urllib2.install_opener(urllib2.build_opener(urllib2.ProxyHandler()));open(os.path.join(ipp,pf),'wb').write(urllib2.urlopen('http://sublime.wbond.net/'+pf.replace(' ','%20')).read());print('Please restart Sublime Text to finish installation')
  ```
  2. 在浏览器中输入  https://sublime.wbond.net/Package%20Control.sublime-package 下载包管理工具的安装包，并找到安装Sublime目录下名为&quot;Installed Packages&quot;的目录，把刚才下载的文件放到这个文件加下，然后重启Sublime Text就搞定了。


- 安装插件。通过Preference菜单的Package Control或快捷键Ctrl+Shift+P打开命令面板，在面板中输入Install Package就可以找到安装插件的工具，然后再查找需要的插件。我们推荐大家安装以下几个插件：

  - SublimeCodeIntel - 代码自动补全工具插件。
  - Emmet - 前端开发代码模板插件。
  - Git - 版本控制工具插件。
  - Python PEP8 Autoformat - PEP8规范自动格式化插件。
  - ConvertToUTF8 - 将本地编码转换为UTF-8。

#### Visual Studio Code
安装Visual Studio Code也十分方便，在Arch Linux中使用命令`yay -S visual-studio-code-bin`即可，或者其他发行版可以找到`.deb`或`.rpm`的发行包以及各自的安装方式，不一而足。

vscode提供了丰富的插件市场，可以满足大多数情况下编写Python代码的需求。

#### PyCharm - Python开发神器

PyCharm的安装、配置和使用在[《玩转PyCharm》](玩转PyCharm.md)进行了介绍，有兴趣的读者可以选择阅读。

![](python-pycharm.png)

## 练习
### 1. The Zen of Python

在Python交互式环境中输入下面的代码并查看结果，请尝试将看到的内容翻译成中文：
```Python
import this
```

  > **说明**：输入上面的代码，在Python的交互式环境中可以看到Tim Peter撰写的[“Python之禅”](../Python之禅.md)，里面讲述的道理不仅仅适用于Python，也适用于其他编程语言。

```python
>>> import this
The Zen of Python, by Tim Peters  
  
Beautiful is better than ugly.  
Explicit is better than implicit.  
Simple is better than complex.  
Complex is better than complicated.  
Flat is better than nested.  
Sparse is better than dense.  
Readability counts.  
Special cases aren't special enough to break the rules.  
Although practicality beats purity.  
Errors should never pass silently.  
Unless explicitly silenced.  
In the face of ambiguity, refuse the temptation to guess.  
There should be one-- and preferably only one --obvious way to do it.  
Although that way may not be obvious at first unless you're Dutch.  
Now is better than never.  
Although never is often better than *right* now.  
If the implementation is hard to explain, it's a bad idea.  
If the implementation is easy to explain, it may be a good idea.  
Namespaces are one honking great idea -- let's do more of those!
```

> 翻译：
> 《 Python 之禅》Tim Perters
> 美优于丑
> 明确优于隐晦
> 简单优于复杂
> 复杂优于繁冗
> 直率优于嵌套
> 稀疏优于稠密
> 可读性十分重要
> 特例不足以打破规则
> 实用主义胜于纯粹主义
> 错误永远不应默许
> 除非明确可以静默
> 面对模棱两可，拒绝猜测的思维惯性
> 只应有一种——更可能只有一种——显然的方法实现它
> 尽管那种方法可能最初看起来并不显然，除非你是荷兰人（指Python之父）
> 现在开始胜过永不行动
> 尽管不做通常优于盲目行动
> 如果这种实现方式难以描述，那就是一种糟糕的方式
> 如果这种实现方式易于表达，那可能是个优秀的想法
> 命名空间是如此拍案叫绝——让我们多加使用！

### 2. 学习使用turtle在屏幕上绘制图形。

> **说明**：turtle是Python内置的一个非常有趣的模块，特别适合对计算机程序设计进行初体验的小伙伴，它最早是Logo语言的一部分，Logo语言是Wally Feurzig和Seymour Papert在1966发明的编程语言。


```Python
   import turtle
   
   turtle.pensize(4)
   turtle.pencolor('red')
   
   turtle.forward(100)
   turtle.right(90)
   turtle.forward(100)
   turtle.right(90)
   turtle.forward(100)
   turtle.right(90)
   turtle.forward(100)

   turtle.mainloop()
```

> **提示**：本章提供的代码中还有画国旗和画小猪佩奇的代码，有兴趣的读者请自行研究。

#### flag.py
```python
```
![[flag-py-output.png]]
>注：运行此脚本时可能会报错：
![[tkinter-error.png]]

有两种解决办法，
一种是修复当前系统默认的Python环境，参考博客：[Python下"No module named _tkinter_ 问题分析及解决](https://www.jianshu.com/p/0baa9657377f)；
另一种是选择conda安装的默认环境，比如上面所安装的`py39`，这在不同的环境中有不同的解决办法：
- 终端中要在`.zshrc`中开启conda环境（`source /opt/anaconda/bin/activate root`），
- vscode中要在python插件的运行中选择合适的python环境，
	- ![[vscode_switch_pyenv.png]]
- pycharm中也要如此选择：
	- ![[pycharm_switch_pyenv.png]]

#### peppa_pig.py
```python
```
![[peppa_pig_output.png]]