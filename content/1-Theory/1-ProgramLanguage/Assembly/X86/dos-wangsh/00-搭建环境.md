
作为学习使用而非开发，配置环境应以简单、快捷为首要考虑目标，并且王爽老师的《汇编语言》一书基于 16 位 x86 汇编进行讲解，因此没有必要配置完全的 Linux 汇编环境。

综合考虑，使用 DOSBox 模拟器 + VSCode + MASM/TASM 插件作为学习环境。

## 安装 DOSBox 作为插件的依赖
```shell
sudo pacman -S dosbox
```

## 安装插件
在 vscode 插件管理中安装如下三个插件：
- masm/tasm：集成了汇编语言的编译器与链接器，是接下来运行汇编代码的核心。同时会安装 vscode dosbox 插件作为依赖，以启动系统中 dosbox 应用；
- asm code lens：一个汇编语言的代码提示、引用、悬停信息、重命名、文件概要等功能插件；
- asm formatter：汇编代码格式化；

有关 masm/tasm 和 vscode dosbox 两个插件的中文文档，请阅读：[VSCode下DOS汇编插件: VSCode DOS汇编的支持 在DOSBox等模拟器中运行汇编相关的组件](https://gitee.com/dosasm/masm-tasm/#/dosasm/masm-tasm/blob/main/vscode-dosbox/README.zh.md)。

## 测试汇编环境
### 新建工作区及配置文件
这一步没什么好说的，唯一注意的是在工作目录下新建 `.vscode/settings.json`，其中写入：

```json
{
    "masmtasm.ASM.emulator": "dosbox",
    "masmtasm.dosbox.run": "exit",
    "masmtasm.ASM.MASMorTASM": "TASM",
    "masmtasm.ASM.assembler": "TASM"
}
```

如有其它需求，可以另起一行输入 `"masm"`，代码补全会给出可选选项。具体选项及参数含义，可参考：

### 编写测试汇编文件
新建一个名为 `asm-env-test.asm` 的汇编文件，内容如下：
```assembly
.386
DATA SEGMENT use16
    MESG DB 'hello,assembly','$'
DATA ENDS

CODE SEGMENT USE16
         ASSUME CS:CODE,DS:DATA
    BEG: MOV    AX,DATA
         MOV    DS,AX
    LAST:MOV    AH,9
         MOV    DX, OFFSET MESG
         INT    21H
         MOV    AH,4CH
         INT    21H                ;back to dos

CODE ENDS
END BEG
```

>[!warning] 注意文件格式
>应用于该插件的文件后缀名一定是 `.asm` 而不是 `.s`，否则插件将无法使用。


