
## å…³äº C++ çš„åŸºæœ¬æ¦‚å¿µ
### è¯­è¨€ç±»å‹
1. C++å’ŒJava éƒ½æ˜¯é™æ€ç±»å‹çš„é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ã€‚ï¼ˆâœ…ï¼‰
>[! note] ä»€ä¹ˆæ˜¯é™æ€ã€åŠ¨æ€ç±»å‹è¯­è¨€ï¼Ÿ
>- åŠ¨æ€ç±»å‹è¯­è¨€æ˜¯æŒ‡åœ¨è¿è¡ŒæœŸé—´æ‰å»åšæ•°æ®ç±»å‹æ£€æŸ¥çš„è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç”¨åŠ¨æ€ç±»å‹çš„è¯­è¨€ç¼–ç¨‹æ—¶ï¼Œæ°¸è¿œä¹Ÿä¸ç”¨ç»™ä»»ä½•å˜é‡æŒ‡å®šæ•°æ®ç±»å‹ï¼Œè¯¥è¯­è¨€ä¼šåœ¨ä½ ç¬¬ä¸€æ¬¡èµ‹å€¼ç»™å˜é‡æ—¶ï¼Œåœ¨å†…éƒ¨å°†æ•°æ®ç±»å‹è®°å½•ä¸‹æ¥ã€‚å…¸å‹è¯­è¨€æœ‰ï¼šPythonã€JavaScript
>
>- é™æ€ç±»å‹è¯­è¨€ä¸åŠ¨æ€ç±»å‹è¯­è¨€åˆšå¥½ç›¸åï¼Œå®ƒçš„æ•°æ®ç±»å‹æ˜¯åœ¨ç¼–è¯‘å…¶é—´æ£€æŸ¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å†™ç¨‹åºæ—¶è¦å£°æ˜æ‰€æœ‰å˜é‡çš„æ•°æ®ç±»å‹ï¼ŒC/C++æ˜¯é™æ€ç±»å‹è¯­è¨€çš„å…¸å‹ä»£è¡¨ï¼Œå…¶ä»–çš„é™æ€ç±»å‹è¯­è¨€è¿˜æœ‰ C#ã€JAVA ç­‰ã€‚

## å˜é‡
### æ ‡è¯†ç¬¦
1. æ ‡è¯†ç¬¦å‘½åè§„åˆ™
>[! done] ä½œä¸ºå˜é‡åçš„æ ‡è¯†ç¬¦å‘½åè§„åˆ™
>1. ç¬¬ä¸€ä¸ªå­—ç¬¦å¿…é¡»æ˜¯å­—æ¯æˆ–ä¸‹åˆ’çº¿ï¼Œé™¤æ­¤å¤–å¯ä»¥ç”±å­—ç¬¦ã€æ•°å­—ã€ä¸‹åˆ’çº¿ç»„æˆï¼›
>2. ä¸èƒ½æ˜¯å…³é”®è¯ï¼›

### ä¿®é¥°ç¬¦
1. åˆ¤æ–­ä¸‹åˆ—å˜é‡ä¿®é¥°ç¬¦çš„å«ä¹‰ï¼š
- `extern`ï¼šå¤–éƒ¨å˜é‡ï¼Œå¯ä¾›æ‰€æœ‰æºæ–‡ä»¶ä½¿ç”¨ï¼›
- `register`ï¼šå¯„å­˜å™¨å˜é‡ï¼Œæ”¾åœ¨å¯„å­˜å™¨è€Œéå†…å­˜ä¸­ï¼Œæ•ˆç‡æ›´é«˜ï¼Œä¸€èˆ¬æ˜¯ä¸´æ—¶å˜é‡ï¼›
- `auto`ï¼šè‡ªåŠ¨å˜é‡ï¼Œæ‰€æœ‰æœªåŠ  static å…³é”®å­—çš„éƒ½é»˜è®¤æ˜¯ auto å˜é‡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ™®é€šçš„å˜é‡
- `static`ï¼šé™æ€å˜é‡ï¼Œåœ¨å†…å­˜ä¸­åªå­˜åœ¨ä¸€ä¸ªï¼Œå¯ä¾›å½“å‰æºæ–‡ä»¶çš„æ‰€æœ‰å‡½æ•°ä½¿ç”¨

### æŒ‡é’ˆ
#### æŒ‡é’ˆ `this` çš„ä½¿ç”¨
1. åˆ¤æ–­ä¸‹åˆ—ä»£ç ä¸­ï¼Œå››ä¸ªå‡½æ•°å“ªä¸ªå…·æœ‰éšå« `this` æŒ‡é’ˆï¼ˆï¼‰
```cpp
int f1();
class T{
	public:    static int f2();
	private:   friend int f3();
	protected: int f4();
};
```

ç­”æ¡ˆæ˜¯ `f4()`ã€‚[[11-Class(II)#The keyword `this`|this pointer]]

>[! note] `this` æŒ‡é’ˆä»€ä¹ˆæ—¶å€™ä¼šéšå«ï¼Ÿ
>åªæœ‰ç±»çš„éé™æ€æˆå‘˜å‡½æ•°æ‰æœ‰ `this` æŒ‡é’ˆï¼Œå‹å…ƒã€é™æ€å‡½æ•°ä»¥åŠå…¨å±€å‡½æ•°éƒ½æ²¡æœ‰ this æŒ‡é’ˆã€‚
>- é™æ€æˆå‘˜å‡½æ•°å±äºæ•´ä¸ªç±»æ‰€æœ‰ï¼Œæ²¡æœ‰ this æŒ‡é’ˆï¼›
>- å‹å…ƒå‡½æ•°ä¸æ˜¯è¿™ä¸ªç±»çš„æˆå‘˜ï¼Œæ²¡æœ‰æŒ‡é’ˆï¼›

#### å¸¸é‡æŒ‡é’ˆä¸å¸¸æŒ‡é’ˆ

>[! note] å£è¯€â€”â€”â€œå·¦å¸¸å€¼ï¼Œå³å¸¸å‘â€
>1. `const char* p;` - è¿™æ˜¯ä¸€ä¸ªæŒ‡å‘å¸¸é‡å­—ç¬¦çš„æŒ‡é’ˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`p` æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘çš„å­—ç¬¦æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸èƒ½é€šè¿‡ `p` æ¥ä¿®æ”¹æ‰€æŒ‡å‘çš„å­—ç¬¦ã€‚ä½†æ˜¯æŒ‡é’ˆ `p` æœ¬èº«çš„å€¼å¯ä»¥ä¿®æ”¹ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥è®© `p` æŒ‡å‘ä¸åŒçš„å¸¸é‡å­—ç¬¦ã€‚
>2. `char* const p;` - è¿™æ˜¯ä¸€ä¸ªå¸¸é‡æŒ‡é’ˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`p` æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘çš„å­—ç¬¦æ˜¯å¯ä¿®æ”¹çš„ï¼Œå¯ä»¥é€šè¿‡ `p` æ¥ä¿®æ”¹æ‰€æŒ‡å‘çš„å­—ç¬¦ã€‚ä½†æ˜¯æŒ‡é’ˆ `p` æœ¬èº«çš„å€¼æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼Œä¸€æ—¦åˆå§‹åŒ–åï¼Œä¸èƒ½è®© `p` æŒ‡å‘å…¶ä»–åœ°æ–¹ã€‚

#### æŒ‡é’ˆç©ºé—´å¤§å°
1. åˆ¤æ–­ï¼šåœ¨ 64 ä½æœºä¸Šï¼Œ`char *p= "abcdefghijk";` sizeof (p)å¤§å°ä¸º 12. (âŒ)

>[! note] æŒ‡é’ˆå¤§å°ä¸æŒ‡é’ˆæ‰€æŒ‡ç©ºé—´å¤§å°æ— å…³
>è¿™é‡Œå°†ä¸€ä¸ªå­—ç¬¦ä¸²å­—é¢é‡èµ‹å€¼ç»™æŒ‡é’ˆ pã€‚åœ¨64ä½æœºå™¨ä¸Šï¼ŒæŒ‡é’ˆçš„å¤§å°ä»ç„¶æ˜¯ 8 å­—èŠ‚ï¼ˆ64 ä½ï¼‰ï¼Œä¸ç®¡å®ƒæŒ‡å‘çš„æ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®ã€‚å­—ç¬¦ä¸²å­—é¢é‡æ˜¯ä»¥ null ç»ˆæ­¢çš„å­—ç¬¦æ•°ç»„ï¼Œè¯¥æ•°ç»„çš„å¤§å°æ˜¯ 12ï¼ˆåŒ…æ‹¬ç»ˆæ­¢çš„ null å­—ç¬¦ï¼‰ã€‚æ‰€ä»¥ `sizeof(p)` è¿”å›çš„æ˜¯æŒ‡é’ˆçš„å¤§å°ï¼Œè€Œä¸æ˜¯æ‰€æŒ‡å‘çš„æ•°æ®å¤§å°ï¼Œå› æ­¤æ˜¯ 8ã€‚

#### å¤šé‡æŒ‡é’ˆ
1. åˆ¤æ–­ä»¥ä¸‹ç¨‹åºçš„è¾“å‡ºï¼š
```cpp
#include <stdio.h>
void fun(char **p) {
    int i;
    for (i = 0; i < 4; i++)
        printf("%s", p[i]);
}
main() {
    char *s[6] = {"ABCD", "EFGH", "IJKL", "MNOP", "QRST", "UVWX"};
    fun(s);
    printf("\n");
}
```

**ANSWER**ï¼šABCDEFGHIJKLMNOP

`char *s[6]={ "ABCD", "EFGH", "IJKL", "MNOP", "QRST", "UVWX" };`
ä»¥ä¸Šè¯­å¥å®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ `s`ã€‚é¦–å…ˆè¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„é‡Œå­˜å‚¨çš„æ˜¯æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯è¯´`s[1], s[2] ...`ç­‰å­˜å‚¨çš„éƒ½æ˜¯æŒ‡é’ˆï¼Œç±»å‹æ˜¯ `char*`ã€‚

è€Œæ•°ç»„åæ˜¯æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„å¸¸é‡æŒ‡é’ˆï¼Œå› æ­¤ `s` æ˜¯æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆï¼Œæ‰€ä»¥å‡½æ•° `fun` çš„å½¢å‚å®šä¹‰æ˜¯ `char **`ã€‚

`fun(s)` å°†æŒ‡é’ˆ `s` çš„å€¼ä¼ é€’ç»™å½¢å‚ `p`ï¼Œæ‰€ä»¥ `p = s`ï¼Œå› æ­¤`for(i=0;i<4;i + + )printf("% s",p[i]);`ä¸­ `printf("% s",p[i])` ç­‰ä»·äº `printf("% s",s[i])`ã€‚

æ³¨æ„ï¼Œè™½ç„¶ `s[i]` ä¸­å­˜å‚¨çš„ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯ `char *` ç±»å‹çš„æŒ‡é’ˆï¼Œä½†æ˜¯ `printf` è¿˜æ˜¯ä¼šè¾“å‡º `s[i]` å­˜å‚¨çš„æŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ä¸²ã€‚æ‰€ä»¥æœ€åè¾“å‡ºä¸º Dã€‚


#### æŒ‡é’ˆæ‚è°ˆ
1. åˆ¤æ–­ä»¥ä¸‹è¯´æ³•æ­£è¯¯ï¼š
- å³ä½¿ä¸è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œåœ¨è¿›è¡ŒæŒ‡é’ˆèµ‹å€¼è¿ç®—æ—¶ï¼ŒæŒ‡é’ˆå˜é‡çš„åŸºç±»å‹ä¹Ÿå¯ä»¥ä¸åŒ âŒ
- å¦‚æœä¼å›¾é€šè¿‡ä¸€ä¸ªç©ºæŒ‡é’ˆæ¥è®¿é—®ä¸€ä¸ªå­˜å‚¨å•å…ƒï¼Œå°†ä¼šå¾—åˆ°ä¸€ä¸ªå‡ºé”™ä¿¡æ¯ âœ…
- è®¾å˜é‡ p æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œåˆ™è¯­å¥ `p=0;` æ˜¯éæ³•çš„ï¼Œåº”è¯¥ä½¿ç”¨ `p=NULL;` âŒ
- æŒ‡é’ˆå˜é‡ä¹‹é—´ä¸èƒ½ç”¨å…³ç³»è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒ âŒ

1ï¸âƒ£æè¿°ä¸æ­£ç¡®ï¼ŒæŒ‡é’ˆå˜é‡çš„èµ‹å€¼åªèƒ½èµ‹äºˆåœ°å€ï¼Œç»ä¸èƒ½èµ‹äºˆä»»ä½•å…¶å®ƒæ•°æ®ï¼Œå¦åˆ™å°†å¼•èµ·é”™è¯¯ï¼›
3ï¸âƒ£ä¸­ï¼ŒÂ `p=NULL;` å’ŒÂ `p=0;` ã€`p='\0'` æ˜¯ç­‰ä»·çš„ï¼›
4ï¸âƒ£ä¸­ï¼ŒæŒ‡å‘åŒä¸€æ•°ç»„çš„ä¸¤æŒ‡é’ˆå˜é‡è¿›è¡Œå…³ç³»è¿ç®—å¯è¡¨ç¤ºå®ƒä»¬æ‰€å€¼æ•°ç»„å…ƒç´ ä¹‹é—´çš„å…³ç³»ã€‚

#### æŒ‡é’ˆæ•°ç»„ä¸æ•°ç»„æŒ‡é’ˆ
1. åˆ¤æ–­ä»¥ä¸‹å®šä¹‰çš„å«ä¹‰ï¼š
A `int (*p)[5]`ï¼šp æŒ‡é’ˆï¼ŒæŒ‡å‘å®¹é‡ä¸º 5 çš„æ•°ç»„çš„å¼€å¤´ï¼›
B `int *p[5]`ï¼šp æ•°ç»„ï¼Œå®¹é‡ä¸º 5ï¼Œå…ƒç´ æ˜¯æ•´å‹æŒ‡é’ˆï¼›
C `(int*)p[5]`ï¼šå¼ºåˆ¶ç±»å‹è½¬æ¢
D `int *p[]`ï¼šé”™è¯¯å®šä¹‰ï¼ŒDefinition of variable with array type needs an explicit size or an initializerã€‚

>[! note] åŒºåˆ† `int *p[n]` å’Œ ` int (*p)[n]` çš„å…³é”®
>åœ¨äºè¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼Œ`[]` æ˜¯ä¼˜å…ˆäº `*` çš„ã€‚
>- `int *p[n];` ä¸­ï¼Œè¿ç®—ç¬¦ `[]` ä¼˜å…ˆçº§é«˜ï¼Œå…ˆä¸ p ç»“åˆæˆä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå†ç”± `int*` è¯´æ˜è¿™æ˜¯ä¸€ä¸ªæ•´å‹æŒ‡é’ˆæ•°ç»„ã€‚  
>
>- `int (*p)[n];` ä¸­ `()` ä¼˜å…ˆçº§é«˜ï¼Œé¦–å…ˆè¯´æ˜ p æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€ä¸ªæ•´å‹çš„ä¸€ç»´æ•°ç»„ã€‚  
  

### ä½åŸŸ (`bit field`)
1. åœ¨ 32 ä½æœºä¸Šï¼Œæœ‰ä¸€ä¸ªç»“æ„ä½“å¦‚ä¸‹ï¼Œè¯·è®¡ç®— sizeof (A)çš„ç»“æœã€‚
```
Struct A{ 
	Char t : 4;
	Char k : 4; 
	Unsigned short i : 8; 
	Unsigned long m;
};
```

>[! note]
>åœ¨ 32 ä½æœºä¸Šï¼Œç»“æ„ä½“ A çš„ sizeof (A)ç»“æœå°†æ˜¯ 8 å­—èŠ‚ã€‚
>åœ¨ç»“æ„ä½“ A ä¸­ï¼Œå˜é‡åçš„ `:` ç”¨æ¥å®šä¹‰ä½å­—æ®µï¼ˆBit Fieldï¼‰ï¼Œå®ƒå…è®¸å°†å˜é‡çš„ç‰¹å®šä½æ•°ç”¨äºè¡¨ç¤ºç‰¹å®šçš„å€¼ã€‚
>
>é€æ­¥è§£é‡Šè®¡ç®—è¿‡ç¨‹ï¼š
>1. `char t : 4;`ï¼šè¿™è¡¨ç¤ºå˜é‡ t å°†å ç”¨ 4 ä¸ªä½ã€‚åœ¨ 32 ä½æœºä¸Šï¼Œchar ç±»å‹é»˜è®¤å ç”¨ 1 å­—èŠ‚ï¼ˆ8 ä½ï¼‰ï¼Œä½†ç”±äºæˆ‘ä»¬æŒ‡å®šäº† `: 4`ï¼Œå› æ­¤ t å°†åªå ç”¨4ä½ã€‚
>2. `char k : 4;`ï¼šåŒæ ·ï¼Œå˜é‡ k ä¹Ÿå ç”¨ 4ä¸ªä½ã€‚
>3. `unsigned short i : 8;`ï¼šè¿™è¡¨ç¤ºå˜é‡ i å°†å ç”¨ 8 ä¸ªä½ï¼Œå³ 1å­—èŠ‚ã€‚
>4. `unsigned long m;`ï¼šè¿™æ˜¯ä¸€ä¸ªæ— ä¿®é¥°ç¬¦çš„æ— ç¬¦å·é•¿æ•´å‹ï¼Œå®ƒåœ¨ 32 ä½æœºä¸Šå ç”¨ 4 å­—èŠ‚ï¼ˆ32 ä½ï¼‰ã€‚
> 
>ç»¼ä¸Šæ‰€è¿°ï¼Œå°†ç»“æ„ä½“ A çš„æˆå‘˜é€ä¸ªåˆ†æå¹¶è®¡ç®—å…¶å ç”¨ç©ºé—´ï¼š
>- å˜é‡ t å ç”¨ 4 ä½ï¼Œå³åŠä¸ªå­—èŠ‚ï¼›
>- å˜é‡ k å ç”¨ 4 ä½ï¼Œå³åŠä¸ªå­—èŠ‚ï¼›
>- å˜é‡ i å ç”¨ 1å­—èŠ‚ï¼›
>- å˜é‡ m å ç”¨ 4å­—èŠ‚ã€‚
>
>å°†è¿™äº›æˆå‘˜çš„å ç”¨ç©ºé—´ç›´æ¥ç›¸åŠ ï¼š0.5 å­—èŠ‚ + 0.5 å­—èŠ‚ + 1 å­—èŠ‚ + 4 å­—èŠ‚ = 6 å­—èŠ‚ã€‚
>ç„¶è€Œï¼Œåœ¨ 32 ä½æœºä¸Šï¼Œç»“æ„ä½“çš„å¤§å°ä¼šæŒ‰ç…§æœ€å¤§åŸºæœ¬ç±»å‹æˆå‘˜çš„å¤§å°è¿›è¡Œå¯¹é½ã€‚å› æ­¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç»“æ„ä½“ A ä¸­ tã€kã€i æ€»å…± 2 å­—èŠ‚ï¼Œä¼šè¢«å‘ä¸Šå–æ•´åˆ° 4 å­—èŠ‚ï¼Œä»¥ä¿æŒä¸ m çš„å¯¹é½ã€‚
>
>å› æ­¤ï¼Œsizeof(A)çš„ç»“æœä¸º8å­—èŠ‚ã€‚

>[! note] è¡¥å……ï¼šå†…å­˜å¯¹é½çš„ä¸‰ä¸ªè§„åˆ™
>1. å¯¹äºç»“æ„ä½“çš„å„ä¸ªæˆå‘˜ï¼Œç¬¬ä¸€ä¸ªæˆå‘˜çš„åç§»é‡æ˜¯ 0ï¼Œæ’åˆ—åœ¨åé¢çš„æˆå‘˜å…¶å½“å‰åç§»é‡å¿…é¡»æ˜¯å½“å‰æˆå‘˜ç±»å‹çš„æ•´æ•°å€
>2. ç»“æ„ä½“å†…æ‰€æœ‰æ•°æ®æˆå‘˜å„è‡ªå†…å­˜å¯¹é½åï¼Œç»“æ„ä½“æœ¬èº«è¿˜è¦è¿›è¡Œä¸€æ¬¡å†…å­˜å¯¹é½ï¼Œä¿è¯æ•´ä¸ªç»“æ„ä½“å ç”¨å†…å­˜å¤§å°æ˜¯ç»“æ„ä½“å†…æœ€å¤§æ•°æ®æˆå‘˜çš„æœ€å°æ•´æ•°å€
>3. å¦‚ç¨‹åºä¸­æœ‰#pragma pack(n)é¢„ç¼–è¯‘æŒ‡ä»¤ï¼Œåˆ™æ‰€æœ‰æˆå‘˜å¯¹é½ä»¥nå­—èŠ‚ä¸ºå‡†(å³åç§»é‡æ˜¯nçš„æ•´æ•°å€)ï¼Œä¸å†è€ƒè™‘å½“å‰ç±»å‹ä»¥åŠæœ€å¤§ç»“æ„ä½“å†…ç±»å‹

2. è¶çƒ­æ‰“é“ï¼Œå¦ä¸€ä¸ªå…³äºå¯¹é½çš„é—®é¢˜ï¼šåˆ¤æ–­ä¸‹é¢è¯­å¥ä¸­ sz å˜é‡çš„å€¼
```cpp
struct _THUNDER {
	int iVersion;
	char cTag;
	char cAdv;
	int iUser;
	char cEnd;
} Nowcoder;
int sz = sizeof(Nowcoder);
```

ç­”æ¡ˆæ˜¯ï¼š16

![[struct-memory-occupy.png]]

### å­—ç¬¦ä¸²
1. ä¸ºäº†å°†å˜é‡ `char buf[]="SH_600570_"` ä¿®æ”¹ä¸º `"SH__600570"`ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å“ªäº›å‡½æ•°è¯­å¥ï¼Ÿ
A. `strcpy(buf+3,buf+2);`    âœ…
B. `strncpy(buf+3,buf+2,7);` âœ…
C. `memcpy(buf+3,buf+2,7);`  âŒ

>[! note] å­—ç¬¦ä¸²æ‹·è´å‡½æ•°åŠå†…å­˜æ‹·è´å‡½æ•°æµ…æ
>- strcpy æ˜¯æ‹·è´å­—ç¬¦ä¸²ï¼Œåœ¨æ‹·è´ç»“æŸçš„æ—¶å€™ä¼šä¸ºå­—ç¬¦ä¸²æ·»åŠ ä¸€ä¸ª'\0';  
>- strncpy æ˜¯æ‹·è´å­—ç¬¦ï¼Œä¸ä¼šå†å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ '\0'ï¼ŒåªæŒ‰ç»™å‡ºçš„å­—ç¬¦ä¸ªæ•°æ¥æ‹·è´ï¼Œæ‹·è´å®Œ n ä¸ªå­—ç¬¦å°±ç»“æŸã€‚ä½†æ˜¯ï¼Œå¦‚æœ n æ¯” src çš„é•¿åº¦å¤§ï¼Œé‚£ä¹ˆç©ºä½™çš„éƒ¨åˆ†ä¼šè¢«'\0'å¡«å……ï¼Œä»¥ä¿è¯æ‹·è´ n ä¸ªå­—ç¬¦ã€‚  
>- strcpy å’Œ strncpy éƒ½åªèƒ½æ¥å— char*ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ç±»å‹çš„æ•°æ®ï¼Œå¦‚æœæ˜¯ç»“æ„ä½“ï¼Œæ²¡åŠæ³•æ“ä½œã€‚è€Œä¸”ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°å¦‚æœé‡åˆ° dest å’Œ src çš„å†…å­˜é‡å ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚  
>- memcpy æ˜¯å†…å­˜æ‹·è´ï¼Œå¯ä»¥æ¥å—æ•°ç»„ï¼Œæ•´å‹ï¼Œç»“æ„ä½“ï¼Œç±»ç­‰ä»»ä½•ç±»å‹ï¼Œå®ƒå®ç°çš„æ˜¯å†…å­˜çš„æ‹·è´ã€‚  
>- memmove å¯ä»¥é¿å…å†…å­˜åŒºåŸŸé‡å é—®é¢˜ã€‚å¦‚æœå‡ºç°é‡å ï¼Œåˆ™é‡‡ç”¨åå‘å¤åˆ¶ï¼Œä»åå‘å‰å¤åˆ¶å­—ç¬¦ä¸²ï¼Œå¦‚æœä¸é‡å ï¼Œåˆ™æ­£å‘å¤åˆ¶ï¼Œä»å‰å‘åå¤åˆ¶ã€‚

### volatile å…³é”®å­—
1. åˆ¤æ–­ä¸‹åˆ—å…³äº volatile å…³é”®å­—çš„è¯´æ³•çš„æ­£è¯¯ã€‚

A. å½“è¯»å–ä¸€ä¸ªé volatile ä¿®é¥°çš„å˜é‡æ—¶ï¼Œä¸ºæé«˜å­˜å–é€Ÿåº¦ï¼Œç¼–è¯‘å™¨ä¼˜åŒ–æ—¶æœ‰æ—¶ä¼šå…ˆæŠŠå˜é‡è¯»å–åˆ°ä¸€ä¸ªå¯„å­˜å™¨ä¸­ï¼›ä»¥åå†å–å˜é‡å€¼æ—¶ï¼Œå°±ç›´æ¥ä»å¯„å­˜å™¨ä¸­å–å€¼ âŒ
B. ä¼˜åŒ–å™¨åœ¨ç”¨åˆ° volatile å˜é‡æ—¶å¿…é¡»æ¯æ¬¡éƒ½å°å¿ƒåœ°é‡æ–°è¯»å–è¿™ä¸ªå˜é‡çš„å€¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¿å­˜åœ¨å¯„å­˜å™¨é‡Œçš„å¤‡ä»½ âœ…
C. volatile é€‚ç”¨äºå¤šçº¿ç¨‹åº”ç”¨ä¸­è¢«å‡ ä¸ªä»»åŠ¡å…±äº«çš„å˜é‡ âœ…
D. ä¸€ä¸ªå‚æ•°ä¸å¯ä»¥æ—¢æ˜¯ const åˆæ˜¯ volatile âŒ

>[! note] å…³äº volatile
> - volatile ç”¨æ¥å£°æ˜é‚£äº›å¯èƒ½åœ¨ä½ çš„ç¨‹åºæœ¬èº«ä¸çŸ¥é“çš„æƒ…å†µä¸‹ä¼šå‘ç”Ÿæ”¹å˜çš„å˜é‡ã€‚ 
> - ä¸€ä¸ªå®šä¹‰ä¸º volatile çš„å˜é‡æ˜¯è¯´è¿™å˜é‡å¯èƒ½ä¼šè¢«æ„æƒ³ä¸åˆ°åœ°æ”¹å˜ï¼Œè¿™æ ·ï¼Œç¼–è¯‘å™¨å°±ä¸ä¼šå»å‡è®¾è¿™ä¸ªå˜é‡çš„å€¼äº†ã€‚ç²¾ç¡®åœ°è¯´å°±æ˜¯ï¼Œä¼˜åŒ–å™¨åœ¨ç”¨åˆ°è¿™ä¸ªå˜é‡æ—¶å¿…é¡»æ¯æ¬¡éƒ½å°å¿ƒåœ°é‡æ–°è¯»å–è¿™ä¸ªå˜é‡çš„å€¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¿å­˜åœ¨å¯„å­˜å™¨é‡Œçš„å¤‡ä»½ã€‚
> - å¯¹äºä¸€èˆ¬å˜é‡ï¼šä¸ºæé«˜å­˜å–é€Ÿåº¦ï¼Œç¼–è¯‘å™¨ä¼˜åŒ–æ—¶æœ‰æ—¶ä¼šå…ˆæŠŠå˜é‡è¯»å–åˆ°ä¸€ä¸ªå¯„å­˜å™¨ä¸­ã€‚ä»¥åå†å–å˜é‡å€¼æ—¶ï¼Œå°±ç›´æ¥ä»å¯„å­˜å™¨ä¸­å–å€¼ã€‚
> - ä¸€ä¸ªå‚æ•°æ—¢å¯ä»¥æ˜¯constä¹Ÿå¯ä»¥æ˜¯volatileï¼šä¸€ä¸ªä¾‹å­æ˜¯åªè¯»çš„çŠ¶æ€å¯„å­˜å™¨ã€‚å®ƒæ˜¯volatileå› ä¸ºå®ƒå¯èƒ½è¢«æ„æƒ³ä¸åˆ°åœ°æ”¹å˜ã€‚å®ƒæ˜¯constå› ä¸ºç¨‹åºä¸åº”è¯¥è¯•å›¾å»ä¿®æ”¹å®ƒã€‚ï¼ˆç®€å•ç‚¹å°±æ˜¯è¯¥ç¨‹åºä»£ç ä¸èƒ½è¯•å›¾å»ä¿®æ”¹å®ƒï¼Œä½†ä¸æ’é™¤ç¡¬ä»¶æ–¹é¢ä¿®æ”¹äº†å®ƒï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½å¾—é‡æ–°è¯»å–å®ƒçš„å€¼ã€‚ï¼‰ 

2. å¹¶å‘ç¼–ç¨‹ä¸­é€šå¸¸ä¼šé‡åˆ°ä¸‰ä¸ªé—®é¢˜ï¼šåŸå­æ€§é—®é¢˜ï¼Œå¯è§æ€§é—®é¢˜ï¼Œæœ‰åºæ€§é—®é¢˜ï¼Œ java/C/C++ä¸­ volatile å…³é”®å­—å¯ä»¥ä¿è¯å¹¶å‘ç¼–ç¨‹ä¸­çš„ï¼ˆBï¼‰

A. åŸå­æ€§ï¼Œå¯è§æ€§
B. å¯è§æ€§ï¼Œæœ‰åºæ€§ âœ…
C. åŸå­æ€§ï¼Œæœ‰åºæ€§
D. åŸå­æ€§ï¼Œå¯è§æ€§ï¼Œæœ‰åºæ€§

![[å…³äºåŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§çš„åˆ†æ#æ€»ç»“]]

### ç»“æ„ä½“
1. åˆå§‹åŒ–åˆ¤æ–­æ­£è¯¯ï¼š
```cpp
struct Property{
    char name[20];
    char value[40];
} p1={"name","Zhangsan"}, p2={"age"}, p3={,"b1ue"}, p4=p1;
```
âœ…: `p1` `p2` `p4` 
âŒ: `p3` 

>[! note] ç»“æ„ä½“ç¬¬ä¸€ä¸ªæˆå‘˜ä¸å¯ç¼ºçœ
>åœ¨ C++ä¸­ï¼Œç»“æ„ä½“ï¼ˆstructï¼‰çš„ç¬¬ä¸€ä¸ªæˆå‘˜ä¸èƒ½ç¼ºçœï¼ˆå³ä¸èƒ½çœç•¥æˆå‘˜çš„åç§°ï¼‰ï¼Œè€Œæ™®é€šç±»ï¼ˆclassï¼‰çš„ç¬¬ä¸€ä¸ªæˆå‘˜å¯ä»¥ç¼ºçœã€‚
>è¿™æ˜¯ç”±äºå†å²åŸå› å’Œ C++è¯­æ³•çš„è®¾è®¡å†³ç­–é€ æˆçš„ã€‚åœ¨æ—©æœŸçš„ C è¯­è¨€ä¸­ï¼Œç»“æ„ä½“çš„å®šä¹‰æ²¡æœ‰åƒç°ä»£ C++é‚£æ ·æˆä¸ºä¸€ä¸ªç‹¬ç«‹çš„è¯­æ³•ç»“æ„ï¼Œè€Œæ˜¯ç±»ä¼¼äº"æ•°æ®å£°æ˜"çš„ä¸€ç§å½¢å¼ã€‚ä¾‹å¦‚ï¼š
>```c
>struct Point {
>int x; // ç¬¬ä¸€ä¸ªæˆå‘˜
>int y; // ç¬¬äºŒä¸ªæˆå‘˜
>};
>```
>
>å› ä¸ºæ—©æœŸçš„ç»“æ„ä½“æ²¡æœ‰åƒç±»é‚£æ ·çš„æˆå‘˜å‡½æ•°å’Œè®¿é—®æ§åˆ¶ç­‰ç‰¹æ€§ï¼Œæ‰€ä»¥å¯¹ç»“æ„ä½“çš„å®šä¹‰æ²¡æœ‰å¯¹æˆå‘˜è¿›è¡Œç‰¹åˆ«çš„å¤„ç†ã€‚åœ¨è¿™æ ·çš„è®¾è®¡ä¸‹ï¼Œç»“æ„ä½“çš„æˆå‘˜åœ¨å†…å­˜ä¸­æ˜¯æŒ‰ç…§å£°æ˜é¡ºåºæ’åˆ—çš„ï¼Œç¬¬ä¸€ä¸ªæˆå‘˜åœ¨ç»“æ„ä½“çš„æœ€å¼€å§‹ä½ç½®ï¼Œæ²¡æœ‰é¢å¤–çš„ä¿¡æ¯æ¥æ ‡è®°æˆå‘˜çš„åç§°æˆ–ç±»å‹ã€‚
>
>è€Œåœ¨åæ¥çš„ C++è¯­è¨€ä¸­å¼•å…¥äº†ç±»çš„æ¦‚å¿µï¼Œç»“æ„ä½“å’Œç±»çš„è¯­æ³•å¼€å§‹é€æ¸èåˆã€‚ä¸ºäº†ä¿æŒå‘åå…¼å®¹æ€§ï¼ŒC++ä¿ç•™äº†æ—©æœŸç»“æ„ä½“çš„ç‰¹æ€§ï¼šç»“æ„ä½“çš„ç¬¬ä¸€ä¸ªæˆå‘˜ä¸èƒ½ç¼ºçœã€‚è€Œå¯¹äºæ™®é€šç±»ï¼ŒC++åˆ™å¼•å…¥äº†æ›´ä¸ºçµæ´»çš„è¯­æ³•è§„åˆ™ï¼Œå…è®¸æˆå‘˜çš„å£°æ˜é¡ºåºä¸å¿…æŒ‰ç…§å®šä¹‰é¡ºåºæ’åˆ—ã€‚

### æ•°ç»„
1. `char *str[3]={}` å’Œ `char (*str)[3] = {}` æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

- `char *str[3] = {}`:
   This is an array of pointers to characters. It is an array with 3 elements, and each element is a pointer to a character (i.e., a C-style string). When you initialize it with `{}`, it sets all the pointers to nullptr (i.e., the pointers are pointing to nothing initially).

   ```
   +---+      +---+---+---+
   |   | ---> |   |   |   |
   +---+      +---+---+---+
   |   | ---> |   |   |   |
   +---+      +---+---+---+
   |   | ---> |   |   |   |
   +---+      +---+---+---+
   str[0]     str[1]  str[2]
   ```

- `char (*str)[3] = {}`:
   This is a pointer to an array of characters with a fixed size of 3. When you initialize it with `{}`, it sets the pointer to nullptr (i.e., it is pointing to nothing initially).

   ```
   +---+
   |   |
   +---+
   str
   ```

In summary, the main difference lies in the types and the memory layout they represent:

- `char *str[3]` is an array of 3 pointers to characters (3 C-style strings).
- `char (*str)[3]` is a pointer to an array of characters with a fixed size of 3 (like a 2 D array with 1 row and 3 columns).

Here's a small example to demonstrate the usage of each:

```cpp
#include <iostream>

int main() {
    // char *str[3]
    char *strings[3] = { "Hello", "World", "Cpp" };
    for (int i = 0; i < 3; ++i) {
        std::cout << strings[i] << std::endl;
    }

    // char (*str)[3]
    char chars[3] = { 'a', 'b', 'c' };
    char (*ptr)[3] = &chars;
    for (int i = 0; i < 3; ++i) {
        std::cout << (*ptr)[i] << " ";
    }
    std::cout << std::endl;

    return 0;
}
```

Output:
```
Hello
World
Cpp
a b c
```

**è¶çƒ­æ‰“é“ä¸€é“ç»ƒä¹ é¢˜ï¼š**
```C++
#include <stdio.h>
int main()
{
    char *str[3] ={"stra", "strb", "strc"};
    char *p =str[0];
    int i = 0;
    while(i < 3)
    {
        printf("%s ",p++);
        i++;
    }
    return 0;
}
```
è¿™æ®µä»£ç çš„è¾“å‡ºæ˜¯ï¼š
- stra strb strc (âŒ)
- s t r          (âŒ)
- stra tra ra    (âœ…)
- s s s          (âŒ)

1. p æ˜¯ `char*` ç±»å‹ï¼Œæ¯æ¬¡++ï¼Œåç§»ä¸€ä½ï¼ˆcharï¼‰å­—ç¬¦ï¼Œè€Œä¸æ˜¯æ•°ç»„å…ƒç´ ï¼Œå› ä¸º str æ•°ç»„æœ¬è´¨æ˜¯ä¸€ä¸ªå…ƒç´ ä¸ºå­—ç¬¦æŒ‡é’ˆçš„æ•°ç»„ï¼Œå¯ä»¥ç†è§£ä¸ºæŒ‡é’ˆçš„æŒ‡é’ˆï¼Œå› æ­¤è¦ä½¿ç”¨åŒé‡è§£å¼•ç”¨æ‰å¯ä»¥ï¼›
2. `char *p=str[0]` ç›¸å½“äº `char *p="stra"`ï¼Œp è¢«èµ‹å€¼ä¸ºæŒ‡å‘å­—ç¬¦ä¸² `stra` çš„é¦–å­—ç¬¦çš„æŒ‡é’ˆï¼Œå³æŒ‡å‘ sï¼Œp++åï¼ŒæŒ‡å‘ tï¼Œç„¶å printf è¾“å‡ºé‡åˆ°ç©ºå­—ç¬¦åœæ­¢ï¼›
3. `char **p=str` æ‰æ˜¯æŒ‡å‘æ•°ç»„ä¸­å­—ç¬¦ä¸²å…ƒç´ æ•´ä½“çš„å«ä¹‰ï¼Œå‚è€ƒå¦‚ä¸‹æµ‹è¯•ï¼š
```
char** p = strï¼›     
while(i < 3)
    {
        printf("%s ", *p);
        p++ï¼›
        i++;
    }
```
è¾“å‡ºç»“æœï¼šstra strb strcã€‚

```
// è¾“å‡ºç»“æœstra strb strc
while(i < 3)
    {
        printf("%s ", *p++);
        //ç”±äºåç¼€è¿ç®—ç¬¦çš„é¡ºåºå¤§äº*è¿ç®—ç¬¦ï¼Œå› æ­¤å…ˆè¿›è¡Œp++ï¼Œå†è§£å¼•ç”¨ï¼Œä½†æ˜¯ç”±äºæ˜¯åç¼€è¿ç®—ç¬¦ï¼Œå› æ­¤å…ˆ*pï¼Œpå†++ã€‚ï¼ˆç­‰ä»·äºï¼š*pï¼ˆ++ï¼‰ï¼‰
        i++;
    }
```

```
// è¾“å‡ºç»“æœä¸ºï¼šstra tra ra
while(i < 3)
    {
        printf("%s ", ï¼ˆ*pï¼‰++);
        //*på…ˆè§£å¼•ç”¨ä¸ºstr[0]ï¼Œ++åç§»ä¸€ä½ï¼Œå› æ­¤ä¸æœ¬é¢˜ç»“æœä¸€è‡´ã€‚
        i++;
    } 
```

2. åˆ¤æ–­ï¼šä½¿ç”¨å˜é‡å®šä¹‰æ•°ç»„æ—¶ï¼Œä¸èƒ½åœ¨å®šä¹‰æ—¶åˆå§‹åŒ–ï¼Œåªèƒ½æ˜¯å£°æ˜ï¼ˆâœ…ï¼‰
```cpp
int n=10;
char a[n]; // It's right.
char a[n]="hello"; // It's false, the error info is: `Variable-sized object may not be initialized`
```

ç¬¬äºŒè¡Œåªæ˜¯å£°æ˜äº†æ•°ç»„ aï¼Œå³åœ¨ç¨‹åºä¸­å¼•å…¥äº†ä¸€ä¸ªå˜é‡åè€Œä¸åˆ†é…å†…å­˜ä»¥åŠå¯¹å˜é‡è¿›è¡Œåˆå§‹åŒ–ã€‚è¿™æ˜¯ç”±äºä¼ å…¥çš„å‚æ•° n æ˜¯ä¸€ä¸ªå˜é‡ï¼ˆå³ä½¿å®ƒå·²ç»è¢«èµ‹å€¼ï¼Œä½†ä»å¯èƒ½ç”±äºæŸäº›æ“ä½œè€Œæ”¹å˜ï¼‰ï¼Œå› æ­¤å¹¶ä¸èƒ½åœ¨æ­¤ä¸ºå…¶åˆ†é…å†…å­˜ç©ºé—´ã€‚

In C++, variable-length arrays (VLA) are not allowed. Variable-length arrays are those where the size of the array is determined at runtime rather than compile-time. This feature is available in some other programming languages, but it is not a standard feature in C++.

In the example, the second line `char a[n];` is not standard C++ but is allowed as a compiler extension in some C++ compilers. This is called a Variable-Length Array (VLA) extension, which is not part of the official C++ standard.

However, the third line `char a[n]="hello";` is not allowed in standard C++ or with VLA extensions. In C++, when you define an array, you can either omit the size (in which case the size is inferred from the initializer) or provide a constant size. The size must be known at compile-time.

3. è®¡ç®—ä¸‹åˆ—ä»£ç çš„ç»“æœ
```cpp
#include<stdio.h>
main() { 
    int a[5] = {1, 2, 3, 4, 5}; 
    int *ptr = (int *)(&a + 1); 
    printf("%d,%d", *(a + 1), *(ptr - 1)); 
}
```

**ANSWER**: 2, 4

![[Pasted image 20230727194242.png]]

>[! note] å¯¹æ•°ç»„ä½¿ç”¨å–åœ°å€ç¬¦ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
>å¯¹æ•°ç»„ä½¿ç”¨å–åœ°å€ç¬¦ (&)ä¼šå¾—åˆ°æ•´ä¸ªæ•°ç»„çš„åœ°å€ã€‚
>
>ä¸¾ä¸ªä¾‹å­:
>```cpp
>int arr[5] = {1, 2, 3, 4, 5}; 
>int* ptr = &arr; // ptr æŒ‡å‘æ•´ä¸ª arr æ•°ç»„
>```
>æ•°ç»„çš„æ•°ç»„å arr æœ¬è´¨ä¸Šå°±æ˜¯æŒ‡å‘æ•°ç»„é¦–å…ƒç´ çš„æŒ‡é’ˆå¸¸é‡, ä¸èƒ½è¢«æ”¹å˜ã€‚
>
>ä½¿ç”¨&arr ä¼šå–å¾—æ•´ä¸ªæ•°ç»„çš„åœ°å€, èµ‹å€¼ç»™æŒ‡é’ˆ ptrã€‚
>æ­¤æ—¶ ptr æŒ‡å‘äº†æ•´ä¸ªæ•°ç»„, å®ƒå¯ä»¥å½“ä½œæŒ‡å‘æ•°ç»„é¦–å…ƒç´ çš„æŒ‡é’ˆæ¥ä½¿ç”¨, æ¯”å¦‚:
>```cpp
>cout << ptr[0] << endl; // è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´  
>cout << *ptr << endl;  // ä¹Ÿæ˜¯è¾“å‡ºæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ 
>```
>ä½†æˆ‘ä»¬ä¸èƒ½é€šè¿‡ ptr æ¥æ”¹å˜æ•°ç»„çš„åœ°å€æˆ–æ•°ç»„å arr çš„å€¼ã€‚
>æ‰€ä»¥å¯¹æ•°ç»„åå–åœ°å€, ä¼šå¾—åˆ°æ•´ä¸ªæ•°ç»„çš„èµ·å§‹åœ°å€, è¿™ä¸ªåœ°å€è¢«èµ‹å€¼ç»™æŒ‡é’ˆå, å¯ä»¥é€šè¿‡è¯¥æŒ‡é’ˆè®¿é—®æ•°ç»„å…ƒç´ ã€‚

4. åˆ¤æ–­ä¸‹åˆ—å­—ç¬¦æ•°ç»„å£°æ˜çš„æ­£è¯¯ï¼š
A. `char szData[3] = â€œabâ€`   âœ…
B. `char szData[2] = â€œabâ€`   âŒ
C. `char szData[] = â€œabcâ€`   âœ…
D. `char szData[] = {â€œabcâ€}` âœ…

è¿™æ˜¯å› ä¸ºç”¨æ•°ç»„å®šä¹‰å­—ç¬¦ä¸²ï¼Œä¼šåœ¨æœ«å°¾éšå«ä¸€ä¸ª `'\0'` å­—ç¬¦ï¼ŒB ä¸­äº§ç”Ÿäº†æ•°ç»„è¶Šç•Œã€‚

#### å¤šç»´æ•°ç»„
1. ä¸‹åˆ—äºŒç»´æ•°ç»„å®šä¹‰æ˜¯å¦æ­£ç¡®ï¼Ÿ
- `int a[2][]={{1,0,1},{5,2,3}};` âŒ
- `int a[][3]={{1,2,3},{4,5,6}};` âœ…
- `int a[2][4]={{1,2,3},{4,5},{6}};` âŒ
- `int a[][3]={(1,0,1)(),(1,1)};` âŒ

>[! note] å¤šç»´æ•°ç»„åˆå§‹åŒ–
>- äºŒç»´æ•°ç»„çš„è¡Œæ•°å¯ä»¥æ¨å¯¼å‡ºæ¥ï¼Œä½†åˆ—æ•°ä¸è¡Œï¼Œæ‰€ä»¥ç¬¬äºŒç»´éœ€è¦æ˜¾å¼æŒ‡å®šï¼›

### å…±ç”¨ä½“ union
1. ä¸‹åˆ—å…³äºè”åˆçš„æè¿°ä¸­ï¼Œé”™è¯¯çš„æ˜¯ï¼Ÿ

A. è”åˆå˜é‡å®šä¹‰æ—¶ä¸å¯åˆå§‹åŒ– âŒ
B. è”åˆçš„æˆå‘˜æ˜¯å…±å€çš„       âœ…
C. è”åˆçš„æˆå‘˜åœ¨æŸä¸€ä¸ªæ—¶åˆ»åªæœ‰å½“å‰çš„æ˜¯æœ‰æ•ˆçš„ âœ…
D. è”åˆå˜é‡å æœ‰çš„å†…å­˜ç©ºé—´æ˜¯è¯¥è”åˆå˜é‡ä¸­å æœ‰æœ€å¤§å†…å­˜ç©ºé—´çš„æˆå‘˜åœ¨å†…å­˜å¯¹é½æ—¶æ‰€éœ€çš„å­˜å‚¨ç©ºé—´   âœ…

>[!note] ç»“æ„ä½“ä¸å…±ç”¨ä½“
- ç»“æ„å’Œè”åˆéƒ½æ˜¯ç”±å¤šä¸ªä¸åŒçš„æ•°æ®ç±»å‹æˆå‘˜ç»„æˆ, ä½†åœ¨ä»»ä½•åŒä¸€æ—¶åˆ», è”åˆä¸­åªå­˜æ”¾äº†ä¸€ä¸ªè¢«é€‰ä¸­çš„æˆå‘˜ï¼ˆæ‰€æœ‰æˆå‘˜å…±ç”¨ä¸€å—åœ°å€ç©ºé—´ï¼‰, è€Œç»“æ„çš„æ‰€æœ‰æˆå‘˜éƒ½å­˜åœ¨ï¼ˆä¸åŒæˆå‘˜çš„å­˜æ”¾åœ°å€ä¸åŒï¼‰ã€‚
- å¯¹äºè”åˆçš„ä¸åŒæˆå‘˜èµ‹å€¼, å°†ä¼šå¯¹å…¶å®ƒæˆå‘˜é‡å†™, åŸæ¥æˆå‘˜çš„å€¼å°±ä¸å­˜åœ¨äº†, è€Œå¯¹äºç»“æ„çš„ä¸åŒæˆå‘˜èµ‹å€¼æ˜¯äº’ä¸å½±å“çš„ã€‚

## è¿ç®—
### æº¢å‡ºç›¸å…³
1. æ€è€ƒå¦‚ä¸‹ä»£ç ï¼Œåˆ¤æ–­ç»“æœæ˜¯å¦æ­£ç¡®ï¼Ÿ
```cpp
void swap_int(int *a, int *b){
  *a = *a + *b;
  *b = *a - *b;
  *a = *a - *b;
}
 
int m = 2112340000, n = 2100001234;
swap_int(&m, &n);
```

**ANSWER**ï¼šç»“æœæ­£ç¡®ï¼Œå³ä½¿ä¼šæº¢å‡ºã€‚

**æ­£ç»è§£ç­”**ï¼šğŸ¥‡
è®¾æ•´å½¢å˜é‡ `*a`ã€`*b` çš„ä½è¡¨ç¤ºä¸º
$*a = n_{31}n_{30}Â Â·Â·Â· n_0$
$*b = m_{31}m_{30}Â Â·Â·Â· m_0$

åªæœ‰å½“ `*a > 0 && *b > 0` æˆ– `*a < 0 && *b < 0` æ—¶æ‰ä¼šå‘ç”Ÿæº¢å‡ºã€‚ä¸¤è€…ç±»ä¼¼ï¼Œåªè¯æ˜å‡å¤§äº0æ—¶çš„æƒ…å†µã€‚å¿…é¡»æ‰©å±•é¢å¤–ä¸€ä½æ‰èƒ½å¤Ÿå®¹çº³æ­£ç¡®çš„ç»“æœï¼Œ`|` å·¦è¾¹ä¸ºæ‰©å±•ä½ã€‚

$*a = 0|0n30Â Â·Â·Â· n0Â = n30*230Â + Â n29*229Â + Â·Â·Â· + n0*20Â = N$
$*b = 0|0m30Â Â·Â·Â· m0 =Â m30*230Â + Â m29*229Â + Â·Â·Â· + m0*20Â = M$

è‹¥å’Œæº¢å‡ºï¼Œåˆ™33ä½è¡¨ç¤ºå¿…ä¸º

$*a + *b = 0|1b30Â Â·Â·Â· b0Â = -231Â + b30*230Â + Â b29*229Â + Â·Â·Â· + b0*20Â = Â **2** **31** Â **+ B** **â‘ **Â $

è®¡ç®—æœºå°†å¾—åˆ°çš„33ä½ç»“æœtruncateå›åŸæ¥çš„32ä½ï¼Œå³ä¸¢å¼ƒç¬¬33ä½(0)å˜ä¸ºï¼š

$*a + *b = Â  Â 1b30Â Â·Â·Â· b0Â = -231Â + b30*230Â + Â b29*229Â + Â·Â·Â· + b0*20Â = -**2**Â  **31**Â  Â **+ B â‘¡**$

æ­£ç¡®çš„çœŸå®å€¼æ˜¯â‘ ï¼Œæº¢å‡ºç»“æœä¸ºâ‘¡ï¼Œå¯è§**æº¢å‡ºç»“æœ=çœŸå®å€¼-2** **32**  

åˆ™$*b = *a - *b = â‘¡ - *b = Â â‘  - 232Â - *b = *a + *b - 232Â - *b = -232Â + *a$

æœ€åä¸€æ­¥ï¼Œæ¥çœ‹ $-232Â + *a Â == *a$ æˆç«‹å¦ï¼Ÿ

$0 < *a < 231, åˆ™ -232Â < -232Â + *a < -231$ï¼Œå’Œä»éœ€è¦æ‰©å±•1ä½æ–¹èƒ½è¡¨ç¤ºï¼š

$*a Â  Â = 0|0n30Â Â·Â·Â· n0Â = n30*230Â + Â n29*229Â + Â·Â·Â· + n0*20Â = N

-232Â = 1|0000 Â·Â·Â· 00$

Â å’Œçš„ä½è¡¨ç¤ºä¸º

$-232Â + *a = 1|0n30Â Â·Â·Â· n0Â = n30*230Â + Â n29*229Â + Â·Â·Â· + n0*20$

åŒæ ·ï¼Œè®¡ç®—æœºæŠŠ33ä½ç»“æœtruncateå›32ä½ï¼ˆä¸¢å¼ƒç¬¬33ä½ï¼‰å¾—åˆ°ï¼š

$-232Â + *a = Â 0n30Â Â·Â·Â· n0Â = n30*230Â + Â n29*229Â + Â·Â·Â· + n0*20Â = *a$

å¯è§$-232Â + *a Â == *a$ æ˜¯æˆç«‹çš„ã€‚å› æ­¤å°½ç®¡æº¢å‡ºäº†ï¼Œä½†ä»èƒ½æ­£ç¡®äº¤æ¢ã€‚

**ä¸æ­£ç»å›ç­”**ï¼š
ç›´è§‰ä¸Šçœ‹èµ·æ¥åŠ å‡æ³•å¯èƒ½ä¼šæº¢å‡ºã€‚å…¶å®ä¸ç„¶ï¼Œç¬¬ä¸€æ­¥çš„åŠ è¿ç®—å¯èƒ½ä¼šé€ æˆæº¢å‡ºï¼Œä½†å®ƒæ‰€é€ æˆçš„æº¢å‡ºä¼šåœ¨åè¾¹çš„å‡è¿ç®—ä¸­è¢«â€œæº¢å‡ºâ€å›æ¥ã€‚

**ä¸¾ä¾‹è¯æ˜æ³•**ï¼š
  ä¸¾ä¸ªæ —å­ 

  äº¤æ¢-5ï¼Œ -7ã€‚ ä»¥4bitä¸ºä¾‹ã€‚ 

  -5 = 1011 ï¼ˆè¡¥ç ï¼‰    -7 = 1001 ï¼ˆè¡¥ç ï¼‰ 

  ï¼ˆ-5ï¼‰+ ï¼ˆ-7ï¼‰= 10100=0100=4 ï¼ˆæº¢å‡ºåä¸º4ï¼‰ 

  4-ï¼ˆ-7ï¼‰= 4 +ï¼—ï¼0100 + 0111 = 1011 = -5çš„è¡¥ç  

  4-ï¼ˆ-5ï¼‰= 4 + 5 = 0100 + 0101 = 1001 = -7çš„è¡¥ç  



## ç±»å‹è½¬æ¢
### åŠ¨æ€ç±»å‹è½¬æ¢
[[10-Type-conversions#dynamic_cast|Dynamic_Cast]]

1. åˆ¤æ–­ä¸‹åˆ—ä»£ç çš„è¾“å‡ºï¼š
```cpp
#include <iostream>
using namespace std;
class Base {
public:
    void virtual Func() {
        cout << "Base" << endl;
    }
};

class Derived : public Base {
public:
    void virtual Func() {
        cout << "Derived " << endl;
    }
};

int main() {
    Base *pBase = new Base();
    pBase->Func();
    Derived *pDerived = (Derived *) pBase;
    pDerived->Func();
    delete pBase;

    pDerived = new Derived();
    pBase = pDerived;
    pBase->Func();

    delete pDerived;
    return 0;
}
```

output: `Base -> Base -> Derived`

ç”±äº func æ˜¯ä¸€ä¸ªè™šå‡½æ•°ï¼Œæ‰€ä»¥å°†æŒ‡é’ˆèµ‹å€¼ç»™åŸºç±»æˆ–è€…æ´¾ç”Ÿç±»å¯¹è±¡ä¸ä¼šå¯¹è™šå‡½æ•°è°ƒç”¨é€ æˆå½±å“ã€‚pBase æ˜¯ä¸€ä¸ª Base å¯¹è±¡ï¼Œå‰ä¸¤æ¬¡ func ä¼šè°ƒç”¨ Base å¯¹åº”çš„ func å‡½æ•°ï¼Œè¾“å‡ºä¸¤æ¬¡Â Baseã€‚è€Œ pDerived æ˜¯ä¸€ä¸ª DerivedÂ å¯¹è±¡ï¼Œå› æ­¤æ˜¯è¾“å‡ºÂ Derivedã€‚B é€‰é¡¹æ­£ç¡®ã€‚

>[! warning] å¼ºåˆ¶ç±»å‹è½¬æ¢ä¸æŒ‡é’ˆ
> å¼ºåˆ¶ç±»å‹è½¬æ¢æ—¶ä¼šå°† Base ç±»å‹çš„æ•°æ®æ‰€åœ¨çš„å†…å­˜æŒ‰ç…§ Derived ç±»å‹æ ¼å¼è§£æå’Œè½¬æ¢ã€‚pDerived è§£æå¾—åˆ°çš„æ˜¯ pBase çš„è™šå‡½æ•°è¡¨ï¼Œç›¸å½“äº pDerived çš„ vtbl è™šå‡½æ•°è¡¨æŒ‡é’ˆæŒ‡å‘äº† pBase çš„è™šå‡½æ•°è¡¨ï¼Œæ•…å¾—åˆ° Base;
> 
> ä½†è¿™ç§å¼ºåˆ¶è½¬æ¢æ¯”è¾ƒå±é™©ï¼Œå½“è®¿é—®æŸè™šå‡½æ•°æ—¶å­ç±»å­˜åœ¨è€Œçˆ¶ç±»ä¸å­˜åœ¨æ—¶ï¼Œå°±å¯èƒ½å¯¼è‡´è¿è¡Œæ—¶å‡ºç°è®¿é—®é”™è¯¯ï¼Œç¨‹åºå´©æºƒï¼Œè€Œæ­¤æ—¶ç¼–è¯‘æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºæŒ‡é’ˆçš„è™šå‡½æ•°è¡¨æ˜¯åŠ¨æ€é“¾æ¥çš„ã€‚

2. é˜…è¯»å¦‚ä¸‹ä»£ç ï¼Œåˆ¤æ–­ L 1ã€L 2 çš„ç¼–è¯‘æƒ…å†µï¼š
```cpp
struct A1
{
    virtual ~A1() {}
};
struct A2
{
    virtual ~A2() {}
};
struct B1 : A1, A2 {};
int main()
{
    B1 d;
    A1* pb1 = &d;
    A2* pb2 = dynamic_cast<A2*>(pb1);  //L1
    A2* pb22 = static_cast<A2*>(pb1);  //L2
    return 0;
}
```

**ANSWER**ï¼šL1 ç¼–è¯‘é€šè¿‡ï¼ŒL2 ç¼–è¯‘å¤±è´¥ã€‚
[[10-Type-conversions#static_cast|static_cast]]

>[! note] é™æ€è½¬æ¢å’ŒåŠ¨æ€è½¬æ¢çš„åŒºåˆ«
>1. static_cast           
>	- æ²¡æœ‰è™šå‡½æ•°åŒæ ·å¯ä»¥ç¼–è¯‘é€šè¿‡;
>	- ç”¨äºéå¤šæ€ç±»å‹è½¬æ¢ (é™æ€è½¬æ¢)ï¼Œä»»ä½•æ ‡å‡†è½¬æ¢éƒ½å¯ä»¥ç”¨å®ƒï¼Œ
>	- æœ€å¸¸ç”¨çš„ç±»å‹è½¬æ¢ç¬¦ï¼Œç”¨äºåŸºæœ¬æ•°æ®ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼Œå¦‚æŠŠ int è½¬æ¢ä¸º char, ä½†æ˜¯ä¸èƒ½ç”¨äºä¸¤ä¸ªä¸ç›¸å…³çš„ç±»å‹è½¬æ¢ã€‚
>	- ç”¨äºç±»å±‚æ¬¡ç»“æ„ä¸­åŸºç±»å’Œæ´¾ç”Ÿç±»ä¹‹é—´æŒ‡é’ˆæˆ–å¼•ç”¨çš„è½¬æ¢ï¼Œä¸Šè¡Œè½¬æ¢ï¼ˆæ´¾ç”Ÿç±»---åŸºç±»ï¼‰æ˜¯å®‰å…¨çš„ï¼Œä¸ dynamic_cast æ•ˆæœç›¸åŒï¼›ä¸‹è¡Œè½¬æ¢ï¼ˆåŸºç±»---æ´¾ç”Ÿç±»ï¼‰ç”±äºæ²¡æœ‰åŠ¨æ€ç±»å‹æ£€æŸ¥ï¼Œæ‰€ä»¥æ˜¯ä¸å®‰å…¨çš„;   
>	- æŠŠç©ºæŒ‡é’ˆè½¬æ¢æˆç›®æ ‡ç±»å‹çš„ç©ºæŒ‡é’ˆ
>	- æŠŠä»»ä½•ç±»å‹çš„è¡¨è¾¾å¼è½¬ä¸º void ç±»å‹           
>	- static_cast ä¸èƒ½è½¬æ¢æ‰ expression çš„ constã€volatileã€æˆ–è€…__unaligned å±æ€§
>2. dynamic_cast      
>	- dynamic_cast åªèƒ½ç”¨äºæœ‰è™šå‡½æ•°çš„ç±»ï¼ˆå¿…é¡»æœ‰å…±æœ‰ç»§æ‰¿å’Œè™šå‡½æ•°)ï¼Œä¸ºè¿è¡Œæ—¶è½¬æ¢ï¼Œç”±äºè¿è¡Œæ—¶ç±»å‹æ£€æŸ¥éœ€è¦è¿è¡Œæ—¶ç±»å‹ä¿¡æ¯ï¼Œè€Œè¿™ä¸ªä¿¡æ¯å­˜å‚¨åœ¨ç±»çš„è™šå‡½æ•°è¡¨ä¸­ï¼Œåªæœ‰å®šä¹‰äº†è™šå‡½æ•°çš„ç±»æ‰æœ‰è™šå‡½æ•°è¡¨ï¼Œæ²¡æœ‰å®šä¹‰è™šå‡½æ•°çš„ç±»æ˜¯æ²¡æœ‰è™šå‡½æ•°è¡¨çš„ï¼› å¦‚æœçˆ¶ç±»æ²¡æœ‰è™šå‡½æ•°ï¼Œç¼–è¯‘æŠ¥é”™ï¼›              
>	- ç”¨äºç±»å±‚æ¬¡ç»“æ„ä¸­åŸºç±»å’Œæ´¾ç”Ÿç±»ä¹‹é—´æŒ‡é’ˆæˆ–å¼•ç”¨çš„è½¬æ¢, ä¸Šè¡Œè½¬æ¢ï¼ˆæ´¾ç”Ÿç±»--->åŸºç±»ï¼‰æ˜¯å®‰å…¨çš„ï¼Œä¸ static_cast æ•ˆæœç›¸åŒ; ä¸‹è¡Œè½¬æ¢ï¼ˆåŸºç±»--->æ´¾ç”Ÿç±»ï¼‰å…·æœ‰ç±»å‹æ£€æŸ¥çš„åŠŸèƒ½ï¼Œè½¬å‹æ˜¯å®‰å…¨çš„ï¼Œå½“ç±»å‹ä¸ä¸€è‡´æ—¶ï¼Œè½¬æ¢è¿‡æ¥çš„æ˜¯ç©ºæŒ‡é’ˆ;
>	- å…ˆæ£€æŸ¥èƒ½å¦è½¬å‹æˆåŠŸï¼Œèƒ½æˆåŠŸåˆ™è½¬å‹ï¼Œä¸èƒ½æˆåŠŸåˆ™è¿”å› 0  
>3. static_cast å’Œ reinterpret_cast çš„åŒºåˆ«:
>	- static_cast ä¸é€‚ç”¨äºä¸åŒæŒ‡é’ˆç±»å‹ä¹‹é—´çš„è½¬æ¢, å› ä¸ºå®ƒä»¬æ˜¯å®Œå…¨ä¸åŒçš„ä¸¤ä¸ªç±»å‹. 
>	- å¦‚æœè‡ªå·±æ¸…æ¥šè‡ªå·±åœ¨åšä»€ä¹ˆ, é€šå¸¸å¯¹äºä¸åŒæŒ‡é’ˆç±»å‹çš„è½¬æ¢åº”è¯¥ä½¿ç”¨reinterpret_cast

## è¿ç®—ç¬¦
### sizeof
1. sizeof ä¸ strlen çš„åŒºåˆ«ï¼Ÿ
>[! done] sizeof æ˜¯å‡½æ•°å—ï¼Ÿ
>sizeof æ˜¯æ“ä½œç¬¦ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µå°±è·å¾—ç»“æœï¼Œstrlen æ˜¯å‡½æ•°è°ƒç”¨ï¼Œåœ¨è¿è¡Œé˜¶æ®µæ‰è·å¾—å€¼ã€‚

### è¿ç®—ç¬¦é‡è½½
>[!note] è¿ç®—ç¬¦é‡è½½çš„å‡ ä¸ªåŸåˆ™
>1. ä¸æ˜¯æ‰€æœ‰çš„è¿ç®—ç¬¦éƒ½èƒ½è¢«é‡è½½ã€‚
>2. é‡è½½ä¸èƒ½æ”¹å˜è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§å’Œç»“åˆæ€§
>3. é‡è½½ä¸ä¼šæ”¹å˜è¿ç®—ç¬¦çš„ç”¨æ³•ï¼ŒåŸæœ‰æœ‰å‡ ä¸ªæ“ä½œæ•°ã€æ“ä½œæ•°åœ¨å·¦è¾¹è¿˜æ˜¯åœ¨å³è¾¹ï¼Œè¿™äº›éƒ½ä¸ä¼šæ”¹å˜
>4. è¿ç®—ç¬¦é‡è½½å‡½æ•°ä¸èƒ½æœ‰é»˜è®¤çš„å‚æ•°
>5. è¿ç®—ç¬¦é‡è½½å‡½æ•°æ—¢å¯ä»¥ä½œä¸ºç±»çš„æˆå‘˜å‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå…¨å±€å‡½æ•°
>6. ç®­å¤´è¿ç®—ç¬¦->ã€ä¸‹æ ‡è¿ç®—ç¬¦\[\]ã€å‡½æ•°è°ƒç”¨è¿ç®—ç¬¦(Â )ã€èµ‹å€¼è¿ç®—ç¬¦ = åªèƒ½ä»¥æˆå‘˜å‡½æ•°çš„å½¢å¼é‡è½½  

1. è°ƒç”¨é‡è½½åè¿ç®—ç¬¦çš„æ–¹æ³•
>[! done] è°ƒç”¨é‡è½½è¿ç®—ç¬¦çš„ä¸¤ç§æ–¹æ³•
>1. `c = a + b; //implicitly using operator` è¿™æ ·æ˜¯éšå¼åœ°ç›´æ¥ä½¿ç”¨é‡è½½åçš„è¿ç®—ç¬¦
>2. `c = a.operatpr+(b); //explicitly using its function name` è¿™æ ·æ˜¯è¿ç”¨è¿ç®—ç¬¦å‡½æ•°çš„è°ƒç”¨æ ¼å¼

2. è‹¥è¦é‡è½½ `+`, `=`, `<<`, `==`, `[]` è¿ç®—ç¬¦ï¼Œåˆ™å¿…é¡»ä½œä¸ºç±»æˆå‘˜é‡è½½çš„æ˜¯ï¼š

**ANSWER**ï¼š`=` å’Œ `[]`

C++è¯­è¨€è§„å®šï¼Œè¿ç®—ç¬¦â€œ=â€ã€â€œ[]â€ã€â€œ()â€ã€â€œ->â€ä»¥åŠæ‰€æœ‰çš„ç±»å‹è½¬æ¢è¿ç®—ç¬¦åªèƒ½ä½œä¸ºæˆå‘˜å‡½æ•°é‡è½½ï¼Œå…·ä½“åŸå› å¯ä»¥è¿™æ ·ç†è§£ï¼š

**è¿™äº›è¿ç®—ç¬¦éƒ½éœ€è¦è®¿é—®å¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ã€‚å¦‚æœå…è®¸å®ƒä»¬ä½œä¸ºæ™®é€šå…¨å±€å‡½æ•°é‡è½½, å°†æ— æ³•è®¿é—®å¯¹è±¡çš„ç§æœ‰æˆå‘˜**ã€‚

ä¸¾ä¾‹æ¥è¯´, å¯¹äºè¿ç®—ç¬¦"="çš„é‡è½½:
```cpp
class Person {
private:
  string name;
  int age;

public:
  Person& operator=(const Person& rhs) {
    name = rhs.name; // å¯ä»¥è®¿é—®ç§æœ‰æˆå‘˜
    age = rhs.age;
    return *this;
  } 
};

Person p1, p2;
p1 = p2; // è°ƒç”¨operator=
```

å¦‚æœ operator=æ˜¯å…¨å±€å‡½æ•°, å°±æ— æ³•è®¿é—® Person çš„ç§æœ‰æˆå‘˜ name å’Œ age, èµ‹å€¼æ“ä½œå°†å¤±å»æ„ä¹‰ã€‚

æ‰€ä»¥ C++è§„å®šè¿™äº›è¿ç®—ç¬¦å¿…é¡»ä½œä¸ºç±»çš„æˆå‘˜å‡½æ•°æ¥é‡è½½, è¿™æ ·å¯ä»¥è®¿é—®ç§æœ‰æˆå‘˜, æ­£ç¡®å®ç°è¿ç®—ç¬¦çš„è¯­ä¹‰ã€‚

è¿™èƒ½å¤Ÿç¡®ä¿è¿™äº›è¿ç®—ç¬¦èƒ½æ ¹æ®å¯¹è±¡å†…éƒ¨çŠ¶æ€çš„æ”¹å˜è€Œæ”¹å˜è¡Œä¸º, æ˜¯ä¸€ç§å°è£…å’Œå®‰å…¨çš„è®¾è®¡ã€‚

æ€»ç»“æ¥è¯´, C++è¿™æ ·è§„å®šæ˜¯ä¸ºäº†ä½¿è¿™äº›è¿ç®—ç¬¦èƒ½å¤Ÿè®¿é—®å¯¹è±¡çš„ç§æœ‰çŠ¶æ€, æ­£ç¡®å®‰å…¨åœ°è¡¨è¾¾è¿ç®—ç¬¦è¯­ä¹‰ã€‚


### é€—å·è¡¨è¾¾å¼
1. åˆ¤æ–­ï¼š(3,2,1,0)Â å¯ä½œä¸º C++åˆæ³•è¡¨è¾¾å¼æ˜¯å¦æ­£ç¡® ï¼ˆâœ…ï¼‰

> [! note] é€—å·è¡¨è¾¾å¼
> è¿™æ˜¯ä¸€ä¸ªé€—å·è¡¨è¾¾å¼ï¼Œå…¶å€¼æ˜¯æœ€åä¸€ä¸ªå…ƒç´  0ã€‚å³ int a=(3,2,1,0); èµ‹å€¼å a=0ã€‚
> 
> `è¡¨è¾¾å¼ 1ï¼Œè¡¨è¾¾å¼ 2ï¼Œè¡¨è¾¾å¼ 3ï¼Œ...... ï¼Œè¡¨è¾¾å¼ n`
> é€—å·è¡¨è¾¾å¼çš„è¦é¢†ï¼š
> (1) é€—å·è¡¨è¾¾å¼çš„è¿ç®—è¿‡ç¨‹ä¸ºï¼šä»å·¦å¾€å³é€ä¸ªè®¡ç®—è¡¨è¾¾å¼ã€‚
> (2) é€—å·è¡¨è¾¾å¼ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œå®ƒçš„å€¼ä¸ºæœ€åä¸€ä¸ªè¡¨è¾¾å¼ï¼ˆä¹Ÿå³è¡¨è¾¾å¼ nï¼‰çš„å€¼ã€‚
> (3) é€—å·è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§åˆ«åœ¨æ‰€æœ‰è¿ç®—ç¬¦ä¸­æœ€ä½ã€‚

### ä¼˜å…ˆçº§
1. åˆ¤æ–­ä»¥ä¸‹è¯­å¥çš„è¾“å‡º
```C++
int x=1,y=2,z=3;
z += x > y ? ++x : ++y;
printf("%d",z);
```

>[! note] è€ƒæŸ¥è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§
>èµ‹å€¼è¿ç®—ç¬¦<é€»è¾‘è¿ç®—ç¬¦<å…³ç³»è¿ç®—ç¬¦<ç®—æ•°è¿ç®—ç¬¦


## å‡½æ•°
### è¿”å›å€¼

1. é€šè¿‡ return è¯­å¥ï¼Œå‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªè¿”å›å€¼ã€‚ï¼ˆâŒï¼‰

>[! error] è¿”å›å€¼çš„ä¸ªæ•°
>åœ¨ C++11 åŠå…¶åç»­æ ‡å‡†ä¸­ï¼Œå‡½æ•°æœ¬èº«ä»ç„¶åªèƒ½è¿”å›ä¸€ä¸ªå€¼ã€‚ä½†æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨ `std::tuple` æˆ– `std::pair` ç­‰æ•°æ®ç»“æ„æ¥è¿”å›å¤šä¸ªå€¼ï¼Œä»è€Œå®ç°åœ¨å‡½æ•°è¿”å›æ—¶è¿”å›å¤šä¸ªå‚æ•°çš„æ•ˆæœã€‚

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ `std::tuple` è¿”å›å¤šä¸ªå‚æ•°çš„ä¾‹å­ï¼š

```cpp
#include <iostream>
#include <tuple>

std::tuple<int, double> myFunction() {
    int value1 = 42;
    double value2 = 3.14;
    return std::make_tuple(value1, value2);
}

int main() {
    auto result = myFunction();
    int a = std::get<0>(result);
    double b = std::get<1>(result);
    std::cout << "a: " << a << ", b: " << b << std::endl; // è¾“å‡ºï¼ša: 42, b: 3.14
    return 0;
}
```

ä¸Šè¿°ä»£ç ä½¿ç”¨ `std::tuple` æ¥å°†å¤šä¸ªå€¼æ‰“åŒ…åœ¨ä¸€èµ·å¹¶è¿”å›ï¼Œç„¶ååœ¨ `main` å‡½æ•°ä¸­ä½¿ç”¨ `std::get` æ¥è·å–æ¯ä¸ªè¿”å›å€¼çš„å…·ä½“å€¼ã€‚

é™¤äº† `std::tuple`ï¼Œä½ è¿˜å¯ä»¥ä½¿ç”¨ `std::pair` æˆ–è‡ªå®šä¹‰çš„ç»“æ„ä½“æˆ–ç±»æˆ–æŒ‡é’ˆæˆ–å¼•ç”¨ç­‰æ•°æ®ç»“æ„æ¥è¿”å›å¤šä¸ªå‚æ•°ã€‚è¿™äº›æ–¹æ³•éƒ½èƒ½å®ç°åœ¨å‡½æ•°è¿”å›æ—¶è¿”å›å¤šä¸ªå€¼çš„ç›®çš„ã€‚åœ¨é€‰æ‹©è¿”å›å¤šä¸ªå€¼çš„æ–¹æ³•æ—¶ï¼Œéœ€è¦è€ƒè™‘ä»£ç çš„å¯è¯»æ€§ã€ç»´æŠ¤æ€§ä»¥åŠå¯¹ä¸åŒç±»å‹è¿”å›å€¼çš„æ”¯æŒã€‚

### è™šå‡½æ•°ã€ç»§æ‰¿ç­‰ç»¼åˆè°ƒç”¨é—®é¢˜
1. åˆ†æä¸‹åˆ—ä»£ç ä¸­å“ªä¸ªå‡½æ•°è°ƒç”¨ä¼šå‡ºé—®é¢˜ï¼Ÿ
```cpp
using namespace std;
 
class A {
public:
    void FunctionA() {cout << "FunctionA" << endl;}
    virtual void FunctionB() {cout << "FunctionB" << endl;}
    static void FunctionC() {cout << "FunctionC" << endl;}
};
 
class B : public A {
public:
    void FunctionB() {cout << "FunctionB" << endl;}
    int FunctionD() {cout << "FunctionD" << endl;}
};
 
int main() {
    B *b = nullptr;
    b->FunctionA();
    b->FunctionB();
    b->FunctionC();
    b->FunctionD();
    return 0;
}
```

åœ¨ Cpp 20ï¼ŒClang++çš„ç¯å¢ƒä¸­å®é™…è¿è¡Œï¼Œç»“æœæ˜¯ï¼š
```
FunctionA

Process finished with exit code 139 (interrupted by signal 11: SIGSEGV)
```

è¿™è¡¨æ˜ç¨‹åºç¡®å®æ˜¯åœ¨è¿è¡Œåˆ° FunctionB æ—¶å‡ºç°äº†é”™è¯¯ï¼Œè¿™ä¸€åŸå› æ˜¯å› ä¸º b æ˜¯ä¸€ä¸ª null æŒ‡é’ˆï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨è°ƒç”¨éè™šæˆå‘˜å‡½æ•°æ—¶å¿…é¡»è¦å¯¹è±¡æ‰èƒ½ç»‘å®š V-tableã€‚

æ ¹æ®è¿è¡Œç»“æœï¼Œç¨‹åºåœ¨è°ƒç”¨ `b->FunctionB()` åå´©æºƒå¹¶æŠ¥å‘Šäº† `SIGSEGV` ä¿¡å·ï¼Œè¿™æ˜¯ç”±äºå¯¹ç©ºæŒ‡é’ˆè¿›è¡Œæˆå‘˜å‡½æ•°è°ƒç”¨å¼•èµ·çš„ã€‚å…·ä½“åŸå› å¦‚ä¸‹ï¼š
1. `b` æ˜¯ä¸€ä¸ªæŒ‡å‘ `B` ç±»å¯¹è±¡çš„ç©ºæŒ‡é’ˆï¼Œæ²¡æœ‰æŒ‡å‘ä»»ä½•æœ‰æ•ˆçš„å¯¹è±¡ã€‚
2. è°ƒç”¨ `b->FunctionB()` æ—¶ï¼Œå®ƒè¯•å›¾è°ƒç”¨ `B` ç±»çš„éè™šå‡½æ•° `FunctionB()`ï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨ç±» `B` ä¸­é‡å†™çš„å‡½æ•°ã€‚ç„¶è€Œï¼Œç”±äº `b` æ˜¯ç©ºæŒ‡é’ˆï¼Œå®ƒå¹¶ä¸æŒ‡å‘ä»»ä½•å¯¹è±¡ï¼Œæ‰€ä»¥æ— æ³•è°ƒç”¨éé™æ€æˆå‘˜å‡½æ•°ï¼ŒåŒ…æ‹¬ `FunctionB()`ã€‚
3. ç©ºæŒ‡é’ˆè°ƒç”¨éè™šå‡½æ•°æ˜¯æœªå®šä¹‰çš„è¡Œä¸ºï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–äº§ç”Ÿå…¶ä»–ä¸ç¡®å®šçš„ç»“æœã€‚

è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåº”è¯¥åœ¨è°ƒç”¨æˆå‘˜å‡½æ•°ä¹‹å‰ç¡®ä¿æŒ‡é’ˆ `b` æŒ‡å‘äº†ä¸€ä¸ªæœ‰æ•ˆçš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ `new` è¿ç®—ç¬¦ä¸º `b` åŠ¨æ€åˆ†é…å†…å­˜ï¼Œæˆ–è€…å°† `b` æŒ‡å‘ä¸€ä¸ªå·²ç»å­˜åœ¨çš„æœ‰æ•ˆå¯¹è±¡ã€‚

ä»¥ä¸‹æ˜¯å¯¹ä»£ç è¿›è¡Œä¿®æ”¹çš„ç¤ºä¾‹ï¼š
```cpp
#include <iostream>
using namespace std;

class A {
public:
    void FunctionA() { cout << "FunctionA" << endl; }
    virtual void FunctionB() { cout << "FunctionB" << endl; }
    static void FunctionC() { cout << "FunctionC" << endl; }
};

class B : public A {
public:
    void FunctionB() override { cout << "FunctionB in B" << endl; }
    int FunctionD() { cout << "FunctionD" << endl; }
};

int main() {
    B* b = new B; // ä¸ºbåˆ†é…å†…å­˜ï¼Œä½¿å…¶æŒ‡å‘æœ‰æ•ˆå¯¹è±¡

    b->FunctionA();
    b->FunctionB();
    A::FunctionC(); // é™æ€æˆå‘˜å‡½æ•°ä½¿ç”¨ç±»åè°ƒç”¨

    delete b; // è®°å¾—é‡Šæ”¾åŠ¨æ€åˆ†é…çš„å†…å­˜

    return 0;
}
```

è¯·æ³¨æ„ï¼Œåœ¨ä¿®æ”¹åçš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸º `b` ä½¿ç”¨äº† `new` è¿ç®—ç¬¦æ¥åŠ¨æ€åˆ†é…å†…å­˜ï¼Œç„¶åé€šè¿‡ `delete` è¿ç®—ç¬¦é‡Šæ”¾äº†è¿™äº›å†…å­˜ï¼Œä»¥é¿å…å†…å­˜æ³„æ¼ã€‚åŒæ—¶ï¼Œ`FunctionB` å’Œ `FunctionC` åˆ†åˆ«è¾“å‡ºä¸åŒçš„å†…å®¹ï¼Œä»¥ä¾¿åŒºåˆ†è°ƒç”¨çš„ç‰ˆæœ¬ã€‚

### æŒ‡é’ˆå‡½æ•°
1. é˜…è¯»ä»£ç å¹¶å¡«å†™æ¨ªçº¿å¤„åˆé€‚çš„å‡½æ•°ï¼Œä½¿ç¨‹åºç»“æœæ˜¯`123`ï¼š
```cpp
#include <iostream>
using namespace std;
_______________________
void One(float one)
{
    cout<<"1"<<endl;    
}
void Two(float two)
{
    cout<<"2"<<endl;
}
void Three(float three)
{
    cout<<"3"<<endl;
}
int main() 
{  
    float i=1,j=2,k=3;
   function = One;
   function(i);
   function= Two;
   function(j);
   function = Three;
   function(k);
}
```

**ANSWER**ï¼š`void (*function)(float); `

>[!note] å‡½æ•°æŒ‡é’ˆ
>1. å‡½æ•°æŒ‡é’ˆ
>	- å‡½æ•°æŒ‡é’ˆæ˜¯ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡, å¯ä»¥åƒæ™®é€šå‡½æ•°ä¸€æ ·è°ƒç”¨ã€‚
>	- å£°æ˜æ ¼å¼ä¸º: è¿”å›å€¼ç±»å‹ ` (*å‡½æ•°æŒ‡é’ˆå)(å‚æ•°);`
>	- ä½œç”¨æ˜¯åŠ¨æ€ç»‘å®šå’Œè°ƒç”¨å‡½æ•°, å¯ä»¥å®ç°å›è°ƒå‡½æ•°å’Œå‡½æ•°æ¥å£ç­‰åŠŸèƒ½ã€‚
>	- ä½¿ç”¨æ­¥éª¤ï¼š
>		- å£°æ˜å‡½æ•°æŒ‡é’ˆå˜é‡
>		- èµ‹å€¼, ä½¿å‡½æ•°æŒ‡é’ˆæŒ‡å‘æŸä¸ªå‡½æ•°çš„åœ°å€
>		- é€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨å‡½æ•°
>2. è¿”å›æŒ‡é’ˆçš„å‡½æ•°
>	- è¿”å›æŒ‡é’ˆçš„å‡½æ•°æ˜¯ä¸€ç§æ™®é€šå‡½æ•°, åªä¸è¿‡å®ƒçš„è¿”å›å€¼ç±»å‹æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚
>	- å£°æ˜æ ¼å¼ä¸º: è¿”å›å€¼æŒ‡é’ˆç±»å‹ å‡½æ•°å (å‚æ•°) 
>	- è¿™ç§å‡½æ•°æ‰§è¡Œå, è¿”å›ä¸€ä¸ªæŒ‡å‘æŸå—å†…å­˜çš„æŒ‡é’ˆ, è€Œä¸æ˜¯ç›´æ¥è¿”å›å†…å­˜å—ä¸­çš„æ•°æ®ã€‚
>	- è°ƒç”¨è¯¥å‡½æ•°åéœ€è¦æ¥æ”¶è¿”å›çš„æŒ‡é’ˆ, å¹¶ PROPERLY é‡Šæ”¾æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ã€‚
>3. åŒºåˆ«
>	- å‡½æ•°æŒ‡é’ˆæ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡, è€Œè¿”å›æŒ‡é’ˆçš„å‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ã€‚
>	- å‡½æ•°æŒ‡é’ˆéœ€è¦èµ‹å€¼ä¸è§£å¼•ç”¨, è¿”å›æŒ‡é’ˆçš„å‡½æ•°ç›´æ¥è°ƒç”¨è¿”å›æŒ‡é’ˆã€‚
>	- å‡½æ•°æŒ‡é’ˆå¯ä»¥æ›´åŠ¨æ€æ”¹å˜è°ƒç”¨çš„å‡½æ•°, è¿”å›æŒ‡é’ˆçš„å‡½æ•°è°ƒç”¨å›ºå®šçš„ã€‚
>
>ç®€å•æ¥è¯´, å‡½æ•°æŒ‡é’ˆä»£è¡¨ä¸€ä¸ªå‡½æ•°çš„å…¥å£åœ°å€, è€Œè¿”å›æŒ‡é’ˆä»£è¡¨ä¸€ä¸ªæ•°æ®ç©ºé—´çš„èµ·å§‹åœ°å€ã€‚

### å†…è”å‡½æ•°
1. å†…è”å‡½æ•°åœ¨ç¼–è¯‘æ—¶æ˜¯å¦è¿›è¡Œå‚æ•°ç±»å‹æ£€æŸ¥ï¼Ÿ
ç­”ï¼šåšç±»å‹æ£€æŸ¥ã€‚å†…è”å‡½æ•°åœ¨ç¨‹åºç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨å°†ç¨‹åºä¸­å‡ºç°çš„å†…è”å‡½æ•°çš„è°ƒç”¨è¡¨è¾¾å¼ç”¨å†…è”å‡½æ•°çš„å‡½æ•°ä½“ä»£æ›¿ã€‚

[[20-Functions#Inline functions|Inline function]]

>[!note] å†…è”å‡½æ•°ä¸å®å®šä¹‰çš„è”ç³»ä¸åŒºåˆ«
>è”ç³»ï¼š
>1. æ›¿æ¢ä»£ç ï¼šå®å®šä¹‰å’Œå†…è”å‡½æ•°éƒ½å¯ä»¥å°†ä»£ç ç›´æ¥åµŒå…¥åˆ°è°ƒç”¨å¤„ï¼Œè€Œä¸æ˜¯åƒæ™®é€šå‡½æ•°ä¸€æ ·è¿›è¡Œå‡½æ•°è°ƒç”¨ã€‚
>2. ç¼–è¯‘æœŸé—´å±•å¼€ï¼šå®å®šä¹‰å’Œå†…è”å‡½æ•°éƒ½åœ¨ç¼–è¯‘æœŸé—´è¿›è¡Œå±•å¼€ï¼Œé¿å…äº†å‡½æ•°è°ƒç”¨çš„å¼€é”€ã€‚
>3. å‡å°‘å‡½æ•°è°ƒç”¨å¼€é”€ï¼šå®å®šä¹‰å’Œå†…è”å‡½æ•°éƒ½å¯ä»¥å‡å°‘å‡½æ•°è°ƒç”¨å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œå¦‚å‡½æ•°è°ƒç”¨çš„æ ˆå¸§ã€å‚æ•°ä¼ é€’ç­‰ã€‚
>
>åŒºåˆ«ï¼š
>1. è¯­æ³•å’Œç±»å‹å®‰å…¨ï¼šå®å®šä¹‰æ˜¯åŸºäºæ–‡æœ¬æ›¿æ¢ï¼Œæ²¡æœ‰è¯­æ³•ç»“æ„å’Œç±»å‹æ£€æŸ¥ï¼Œå¯ä»¥æ“ä½œä»»æ„æ–‡æœ¬ã€‚è€Œå†…è”å‡½æ•°åœ¨è¯­æ³•ä¸Šä¸æ™®é€šå‡½æ•°ç›¸ä¼¼ï¼Œå¯ä»¥è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œå¹¶ä¸”éµå¾ªå‡½æ•°çš„ä½œç”¨åŸŸè§„åˆ™ã€‚
>2. åµŒå¥—èƒ½åŠ›ï¼šå®å®šä¹‰å¯ä»¥åµŒå¥—ä½¿ç”¨ï¼Œè€Œå†…è”å‡½æ•°ä¸å…·å¤‡åµŒå¥—èƒ½åŠ›ã€‚
>3. å†…è”å‡½æ•°å¯ä»¥è®¿é—®ç±»çš„æˆå‘˜å˜é‡ï¼Œè€Œå®å®šä¹‰ä¸å¯ä»¥ï¼›
>4. åœ¨ç±»ä¸­å£°æ˜åŒæ—¶å®šä¹‰çš„æˆå‘˜å‡½æ•°ï¼Œè‡ªåŠ¨è½¬åŒ–ä¸ºå†…è”å‡½æ•°ï¼›
>5. è°ƒè¯•å’Œå¯è¯»æ€§ï¼šå®å®šä¹‰å±•å¼€åçš„ä»£ç éš¾ä»¥è°ƒè¯•å’Œé˜…è¯»ï¼Œè€Œå†…è”å‡½æ•°å¯ä»¥åœ¨è°ƒè¯•å™¨ä¸­è¿›è¡Œå•æ­¥è°ƒè¯•ï¼Œå¹¶ä¸”æä¾›äº†æ›´å¥½çš„å¯è¯»æ€§ã€‚

>[! note] æ¨èä½¿ç”¨å†…è”å‡½æ•°
>åŸå› å¦‚ä¸‹ï¼š
>1. ç±»å‹å®‰å…¨ï¼šå†…è”å‡½æ•°åœ¨è¯­æ³•ä¸Šä¸æ™®é€šå‡½æ•°ç›¸ä¼¼ï¼Œå¯ä»¥è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œé¿å…äº†å®å®šä¹‰å¯èƒ½å¸¦æ¥çš„ç±»å‹é”™è¯¯ã€‚
>2. è°ƒè¯•å’Œå¯è¯»æ€§ï¼šå†…è”å‡½æ•°åœ¨è°ƒè¯•å™¨ä¸­å¯ä»¥è¿›è¡Œå•æ­¥è°ƒè¯•ï¼Œå±•å¼€åçš„ä»£ç æ˜“äºé˜…è¯»å’Œç†è§£ã€‚
>3. ä½œç”¨åŸŸå’Œå‘½åç©ºé—´ï¼šå†…è”å‡½æ•°éµå¾ªå‡½æ•°çš„ä½œç”¨åŸŸè§„åˆ™å’Œå‘½åç©ºé—´ï¼Œå¯ä»¥è¿›è¡Œæ›´çµæ´»çš„ä»£ç ç»„ç»‡å’Œå°è£…ã€‚
>
>ç„¶è€Œï¼Œå†…è”å‡½æ•°å¹¶ä¸æ˜¯é€‚ç”¨äºæ‰€æœ‰æƒ…å†µçš„æœ€ä½³é€‰æ‹©ã€‚å†…è”å‡½æ•°çš„å±•å¼€ä¼šå¯¼è‡´ä»£ç è†¨èƒ€ï¼Œå¯¹äºå‡½æ•°ä½“è¾ƒå¤§æˆ–é¢‘ç¹è°ƒç”¨çš„å‡½æ•°ï¼Œå†…è”å¯èƒ½ä¼šå¯¼è‡´å¯æ‰§è¡Œæ–‡ä»¶çš„å¤§å°å¢åŠ å’Œç¼“å­˜å‘½ä¸­ç‡ä¸‹é™ï¼Œåè€Œé™ä½äº†æ€§èƒ½ã€‚å› æ­¤ï¼Œå¯¹äºå¤æ‚çš„å‡½æ•°æˆ–é¢‘ç¹è°ƒç”¨çš„å‡½æ•°ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œæƒè¡¡ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨æ™®é€šå‡½æ•°æˆ–å…¶ä»–ä¼˜åŒ–æ‰‹æ®µã€‚

>[! note] å†…è”å‡½æ•°ä¸å®çš„å¼€é”€å¯¹æ¯”
>å†…è”å‡½æ•°çš„å¼€é”€æ¯”å®ç•¥å¤§ï¼Œè€—è´¹åœ¨ç±»å‹æ£€æŸ¥å’Œå…¶å®ƒç¼–è¯‘æ—¶æ£€æŸ¥ä¹‹ä¸Šï¼Œä½†å¹¶ä¸æ˜¾è‘—ï¼›

### å½¢å‚ä¸å®å‚
1. å·²çŸ¥ä¸‹åˆ—ç¨‹åºè¿è¡Œç»“æœæ˜¯ YYï¼Œ78ï¼Œ96ï¼Œåˆ™è¡¥å……æ¨ªçº¿å¤„çš„å†…å®¹ä¸ºï¼š
![[real-params-virtual-params.png]]

âœ… ï¼š`*a` æˆ– `a[]` éƒ½å¯ä»¥ã€‚

- é¦–å…ˆ a æ˜¯è‚¯å®šä¸è¡Œçš„ï¼Œå®ƒæ˜¯æ ‡å‡†çš„å½¢å‚ï¼Œå‡ºå»å‡½æ•°ä½“ä¹‹åï¼Œå®å‚è¿˜æ˜¯åŸæ¥çš„å®å‚ï¼Œå€¼ä¸å˜ã€‚
- `*a` æ˜¯æ­£ç¡®çš„ï¼Œä¼ å…¥çš„æ˜¯æŒ‡é’ˆï¼ŒæŒ‡å‘è¦è¢«ä¿®æ”¹çš„åœ°å€ï¼›
- `a[]` ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œè¿™æœ¬è´¨ä¹Ÿæ˜¯ä¸€ç§è§£å¼•ç”¨ï¼Œåœ¨è¿™é‡Œå½“ä½œæŒ‡é’ˆç”¨ï¼›
- `&a` è¿™æ ·çš„ä¼ å‚æ–¹å¼ä¸è¡Œï¼Œæ­¤æ—¶å‡½æ•°è¾“å…¥çš„å½¢å¼åº”è¯¥æ˜¯ f(c),è€Œä¸æ˜¯ f(&c)ï¼Œæ­¤å¤–å‡½æ•°ä½“é‡Œçš„å¼•ç”¨å½¢å¼åº”è¯¥æ˜¯ `a.` çš„å½¢å¼ï¼Œè€Œä¸æ˜¯ ` a-> `

## ç»§æ‰¿
1. æ´¾ç”Ÿç±»å¯¹è±¡ä¸ä¼šå»ºç«‹åŸºç±»çš„ç§æœ‰æ•°æ®æˆå‘˜ï¼Œæ‰€ä»¥ä¸èƒ½è®¿é—®åŸºç±»çš„ç§æœ‰æ•°æ®æˆå‘˜ï¼ˆâŒï¼‰

>[!error] æ´¾ç”Ÿç±»ç©¶ç«Ÿç»§æ‰¿äº†åŸºç±»çš„ç§æœ‰æˆå‘˜äº†å—ï¼Ÿ
>ä¸€å¼€å§‹æˆ‘ä»¥ä¸ºè¿™ä¸ªé¢˜æ˜¯ä¸ªå› æœé€»è¾‘çš„é”™è¯¯ï¼Œä½†æ˜¯è½¬å¿µä¸€æƒ³å¯ä»¥åŠ¨æ‰‹å®ä¾‹åŒ–ä¸¤ä¸ªæ´¾ç”Ÿäº†å’ŒåŸºç±»ï¼Œåˆ†åˆ«æ¯”è¾ƒå¯¹è±¡çš„å†…å­˜å ç”¨ï¼Œè¿™æ ·å°±èƒ½ç¡®å®šæ˜¯å¦çœŸæ­£ç»§æ‰¿äº†ã€‚å› æ­¤å¯ä»¥ç¼–å†™å¦‚ä¸‹ä»£ç ï¼Œå®é™…éªŒè¯å†…å­˜å ç”¨ï¼š

```cpp 
#include <iostream>

class Base {
private:
    int privateVar;
protected:
    int protectedVar;
public:
    int publicVar;
};

class Derived : public Base {
public:
    int derivedVar;
};

int main() {
    Base baseObj;
    Derived derivedObj;

    std::cout << "Size of Base: " << sizeof(baseObj) << " bytes" << std::endl;
    std::cout << "Size of Derived: " << sizeof(derivedObj) << " bytes" << std::endl;

    return 0;
}
```

è¿è¡Œè¿™æ®µä»£ç ï¼Œå°†ä¼šè¾“å‡ºä¸¤ä¸ªç±»å¯¹è±¡çš„å†…å­˜å ç”¨å¤§å°ã€‚å¦‚æœæ´¾ç”Ÿç±»ç»§æ‰¿äº†åŸºç±»çš„ç§æœ‰æˆå‘˜ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»çš„å¯¹è±¡çš„å†…å­˜å¤§å°åº”è¯¥æ¯”åŸºç±»çš„å¯¹è±¡çš„å†…å­˜å¤§å°è¦å¤§ï¼Œå› ä¸ºæ´¾ç”Ÿç±»å¯¹è±¡åŒ…å«äº†åŸºç±»çš„æˆå‘˜ã€‚

è€Œè¿è¡Œç»“æœæ˜¯ï¼š
```
Size of Base: 12 bytes
Size of Derived: 16 bytes
```

è®©æˆ‘ä»¬åˆ†æè¿™ä¸ªç»“æœï¼š

1. `Size of Base: 12 bytes`: åŸºç±» `Base` åŒ…å«ä¸€ä¸ªç§æœ‰æˆå‘˜ `privateVar` å’Œä¸€ä¸ªä¿æŠ¤æˆå‘˜ `protectedVar`ï¼Œä»¥åŠä¸€ä¸ªå…¬æœ‰æˆå‘˜ `publicVar`ã€‚ç”±äºå¤§å¤šæ•°ç³»ç»Ÿçš„ `int` ç±»å‹å ç”¨ 4 ä¸ªå­—èŠ‚ï¼Œè¿™é‡Œçš„å¤§å°ä¸º 12 å­—èŠ‚ã€‚
    
2. `Size of Derived: 16 bytes`: æ´¾ç”Ÿç±» `Derived` ç»§æ‰¿äº†åŸºç±» `Base` çš„æˆå‘˜ï¼ŒåŒ…æ‹¬ç§æœ‰æˆå‘˜ `privateVar` ã€ä¿æŠ¤æˆå‘˜ `protectedVar` å’Œå…¬æœ‰æˆå‘˜ `publicVar`ï¼Œå¹¶ä¸”è¿˜æœ‰è‡ªå·±çš„æˆå‘˜ ` derivedVar `ã€‚ç”±äºç»§æ‰¿äº†åŸºç±»çš„ç§æœ‰æˆå‘˜ï¼Œå¯¼è‡´æ´¾ç”Ÿç±»çš„å¯¹è±¡å¤§å°å¢åŠ ã€‚å› æ­¤ï¼Œå¤§å°ä¸º 12 å­—èŠ‚ï¼ˆåŸºç±»çš„å¤§å°ï¼‰ + 4 å­—èŠ‚ï¼ˆæ´¾ç”Ÿç±»æ–°å¢çš„æˆå‘˜ï¼‰= 16 å­—èŠ‚ã€‚
    

è¿™è¯å®äº†æ´¾ç”Ÿç±»ç¡®å®ç»§æ‰¿äº†åŸºç±»çš„ç§æœ‰æˆå‘˜ï¼Œåªæ˜¯ä¸èƒ½ç›´æ¥è®¿é—®è¿™äº›ç§æœ‰æˆå‘˜è€Œå·²ã€‚å½“æ‚¨åœ¨æ´¾ç”Ÿç±»ä¸­å®šä¹‰äº†æˆå‘˜å‡½æ•°æˆ–ä½¿ç”¨åŸºç±»çš„å…¬æœ‰/ä¿æŠ¤æˆå‘˜å‡½æ•°æ¥è®¿é—®åŸºç±»çš„ç§æœ‰æˆå‘˜æ—¶ï¼Œæ‚¨å¯ä»¥é—´æ¥åœ°æ“ä½œè¿™äº›ç§æœ‰æˆå‘˜ã€‚

## æ–‡ä»¶ IO
1. ä½¿æ–‡ä»¶æŒ‡é’ˆé‡æ–°å®šä½åˆ°æ–‡ä»¶è¯»å†™çš„é¦–åœ°å€çš„å‡½æ•°æ˜¯ï¼š

`rewind()`ï¼šç”¨äºå°†æ–‡ä»¶å†…éƒ¨çš„ä½ç½®æŒ‡é’ˆé‡æ–°æŒ‡å‘ä¸€ä¸ªæµ(æ•°æ®æµ/æ–‡ä»¶)çš„å¼€å¤´ï¼›rewind å•è¯çš„æœ¬ä¹‰æ˜¯ï¼šå€’å¸¦
>[! note] å…¶å®ƒç›¸ä¼¼å‡½æ•°çš„åŠŸèƒ½
>- ftell () å‡½æ•°ç”¨äºå¾—åˆ°æ–‡ä»¶ä½ç½®æŒ‡é’ˆå½“å‰ä½ç½®ç›¸å¯¹äºæ–‡ä»¶é¦–çš„åç§»å­—èŠ‚æ•°ï¼›
>- fseek()å‡½æ•°ç”¨äºè®¾ç½®æ–‡ä»¶æŒ‡é’ˆçš„ä½ç½®ï¼›
>- ferror ()å‡½æ•°å¯ä»¥ç”¨äºæ£€æŸ¥è°ƒç”¨è¾“å…¥è¾“å‡ºå‡½æ•°æ—¶å‡ºç°çš„é”™è¯¯ã€‚

å®é™…ä¸Š `fseek()` ä¹Ÿå¯ä»¥è®¾ç½®åˆ°æ–‡ä»¶å¼€å¤´ï¼Œè€Œä¸”å¯¹é”™è¯¯å¤„ç†çš„æ‰©å±•æ€§æ›´å¥½ï¼Œä½†æ˜¯ä½¿ç”¨æ¯”è¾ƒå¤æ‚ï¼š[[10-IO-files#^9c9960]]

```cpp
#include <iostream>
#include <fstream>

int main() {
    std::fstream file("example.txt", std::ios::in); // æ‰“å¼€æ–‡ä»¶ï¼Œä»¥åªè¯»æ–¹å¼

    if (file.is_open()) {
        file.seekg(0, std::ios::beg); // å°†æ–‡ä»¶æŒ‡é’ˆç§»åŠ¨åˆ°æ–‡ä»¶å¼€å¤´
        // åœ¨è¿™é‡Œè¿›è¡Œè¯»å–æ“ä½œ...
        file.close(); // å…³é—­æ–‡ä»¶
    } else {
        std::cout << "Failed to open the file." << std::endl;
    }

    return 0;
}
```

## å†…å­˜æ“ä½œ

### `memset()` å‡½æ•°

1. åˆ¤æ–­ä»¥ä¸‹ä»£ç çš„è¾“å‡ºï¼š
```cpp
#include <iostream>
#include <cstring> 
using namespace std;
 
class Parent {
public:
    virtual void output();
};
 
void Parent::output() {
    printf("Parent!");
}
 
class Son : public Parent {
public:
    virtual void output();
};
 
void Son::output() {
    printf("Son!");
}
 
int main() {
 
    Son s;
    memset(&s, 0, sizeof(s));
    Parent& p = s;
    p.output();
 
    return 0;
}
```
A. Parent!
B. Son!
C. ç¼–è¯‘å‡ºé”™
D. æ²¡æœ‰è¾“å‡ºç»“æœï¼Œç¨‹åºè¿è¡Œå‡ºé”™

å®é™…ç»“æœæ˜¯ Dã€‚ç°åœ¨æ¥åˆ†æä¸€ä¸‹ `memset()` å‡½æ•°çš„ä½¿ç”¨æ–¹æ³•ï¼š

>[! note] `memset()` ä»‹ç»
> `memset()` æ˜¯ C/C++ ä¸­çš„ä¸€ä¸ªåº“å‡½æ•°ï¼Œç”¨äºå°†ä¸€æ®µå†…å­˜å—è®¾ç½®ä¸ºæŒ‡å®šçš„å€¼ã€‚å®ƒçš„å‡½æ•°åŸå‹å¦‚ä¸‹ï¼š
> ```cpp
> void *memset (void *ptr, int value, size_t num);
> ```
> 
> - `ptr`: æŒ‡å‘è¦è®¾ç½®çš„å†…å­˜å—çš„æŒ‡é’ˆã€‚
> - `value`: è¦è®¾ç½®çš„å€¼ï¼Œå®ƒä»¥æ•´æ•°å½¢å¼ä¼ é€’ï¼Œä½†ä¼šè¢«å¼ºåˆ¶è½¬æ¢ä¸º `unsigned char` ç±»å‹æ¥è®¾ç½®åˆ°å†…å­˜å—ä¸­ã€‚
> - `num`: è¦è®¾ç½®çš„å­—èŠ‚æ•°ï¼Œå³è¦è®¾ç½®çš„å†…å­˜å—çš„å¤§å°ã€‚
> 
> `memset()` å‡½æ•°å°† `ptr` æŒ‡å‘çš„å†…å­˜å—çš„å‰ `num` ä¸ªå­—èŠ‚éƒ½è®¾ç½®ä¸º `value` çš„å€¼ã€‚è¯¥å‡½æ•°é€šå¸¸ç”¨äºå°†ä¸€å—å†…å­˜æ¸…é›¶ï¼ˆè®¾ç½®ä¸º 0ï¼‰æˆ–è®¾ç½®ä¸ºå…¶ä»–ç‰¹å®šçš„å€¼ã€‚

ä»¥ä¸‹æ˜¯ `memset()` çš„ç®€å•ä½¿ç”¨ç¤ºä¾‹ï¼š

```cpp
#include <cstring>
#include <iostream>

int main() {
    int arr[5];
    std::memset(arr, 0, sizeof(arr)); // å°†æ•´ä¸ªæ•°ç»„è®¾ç½®ä¸º0

    char str[20];
    std::memset(str, 'A', 10); // å°†å‰10ä¸ªå­—ç¬¦è®¾ç½®ä¸º'A'

    // è¾“å‡ºæ•°ç»„å’Œå­—ç¬¦ä¸²çš„å†…å®¹
    for (int i = 0; i < 5; ++i) {
        std::cout << arr[i] << " ";
    }
    std::cout << std::endl;
    std::cout << str << std::endl;

    return 0;
}
```

æ¥è‡ªå¦ä¸€ä½å¤§ä½¬çš„è¯¦ç»†ä»‹ç»ï¼š

- memset æ˜¯ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œåˆå§‹åŒ–å†…å­˜å—ã€‚å½“åˆå§‹åŒ–ä¸€ä¸ªå­—èŠ‚å•ä½çš„æ•°ç»„æ—¶ï¼Œå¯ä»¥ç”¨ memset æŠŠæ¯ä¸ªæ•°ç»„å•å…ƒåˆå§‹åŒ–æˆä»»ä½•ä½ æƒ³è¦çš„å€¼ï¼Œæ¯”å¦‚ï¼Œ
```
char data[10];
memset(data, 1, sizeof(data));    // right
memset(data, 0, sizeof(data));    // right
```
è€Œåœ¨åˆå§‹åŒ–å…¶ä»–åŸºç¡€ç±»å‹æ—¶ï¼Œåˆ™éœ€è¦æ³¨æ„ï¼Œæ¯”å¦‚,
```
int data[10];
memset(data, 0, sizeof(data));    // right
memset(data, -1, sizeof(data));    // right
memset(data, 1, sizeof(data));    // wrong, data[x] would be 0x0101 instead of 1
```

![[memsetåˆå§‹åŒ–çš„å¼‚å¸¸ç»“æœåˆ†æ#`value` å‚æ•°è®¾ç½®ä¸º 1 é”™è¯¯çš„åŸå› ]]

- å½“ç»“æ„ä½“ç±»å‹ä¸­åŒ…å«æŒ‡é’ˆæ—¶ï¼Œåœ¨ä½¿ç”¨ memset åˆå§‹åŒ–æ—¶éœ€è¦å°å¿ƒã€‚æ¯”å¦‚å¦‚ä¸‹ä»£ç ä¸­ï¼Œ
```
struct Parameters {
          int x;
          int* p_x;
};
Parameters par;
par.p_x = new int[10];
memset(&par, 0, sizeof(par));
```
å½“memsetåˆå§‹åŒ–æ—¶ï¼Œå¹¶ä¸ä¼šåˆå§‹åŒ–p_xæŒ‡å‘çš„intæ•°ç»„å•å…ƒçš„å€¼ï¼Œè€Œä¼šæŠŠå·²ç»åˆ†é…è¿‡å†…å­˜çš„p_xæŒ‡é’ˆæœ¬èº«è®¾ç½®ä¸º0ï¼Œé€ æˆå†…å­˜æ³„æ¼ã€‚åŒç†ï¼Œå¯¹std::vectorç­‰æ•°æ®ç±»å‹ï¼Œæ˜¾è€Œæ˜“è§ä¹Ÿæ˜¯ä¸åº”è¯¥ä½¿ç”¨memsetæ¥åˆå§‹åŒ–çš„ã€‚

- å½“ç»“æ„ä½“æˆ–ç±»çš„æœ¬èº«æˆ–å…¶åŸºç±»ä¸­å­˜åœ¨è™šå‡½æ•°æ—¶ï¼Œä¹Ÿéœ€è¦è°¨æ…ä½¿ç”¨ memsetã€‚è¿™ä¸ªé—®é¢˜å°±æ˜¯åœ¨å¼€å¤´é¢˜ç›®ä¸­å‘ç°çš„é—®é¢˜ï¼Œå¦‚ä¸‹ä»£ç ä¸­ï¼Œ
```
class BaseParameters
{
public:
    virtual void reset() {}
};

class MyParameters : public BaseParameters
{
public: 
    int data[3];
    int buf[3];
};

MyParameters my_pars;
memset(&my_pars, 0, sizeof(my_pars));
BaseParameters* pars = &my_pars;

//......

MyParameters* my = dynamic_cast<MyParameters*>(pars);
```
ç¨‹åºè¿è¡Œåˆ° dynamic_cast æ—¶å‘ç”Ÿå¼‚å¸¸ã€‚åŸå› å…¶å®ä¹Ÿå¾ˆå®¹æ˜“å‘ç°ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†åˆå§‹åŒ–æ•°æ®ç»“æ„ MyParameters é‡Œçš„ data å’Œ bufï¼Œæ­£å¸¸æ¥è¯´éœ€è¦åˆå§‹åŒ–çš„å†…å­˜ç©ºé—´æ˜¯ sizeof(int) * 3 * 2 = 24å­—èŠ‚ï¼Œä½†æ˜¯ä½¿ç”¨ memset ç›´æ¥åˆå§‹åŒ– MyParameters ç±»å‹çš„æ•°æ®ç»“æ„æ—¶ï¼Œsizeof(my_pars)å´æ˜¯28å­—èŠ‚ï¼Œå› ä¸ºä¸ºäº†å®ç°å¤šæ€æœºåˆ¶ï¼ŒC++å¯¹æœ‰è™šå‡½æ•°çš„å¯¹è±¡ä¼šåŒ…å«ä¸€ä¸ªæŒ‡å‘è™šå‡½æ•°è¡¨(V-Table)çš„æŒ‡é’ˆï¼Œå½“ä½¿ç”¨ memset æ—¶ï¼Œä¼šæŠŠè¯¥è™šå‡½æ•°è¡¨çš„æŒ‡é’ˆä¹Ÿåˆå§‹åŒ–ä¸º0ï¼Œè€Œ dynamic_cast ä¹Ÿä½¿ç”¨ RTTI æŠ€æœ¯ï¼Œè¿è¡Œæ—¶ä¼šä½¿ç”¨åˆ° V-Tableï¼Œ**å¯æ­¤æ—¶ç”±äºä¸ V-Table çš„é“¾æ¥å·²ç»è¢«ç ´åï¼Œå¯¼è‡´ç¨‹åºå‘ç”Ÿå¼‚å¸¸ã€‚**

### new ä¸ malloc
1. å…³äº new ä¸ malloc çš„å‡ ä¸ªè¯´æ³•ï¼Œåˆ¤æ–­æ­£è¯¯
- éƒ½æ˜¯ç”¨æ¥ç”³è¯·å†…å­˜çš„âœ…
- éƒ½æ˜¯å‡½æ•°âŒ
- éƒ½ä¼šè°ƒç”¨æ„é€ å‡½æ•°âŒ

>[! note] new ä¸ malloc çš„å¼‚åŒ
>åŒï¼šéƒ½å¯ä»¥è¿›è¡Œå†…å­˜ç”³è¯·çš„æ“ä½œï¼›
>å¼‚ï¼š
>1. è¯­æ³•ï¼šmalloc æ˜¯ C è¯­è¨€ä¸­çš„åº“å‡½æ•°ï¼Œéœ€è¦åŒ…å«å¤´æ–‡ä»¶ `<cstdlib>` å¹¶ä½¿ç”¨ `malloc` å‡½æ•°æ¥åˆ†é…å†…å­˜ã€‚è€Œ new æ˜¯ C++ä¸­çš„æ“ä½œç¬¦ï¼Œä½¿ç”¨å…³é”®å­— `new` è¿›è¡Œå†…å­˜åˆ†é…ã€‚
>2. ç±»å‹å®‰å…¨ï¼šnew åœ¨å†…å­˜åˆ†é…çš„åŒæ—¶ä¼šè°ƒç”¨æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–å¯¹è±¡ï¼Œç¡®ä¿ç±»å‹å®‰å…¨ã€‚è€Œ malloc åªæ˜¯åˆ†é…å†…å­˜ï¼Œä¸ä¼šè‡ªåŠ¨è°ƒç”¨æ„é€ å‡½æ•°ï¼Œéœ€è¦æ‰‹åŠ¨åˆå§‹åŒ–å¯¹è±¡ã€‚
>3. è¿”å›å€¼ï¼šmalloc è¿”å›çš„æ˜¯ `void*` ç±»å‹çš„æŒ‡é’ˆï¼Œéœ€è¦è¿›è¡Œæ˜¾å¼çš„ç±»å‹è½¬æ¢ã€‚new è¿”å›çš„æ˜¯ç›¸åº”ç±»å‹çš„æŒ‡é’ˆï¼Œæ— éœ€è¿›è¡Œç±»å‹è½¬æ¢ã€‚
>4. å†…å­˜åˆ†é…å¤§å°ï¼šmalloc çš„å‚æ•°æ˜¯è¦åˆ†é…çš„å†…å­˜å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼Œè€Œ new çš„å‚æ•°æ˜¯è¦åˆ†é…çš„ç±»å‹ã€‚
>5. å†…å­˜åˆ†é…å¤±è´¥ï¼šmalloc åœ¨å†…å­˜åˆ†é…å¤±è´¥æ—¶è¿”å› `nullptr` æˆ– `NULL`ã€‚new åœ¨å†…å­˜åˆ†é…å¤±è´¥æ—¶ä¼šæŠ›å‡º `std::bad_alloc` å¼‚å¸¸ã€‚
>6. å†…å­˜é‡Šæ”¾ï¼šä½¿ç”¨ malloc åˆ†é…çš„å†…å­˜éœ€è¦ä½¿ç”¨ free å‡½æ•°è¿›è¡Œæ˜¾å¼çš„é‡Šæ”¾ã€‚ä½¿ç”¨ new åˆ†é…çš„å†…å­˜éœ€è¦ä½¿ç”¨ delete æ“ä½œç¬¦è¿›è¡Œé‡Šæ”¾ï¼Œä»¥é¿å…å†…å­˜æ³„æ¼ã€‚
>7. åº•å±‚åŸç†ï¼š 
>	- malloc åº•å±‚åŸç†å®ç°ï¼šå½“å¼€è¾Ÿçš„ç©ºé—´å°äº 128 k æ—¶ï¼Œè°ƒç”¨ `brk()` å‡½æ•°ï¼Œå½“å¼€è¾Ÿçš„ç©ºé—´å¤§äº 128 k æ—¶ï¼Œè°ƒç”¨ ` mmap() `ï¼Œmalloc é‡‡ç”¨çš„æ˜¯å†…å­˜æ± çš„ç®¡ç†æ–¹å¼ï¼Œå…ˆç”³è¯·å¤§å—å†…å­˜ä½œä¸ºå †åŒºï¼Œç„¶åå°†å †åŒºåˆ†ä¸ºå¤šä¸ªå†…å­˜å—ï¼Œå½“ç”¨æˆ·ç”³è¯·æ—¶ï¼Œå°±è°ƒå‡ºä¸€å—åˆé€‚çš„ç»™ç”¨æˆ·;
>	- new åº•å±‚åŸç†å®ç°ï¼š1ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼›2ï¼Œå°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹å€¼ç»™è¿™ä¸ªæ–°çš„å¯¹è±¡ï¼›3ï¼Œæ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼›4ï¼Œè¿”å›æ–°å¯¹è±¡ï¼›
>
>æ€»ç»“èµ·æ¥ï¼Œmalloc å’Œ new éƒ½å¯ä»¥ç”¨äºåŠ¨æ€åˆ†é…å†…å­˜ï¼Œä½† new æ˜¯ C++çš„æ“ä½œç¬¦ï¼Œæ›´ç±»å‹å®‰å…¨ï¼Œè€Œ malloc æ˜¯ C è¯­è¨€çš„å‡½æ•°ã€‚åœ¨ä½¿ç”¨æ—¶éœ€è¦æ³¨æ„å®ƒä»¬çš„è¯­æ³•å’Œå†…å­˜é‡Šæ”¾æ–¹å¼ï¼Œå¹¶æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©é€‚å½“çš„æ“ä½œç¬¦ã€‚åœ¨ C++ä¸­ï¼Œæ¨èä½¿ç”¨ new å’Œ deleteï¼Œå› ä¸ºå®ƒä»¬æä¾›æ›´å¥½çš„ç±»å‹å®‰å…¨æ€§å’Œå¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚


## ç±»ä¸æˆå‘˜
### æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°

1. å‡è®¾ ClassY: publicXï¼Œå³ç±» Y æ˜¯ç±» X çš„æ´¾ç”Ÿç±»ï¼Œåˆ™è¯´æ˜ä¸€ä¸ª Y ç±»çš„å¯¹è±¡æ—¶å’Œåˆ  Y ç±»å¯¹è±¡æ—¶ï¼Œè°ƒç”¨æ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„æ¬¡åºåˆ†åˆ«ä¸ºï¼ˆï¼‰

>[! done] æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°åœ¨ç»§æ‰¿ä¸­è°ƒç”¨é¡ºåº
>æ„é€ å‡½æ•°ï¼šå…ˆè°ƒç”¨åŸºç±»æ„é€ å‡½æ•°ï¼Œå†è°ƒç”¨æ´¾ç”Ÿç±»
>ææ„å‡½æ•°ï¼šå…ˆè§£é™¤æ´¾ç”Ÿç±»æ„é€ å‡½æ•°ï¼Œåœ¨è§£é™¤æ´¾ç”Ÿç±»
>
>ç±»æ¯”ï¼šç›¸å½“äºå»ºæˆ¿å­ï¼Œæ„é€ ï¼šå…ˆæ‰“åŸºè„šï¼Œåœ¨å¾€ä¸Šå»ºï¼Œææ„ï¼šä»ä¸Šé¢å¾€ä¸‹æ‹†

2. ææ„å‡½æ•°å¯ä»¥é‡è½½å—ï¼Ÿ
>[! note] ææ„å‡½æ•°ä¸å¯é‡è½½
>ææ„å‡½æ•°æ˜¯ç‰¹æ®Šçš„ç±»æˆå‘˜å‡½æ•°ï¼Œå®ƒçš„åå­—å’Œç±»åç›¸åŒï¼Œå‰é¢åŠ äº†~ç¬¦å·ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼Œæ²¡æœ‰å‚æ•°ï¼Œä¸èƒ½éšæ„è°ƒç”¨ã€‚
>æ³¨æ„å‡½æ•°é‡è½½çš„è¦æ±‚ï¼Œæœ€å°‘è¦æœ‰ä¸€ä¸ªå‚æ•°ç±»å‹ä¸ä¹‹ä¸åŒï¼Œè€Œææ„å‡½æ•°æ²¡æœ‰å‚æ•°ã€è¿”å›ç±»å‹ã€‚

3. åˆ©ç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–æ—¶ä¸ºä»€ä¹ˆæˆå‘˜åˆå§‹åŒ–åˆ—è¡¨æ›´å¿«ï¼Ÿ
```
# èµ‹å€¼
class classA{...};
class classB{
public:
    classB(classA a){mA = a;}
private:
    classA mA;
};

# åˆå§‹åŒ–æˆå‘˜åˆ—è¡¨
class classA{...};
class classB{
public:
    classB(classA a): mA(a) {}
private:
    classA mA;
};
```

å¯¹æ•°æ®æˆå‘˜æŒ‰ç±»å‹åˆ†ç±»  
1. å†…ç½®æ•°æ®ç±»å‹ï¼Œå¤åˆç±»å‹ï¼ˆæŒ‡é’ˆï¼Œå¼•ç”¨ï¼‰  
2. ç”¨æˆ·å®šä¹‰ç±»å‹ï¼ˆç±»ç±»å‹ï¼‰

åˆ†æƒ…å†µè¯´æ˜ï¼š  
- å¯¹äºç±»å‹1ï¼Œåœ¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨å’Œæ„é€ å‡½æ•°ä½“å†…è¿›è¡Œï¼Œåœ¨æ€§èƒ½å’Œç»“æœä¸Šéƒ½æ˜¯ä¸€æ ·çš„ï¼›
- å¯¹äºç±»å‹2ï¼Œç»“æœä¸Šç›¸åŒï¼Œä½†æ˜¯æ€§èƒ½ä¸Šå­˜åœ¨å¾ˆå¤§çš„å·®åˆ«

å› ä¸ºç±»çš„æ•°æ®æˆå‘˜å¯¹è±¡åœ¨è¿›å…¥å‡½æ•°ä½“æ—¶å·²ç»æ„é€ å®Œæˆï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨å¤„è¿›è¡Œæ„é€ å¯¹è±¡çš„å·¥ä½œï¼Œè¿™æ—¶è°ƒç”¨ä¸€ä¸ªæ„é€ å‡½æ•°ï¼›åœ¨è¿›å…¥å‡½æ•°ä½“ä¹‹åï¼Œè¿›è¡Œçš„æ˜¯å¯¹å·²ç»æ„é€ å¥½çš„ç±»å¯¹è±¡çš„èµ‹å€¼ï¼Œåˆè°ƒç”¨æ‹·è´èµ‹å€¼æ“ä½œç¬¦æ‰èƒ½å®Œæˆï¼ˆå¦‚æœå¹¶æœªæä¾›ï¼Œåˆ™ä½¿ç”¨ç¼–è¯‘å™¨æä¾›çš„é»˜è®¤æŒ‰æˆå‘˜èµ‹å€¼è¡Œä¸ºï¼‰

ç®€å•çš„æ¥è¯´ï¼š  
å¯¹äºç”¨æˆ·å®šä¹‰çš„ç±»å‹ï¼š  
1) **å¦‚æœä½¿ç”¨ç±»åˆå§‹åŒ–åˆ—è¡¨ï¼Œç›´æ¥è°ƒç”¨å¯¹åº”çš„æ„é€ å‡½æ•°å³å®Œæˆåˆå§‹åŒ–**  
2) **å¦‚æœåœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ï¼Œé‚£ä¹ˆé¦–å…ˆè°ƒç”¨é»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œç„¶åè°ƒç”¨æŒ‡å®šçš„æ„é€ å‡½æ•°**

æ‰€ä»¥å¯¹äºç”¨æˆ·å®šä¹‰ç±»å‹ï¼Œä½¿ç”¨åˆ—è¡¨åˆå§‹åŒ–å¯ä»¥å‡å°‘ä¸€æ¬¡é»˜è®¤æ„é€ å‡½æ•°è°ƒç”¨è¿‡ç¨‹


### è™šå‡½æ•°
>[! note] è¾¨æè™šå‡½æ•°ã€çº¯è™šå‡½æ•°ã€éè™šå‡½æ•°
>- çº¯è™šå‡½æ•°ï¼šåªæä¾›ä¸€ä¸ªæ¥å£ï¼Œå…·ä½“å®ç°æ–¹æ³•éœ€è¦æ´¾ç”Ÿç±»è‡ªå·±å»å®ç°
>- è™šå‡½æ•°ï¼šæä¾›æ¥å£ï¼Œå¹¶æä¾›é»˜è®¤çš„å®ç°æ–¹æ³•ï¼Œæ´¾ç”Ÿç±»ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚å»é‡è½½
>- éè™šå‡½æ•°ï¼šæä¾›æ¥å£ï¼Œå¼ºåˆ¶å®ç°æ–¹æ³•

>[! note] è™šå‡½æ•°æ¦‚å¿µç•¥è§£
>ä»¥å…³é”®å­— virtual çš„æˆå‘˜å‡½æ•°ç§°ä¸ºè™šå‡½æ•°ï¼Œä¸»è¦æ˜¯ç”¨äºè¿è¡Œæ—¶å¤šæ€ï¼Œä¹Ÿå°±æ˜¯åŠ¨æ€ç»‘å®šã€‚
>
>è™šå‡½æ•°å¿…é¡»æ˜¯ç±»çš„æˆå‘˜å‡½æ•°ï¼Œä¸èƒ½æ˜¯å‹å…ƒå‡½æ•°ã€ä¹Ÿä¸èƒ½æ˜¯æ„é€ å‡½æ•° â€”â€”ã€åŸå› ï¼šå› ä¸ºå»ºç«‹ä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œå¿…é¡»ä»ç±»å±‚æ¬¡çš„æ ¹å¼€å§‹ï¼Œæ²¿ç€ç»§æ‰¿è·¯å¾„é€ä¸ªè°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•°ï¼Œç›´åˆ°è‡ªå·±çš„æ„é€ å‡½æ•°ï¼Œä¸èƒ½é€‰æ‹©æ€§çš„è°ƒç”¨æ„é€ å‡½æ•°ã€‘
>
>ä¸èƒ½å°†è™šå‡½æ•°å£°æ˜ä¸ºå…¨å±€å‡½æ•°ï¼Œä¹Ÿä¸èƒ½å£°æ˜ä¸º static é™æ€æˆå‘˜å‡½æ•°ã€‚å› ä¸ºè™šå‡½æ•°çš„åŠ¨æ€ç»‘å®šå¿…é¡»åœ¨ç±»çš„å±‚æ¬¡ä¾é  this æŒ‡é’ˆå®ç°ã€‚
>
>è™šå‡½æ•°çš„é‡è½½ç‰¹æ€§ï¼šä¸€ä¸ªæ´¾ç”Ÿç±»ä¸­å®šä¹‰åŸºç±»çš„è™šå‡½æ•°æ˜¯å‡½æ•°é‡è½½çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚
>- é‡è½½ä¸€èˆ¬çš„å‡½æ•°ï¼šå‡½æ•°çš„è¿”å›ç±»å‹å’Œå‚æ•°çš„ä¸ªæ•°ã€ç±»å‹å¯ä»¥ä¸åŒï¼Œä»…è¦æ±‚å‡½æ•°åç›¸åŒï¼›
>- è€Œé‡è½½è™šå‡½æ•°ï¼šè¦æ±‚å‡½æ•°åã€è¿”å›ç±»å‹ã€å‚æ•°ä¸ªæ•°ã€å‚æ•°ç±»å‹å’Œé¡ºåºéƒ½å®Œå…¨ç›¸åŒã€‚

1. åŒ…å«è™šå‡½æ•°çš„ç±»æœ‰ this æŒ‡é’ˆã€‚ï¼ˆâœ…ï¼‰
> [! done] è™šå‡½æ•°çš„ this æŒ‡é’ˆ
> åŒ…å«è™šå‡½æ•°çš„ç±»å¯ä»¥ä½¿ç”¨ `this` æŒ‡é’ˆã€‚åœ¨ C++ ä¸­ï¼Œæ¯ä¸ªéé™æ€æˆå‘˜å‡½æ•°éƒ½æœ‰ä¸€ä¸ªéšå¼çš„æŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆï¼Œå³ `this` æŒ‡é’ˆã€‚`this` æŒ‡é’ˆæŒ‡å‘è°ƒç”¨è¯¥æˆå‘˜å‡½æ•°çš„å¯¹è±¡çš„åœ°å€ã€‚
> å½“ä½ è°ƒç”¨ä¸€ä¸ªåŒ…å«è™šå‡½æ•°çš„ç±»çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°è¢«ç»‘å®šåˆ°æ­£ç¡®çš„è™šå‡½æ•°è¡¨ä¸­ï¼Œå¹¶ä¸” `this` æŒ‡é’ˆä¼šè¢«è‡ªåŠ¨ä¼ é€’ç»™è¯¥å‡½æ•°ï¼ŒæŒ‡å‘è°ƒç”¨å‡½æ•°çš„å¯¹è±¡ã€‚è¿™æ ·ï¼Œå‡½æ•°å°±èƒ½æ­£ç¡®åœ°æ“ä½œå±äºè¯¥å¯¹è±¡çš„æˆå‘˜å˜é‡å’Œè™šå‡½æ•°ã€‚

ä¾‹å¦‚ï¼Œè€ƒè™‘ä»¥ä¸‹åŒ…å«è™šå‡½æ•°çš„ç®€å•ç±»ï¼š

```cpp
#include <iostream>

class Base {
public:
    virtual void print() {
        std::cout << "Base::print() called. this = " << this << std::endl;
    }
};

int main() {
    Base obj;
    obj.print();
    return 0;
}
```

è¾“å‡ºç»“æœå¯èƒ½ç±»ä¼¼äºï¼š

```
Base::print() called. this = 0x7ffdbf7ca6df
```

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ª `Base` ç±»çš„å¯¹è±¡ `obj` å¹¶è°ƒç”¨äº† `print()` æˆå‘˜å‡½æ•°ã€‚åœ¨ `print()` å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ‰“å°äº† `this` æŒ‡é’ˆçš„å€¼ï¼Œå®ƒæŒ‡å‘äº† `obj` å¯¹è±¡çš„åœ°å€ã€‚

æ‰€ä»¥ï¼ŒåŒ…å«è™šå‡½æ•°çš„ç±»æ˜¯æ”¯æŒä½¿ç”¨ `this` æŒ‡é’ˆçš„ï¼Œå¹¶ä¸”è¿™ä½¿å¾—ç±»çš„æˆå‘˜å‡½æ•°èƒ½å¤Ÿæ­£ç¡®åœ°ä¸å¯¹è±¡äº¤äº’ã€‚

2. åˆ¤æ–­ï¼šå¦‚æœä¸€ä¸ªç±»å¯èƒ½åšä¸ºåŸºç±»ä½¿ç”¨çš„è¯ï¼Œå°†å…¶ææ„å‡½æ•°è™šæ‹ŸåŒ–ï¼Œ è¿™æ ·å½“å…¶å­ç±»çš„å¯¹è±¡é€€å‡ºæ—¶ï¼Œä¹Ÿä¼šä¸€å¹¶è°ƒç”¨å­ç±»çš„ææ„å‡½æ•°é‡Šæ”¾å†…å­˜ã€‚ ï¼ˆâœ…ï¼‰

>[! note] åŸºç±»ææ„å‡½æ•°ä¸ºä»€ä¹ˆè¦è®¾ç½®ä¸ºè™šå‡½æ•°ï¼Ÿ
>å› ä¸ºå­ç±»çš„ææ„éœ€æ±‚ä¸ä¸€è‡´ï¼Œç”¨ç»Ÿä¸€çš„çˆ¶ç±»ææ„å‡½æ•°å¯èƒ½é€ æˆææ„ä¸å®Œå…¨ï¼Œå› æ­¤ä¸€èˆ¬è®¾ç½®çˆ¶ç±»ææ„å‡½æ•°ä¸ºè™šå‡½æ•°ï¼Œç„¶ååœ¨å­ç±»ä¸­å…·ä½“å®ç°ã€‚åœ¨çˆ¶ç±»æŒ‡é’ˆä¸‹ï¼Œæ ¹æ®å¯¹è±¡æ‰€å±å­ç±»åŠ¨æ€åœ°åŠ è½½å­ç±»ææ„å‡½æ•°

If a class is intended to be used as a base class and it has virtual functions (including the destructor), then when a derived class object is destroyed, its destructor will be called, followed by the destructor of the base class. This is known as "virtual destructor" behavior, and it ensures that the proper destructors are called in the correct order, allowing for proper cleanup and deallocation of resources, including memory.

Here's an example to illustrate the concept:

```cpp
#include <iostream>

class Base {
public:
    virtual ~Base() {
        std::cout << "Base destructor called." << std::endl;
    }
};

class Derived : public Base {
public:
    ~Derived() override {
        std::cout << "Derived destructor called." << std::endl;
    }
};

int main() {
    Base* obj = new Derived();
    delete obj;
    
    return 0;
}
```

Output:
```
Derived destructor called.
Base destructor called.
```

In this example, the `Base` class has a virtual destructor, and the `Derived` class overrides the destructor. When `delete obj;` is called in the `main` function, it first calls the `Derived` destructor and then the `Base` destructor due to the virtual destructor mechanism. This ensures that the destructors of both classes are called in the correct order, allowing proper cleanup.

Without a virtual destructor, if the destructor is not virtual in the base class, then only the base class's destructor would be called, and the derived class's destructor might not be executed, leading to potential memory leaks or improper cleanup. Therefore, when designing a class hierarchy where polymorphism and inheritance are involved, it's crucial to make the base class's destructor virtual to ensure proper destruction of derived class objects.

3. åˆ¤æ–­ç¨‹åºè¿è¡Œç»“æœï¼š
```cpp
#include <iostream>
using namespace std;
class A {
public:
    int b;
    char c;
    virtual void print() {
        cout << "this is fatherâ€™s fuction! " << endl;
    }
};
class B: A {
public:
    virtual void print() {
        cout << "this is childrenâ€™s fuction! " << endl;
    }
};
int main(int argc, char * argv[]) {
    cout << sizeof(A) << "" << sizeof(B) << endl;
    return 0;
}
```

âœ… Outputï¼š12 12

ç±»çš„å¤§å°åªä¸æˆå‘˜å˜é‡ï¼ˆé static æ•°æ®æˆå‘˜å˜é‡ï¼‰å’Œè™šå‡½æ•°æŒ‡é’ˆæœ‰å…³ï¼Œè¿˜è¦è€ƒè™‘åˆ°å¯¹é½ã€‚
- é‚£ä¹ˆç±» A çš„å¤§å°ç­‰äº 4 ä¸ªå­—èŠ‚ + 4 ä¸ªå­—èŠ‚ï¼ˆè€ƒè™‘å¯¹é½ï¼‰ + 4 ä¸ªå­—èŠ‚ï¼ˆæŒ‡å‘è™šå‡½æ•°çš„æŒ‡é’ˆï¼‰=12 å­—èŠ‚ï¼›
- ç±» B çš„å¤§å°å°±æ˜¯ç­‰äºç±» A çš„å¤§å° 12 ä¸ªå­—èŠ‚ã€‚

å› ä¸ºåœ¨åŸºç±»ä¸­å­˜åœ¨è™šå‡½æ•°æ—¶ï¼Œæ´¾ç”Ÿç±»ä¼šç»§æ‰¿åŸºç±»çš„è™šå‡½æ•°ï¼Œå› æ­¤æ´¾ç”Ÿç±»ä¸­ä¸å†å¢åŠ è™šå‡½æ•°çš„å­˜å‚¨ç©ºé—´ï¼ˆå› ä¸ºæ‰€æœ‰çš„è™šå‡½æ•°å…±äº«ä¸€å—å†…å­˜åŒºåŸŸï¼‰ï¼Œè€Œä»…ä»…éœ€è¦è€ƒè™‘æ´¾ç”Ÿç±»ä¸­æ·»åŠ è¿›æ¥çš„é static æ•°æ®æˆå‘˜çš„å†…å­˜ç©ºé—´å¤§å°ã€‚æ‰€ä»¥ç±» B å¤§å°ä¸º12 Byteã€‚

æ³¨æ„ï¼Œä¸Šè¿°è§„åˆ™ä¸é€‚ç”¨äº #è™šç»§æ‰¿ ï¼Œå¯¹äºè™šç»§æ‰¿è¿˜ä¼šå¤šå ä¸€ä»½å­˜å‚¨ç©ºé—´ã€‚

![[ä»€ä¹ˆæ˜¯è™šç»§æ‰¿ã€è™šåŸºç±»ï¼Ÿ]]

4. æ„é€ å‡½æ•°ä¸ºä»€ä¹ˆä¸èƒ½å£°æ˜ä¸ºè™šå‡½æ•°ï¼Ÿ

> [! note] æ„é€ å‡½æ•°ä¸èƒ½è¢« virtual ä¿®é¥°çš„åŸå› 
> 1. æ„é€ ä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œå¿…é¡»çŸ¥é“å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œè€Œè™šå‡½æ•°è¡Œä¸ºæ˜¯åœ¨è¿è¡ŒæœŸé—´ç¡®å®šå®é™…ç±»å‹çš„ã€‚è€Œåœ¨æ„é€ ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œç”±äºå¯¹è±¡è¿˜æœªæ„é€ æˆåŠŸã€‚ç¼–è¯‘å™¨æ— æ³•çŸ¥é“å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œæ˜¯è¯¥ç±»æœ¬èº«ï¼Œè¿˜æ˜¯è¯¥ç±»çš„ä¸€ä¸ªæ´¾ç”Ÿç±»ï¼Œæˆ–æ˜¯æ›´æ·±å±‚æ¬¡çš„æ´¾ç”Ÿç±»ã€‚æ— æ³•ç¡®å®šã€‚Â 
> 2. è™šå‡½æ•°çš„æ‰§è¡Œä¾èµ–äºè™šå‡½æ•°è¡¨ã€‚è€Œè™šå‡½æ•°è¡¨åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œåˆå§‹åŒ–å·¥ä½œï¼Œå³åˆå§‹åŒ–vptrï¼Œè®©ä»–æŒ‡å‘æ­£ç¡®çš„è™šå‡½æ•°è¡¨ã€‚è€Œåœ¨æ„é€ å¯¹è±¡æœŸé—´ï¼Œè™šå‡½æ•°è¡¨è¿˜æ²¡æœ‰è¢«åˆ å§‹åŒ–ï¼Œå°†æ— æ³•è¿›è¡Œã€‚ ææ„å‡½æ•°æ‰§è¡Œæ—¶å…ˆè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ï¼Œå…¶æ¬¡æ‰è°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ã€‚


### æŠ½è±¡ç±»
>[!note] çº¯è™šå‡½æ•°ä¸æŠ½è±¡ç±»çš„å…³ç³»ï¼š
>æŠ½è±¡ç±»ä¸­è‡³å°‘æœ‰ä¸€ä¸ªçº¯è™šå‡½æ•°ã€‚
>
>å¦‚æœæŠ½è±¡ç±»ä¸­çš„æ´¾ç”Ÿç±»æ²¡æœ‰ä¸ºåŸºç±»çš„çº¯è™šå‡½æ•°å®šä¹‰å®ç°ç‰ˆæœ¬ï¼Œé‚£ä¹ˆå®ƒä»ç„¶æ˜¯æŠ½è±¡ç±»ï¼Œç›¸åï¼Œå®šä¹‰äº†çº¯è™šå‡½æ•°çš„å®ç°ç‰ˆæœ¬çš„æ´¾ç”Ÿç±»ç§°ä¸ºå…·ä½“ç±»ã€‚
>
>æŠ½è±¡ç±»åœ¨ C++ä¸­æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š
>1. æŠ½è±¡ç±»åªèƒ½ä½œä¸ºå…¶ä»–ç±»çš„åŸºç±»ï¼›
>2. æŠ½è±¡ç±»ä¸èƒ½å»ºç«‹å¯¹è±¡ï¼›
>3. æŠ½è±¡ç±»ä¸èƒ½ç”¨ä½œå‚æ•°ç±»å‹ã€å‚æ•°è¿”å›ç±»å‹æˆ–æ˜¾ç¤ºç±»å‹è½¬æ¢ã€‚

1. åˆ¤æ–­å…³äºæŠ½è±¡ç±»è¯´æ³•çš„æ­£è¯¯ï¼š

A. æŠ½è±¡ç±»ä¸­å¯ä»¥ä¸å­˜åœ¨ä»»ä½•æŠ½è±¡æ–¹æ³•  âŒ
B. æŠ½è±¡ç±»å¯ä»¥ä¸º final çš„  âŒ
C. æŠ½è±¡ç±»å¯ä»¥è¢«æŠ½è±¡ç±»æ‰€ç»§æ‰¿  âœ…
D. å¦‚æœä¸€ä¸ªéæŠ½è±¡ç±»ä»æŠ½è±¡ç±»ä¸­æ´¾ç”Ÿï¼Œä¸ä¸€å®šè¦é€šè¿‡è¦†ç›–æ¥å®ç°ç»§æ‰¿çš„æŠ½è±¡æˆå‘˜  âŒ
E. æŠ½è±¡ç±»ä¸èƒ½ç”¨ä½œå‚æ•°ç±»å‹ã€å‡½æ•°è¿”å›ç±»å‹æˆ–æ˜¾å¼è½¬æ¢ç±»å‹ âœ…

>[! note] æŠ½è±¡ç±»
>A âŒã€‚æŠ½è±¡ç±»å¿…é¡»è‡³å°‘åŒ…å«ä¸€ä¸ªçº¯è™šå‡½æ•°ï¼ˆæŠ½è±¡æ–¹æ³•ï¼‰ï¼Œå¦åˆ™å®ƒå°±ä¸æ˜¯æŠ½è±¡ç±»ã€‚
>B âŒã€‚å› ä¸º final çš„ç±»ä¸å¯ä»¥è¢«ç»§æ‰¿ï¼Œåªèƒ½ç”¨äºç”Ÿæˆå®ä¾‹å¯¹è±¡ï¼›æŠ½è±¡ç±»ä¸èƒ½ç”¨äºç”Ÿæˆå®ä¾‹å¯¹è±¡ï¼Œå› æ­¤ï¼ŒæŠ½è±¡ç±»ä¸èƒ½æ˜¯ final.
>C âœ…ã€‚å¦‚æœæˆ‘ä»¬ä¸åœ¨æ´¾ç”Ÿç±»ä¸­è¦†ç›–çº¯è™šå‡½æ•°ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»ä¹Ÿä¼šå˜æˆæŠ½è±¡ç±»ï¼Œæ‰€ä»¥æŠ½è±¡ç±»å¯ä»¥è¢«æŠ½è±¡ç±»ç»§æ‰¿
>D âŒã€‚åŒC
>E âœ…ã€‚æŠ½è±¡ç±»æœ¬èº«ä¸èƒ½å®ä¾‹åŒ–å¯¹è±¡ï¼Œå› æ­¤æ— æ³•ä¼ å…¥æˆ–è¿”å›å®é™…çš„å¯¹è±¡ï¼›å¹¶ä¸”æŠ½è±¡ç±»åœ¨è¿›è¡Œéšå¼æˆ–æ˜¾å¼è½¬æ¢æ—¶ä¼šå¼•èµ·æ­§ä¹‰ï¼Œä¸ç¡®å®šè½¬æ¢æŒ‡å‘å…·ä½“å“ªä¸ªå­ç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨

### ç±»çš„å†…å­˜ç©ºé—´
1. å…³äºç±»å ç”¨å†…å­˜ç©ºé—´çš„è¯´æ³•æ­£ç¡®çš„æ˜¯ï¼šï¼ˆBã€Cï¼‰
A ç±»æ‰€å å†…å­˜çš„å¤§å°æ˜¯ç”±æˆå‘˜å˜é‡ï¼ˆé™æ€å˜é‡é™¤å¤–ï¼‰å†³å®šçš„
B ç©ºç±»çš„å†…å­˜å¤§å°æ˜¯ï¼‘ä¸ªå­—èŠ‚
C ç±»ä¸­æ— è®ºæœ‰å¤šå°‘ä¸ªè™šå‡½æ•°ï¼Œåªä¼šå¤šå ä¸€ä¸ª #è™šè¡¨æŒ‡é’ˆç©ºé—´
D å­ç±»çš„å†…å­˜å¤§å°ç­‰äºçˆ¶ç±»çš„å†…å­˜å¤§å°åŠ ä¸Šå­ç±»ç‹¬æœ‰æˆå‘˜å˜é‡çš„å†…å­˜å¤§å°

>[! note] å½±å“ç±»æ‰€å å†…å­˜å¤§å°çš„å› ç´ 
>åœ¨ C++ä¸­ï¼Œç±»æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å¤§å°ç”±ä»¥ä¸‹å‡ ä¸ªå› ç´ å†³å®šï¼š
>1. ç±»çš„æˆå‘˜å˜é‡ï¼šç±»çš„æˆå‘˜å˜é‡ä¼šå ç”¨å†…å­˜ç©ºé—´ã€‚æ¯ä¸ªæˆå‘˜å˜é‡çš„å¤§å°å–å†³äºå…¶ç±»å‹ï¼Œä¾‹å¦‚ intã€charã€æŒ‡é’ˆç­‰ã€‚ç±»çš„å†…å­˜å¤§å°å°†åŒ…æ‹¬æ‰€æœ‰æˆå‘˜å˜é‡çš„å¤§å°ä¹‹å’Œã€‚
>2. å¯¹é½ï¼ˆAlignmentï¼‰ï¼šä¸ºäº†æé«˜å†…å­˜è®¿é—®çš„æ•ˆç‡ï¼Œç¼–è¯‘å™¨é€šå¸¸ä¼šå¯¹ç±»çš„æˆå‘˜è¿›è¡Œå¯¹é½ã€‚å¯¹é½è§„åˆ™å¯ä»¥æ ¹æ®ç¼–è¯‘å™¨ã€ç¼–è¯‘é€‰é¡¹å’Œå¹³å°è€Œæœ‰æ‰€ä¸åŒã€‚å¯¹é½å¯èƒ½å¯¼è‡´å¡«å……å­—èŠ‚çš„å­˜åœ¨ï¼Œä»¥ç¡®ä¿æˆå‘˜å˜é‡æŒ‰ç…§å¯¹é½è¦æ±‚æ’åˆ—ã€‚å¯¹é½çš„è§„åˆ™å¯ä»¥é€šè¿‡ç¼–è¯‘å™¨çš„æŒ‡ä»¤æˆ–è€…é¢„å¤„ç†å™¨æŒ‡ä»¤è¿›è¡Œè°ƒæ•´ã€‚
>3. ç»§æ‰¿ï¼ˆInheritanceï¼‰ï¼šå¦‚æœç±»ç»§æ‰¿è‡ªå…¶ä»–ç±»ï¼Œé‚£ä¹ˆå®ƒä¼šç»§æ‰¿çˆ¶ç±»çš„æˆå‘˜å˜é‡ã€‚ç»§æ‰¿å…³ç³»å¯èƒ½ä¼šå¯¼è‡´é¢å¤–çš„å†…å­˜å¼€é”€ï¼Œä¾‹å¦‚è™šå‡½æ•°è¡¨æŒ‡é’ˆï¼ˆåœ¨å¤šæ€æƒ…å†µä¸‹ï¼‰å’ŒåŸºç±»çš„æˆå‘˜å˜é‡ã€‚
>4. è™šå‡½æ•°ï¼ˆVirtual Functionsï¼‰ï¼šå¦‚æœç±»ä¸­å­˜åœ¨è™šå‡½æ•°ï¼ˆé€šè¿‡ virtual å…³é”®å­—å£°æ˜çš„å‡½æ•°ï¼‰ï¼Œåˆ™é€šå¸¸ä¼šæœ‰ä¸€ä¸ªæŒ‡å‘è™šå‡½æ•°è¡¨çš„æŒ‡é’ˆã€‚è™šå‡½æ•°è¡¨ï¼ˆvtableï¼‰å­˜å‚¨äº†ç±»çš„è™šå‡½æ•°çš„åœ°å€ï¼Œè¿™ä¼šå¢åŠ ç±»çš„å¤§å°ã€‚
>
>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä»¥ä¸Šå› ç´ å¯èƒ½å—åˆ°ç¼–è¯‘å™¨å’Œå¹³å°çš„å½±å“ï¼Œä¸åŒçš„ç¼–è¯‘å™¨å’Œä¸åŒçš„å¹³å°å¯èƒ½ä¼šäº§ç”Ÿä¸åŒçš„å†…å­˜å¸ƒå±€å’Œå¤§å°ã€‚
>
>å¯ä»¥ä½¿ç”¨ C++ä¸­çš„ sizeof è¿ç®—ç¬¦æ¥è·å–ç±»çš„å¤§å°ï¼Œä¾‹å¦‚ `sizeof(MyClass)` å°†è¿”å›ç±» MyClass çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚
>
>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç±»çš„å¤§å°ä¸åŒ…æ‹¬ç±»çš„æˆå‘˜å‡½æ•°ã€‚æˆå‘˜å‡½æ•°æ˜¯å…±äº«çš„ï¼Œä¸ä¼šåœ¨æ¯ä¸ªç±»çš„å®ä¾‹ä¸­å¤åˆ¶ã€‚å®ƒä»¬é€šå¸¸åœ¨ä»£ç æ®µä¸­å­˜å‚¨ï¼Œå¹¶ä¸å ç”¨ç±»çš„å®ä¾‹çš„å†…å­˜ç©ºé—´ã€‚

>[!note] ç©ºç±»çš„å†…å­˜å ç”¨
>åœ¨ C++ä¸­ï¼Œç©ºç±»ï¼ˆæ²¡æœ‰æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼‰çš„å¤§å°ä¸ä¼šæ˜¯é›¶ï¼Œè€Œæ˜¯ä¸€ä¸ªéé›¶å€¼ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸ªç±»å®ä¾‹åœ¨å†…å­˜ä¸­éƒ½åº”è¯¥å…·æœ‰å”¯ä¸€çš„åœ°å€ï¼Œä»¥ä¾¿äºè¿›è¡ŒåŒºåˆ†ã€‚
>
>æ ¹æ® C++æ ‡å‡†çš„è§„å®šï¼Œç©ºç±»çš„å¤§å°è‡³å°‘ä¸º 1 å­—èŠ‚ã€‚è¿™æ ·åšæ˜¯ä¸ºäº†ç¡®ä¿æ¯ä¸ªå®ä¾‹éƒ½å…·æœ‰å”¯ä¸€çš„åœ°å€ï¼Œä»¥æ»¡è¶³å†…å­˜å¯¹é½çš„è¦æ±‚ã€‚
>
>å®é™…ä¸Šï¼Œç¼–è¯‘å™¨ä¸ºäº†æ»¡è¶³å¯¹é½è¦æ±‚ï¼Œæœ‰å¯èƒ½åœ¨ç©ºç±»ä¸­æ’å…¥ä¸€ä¸ªå­—èŠ‚çš„å¡«å……ã€‚è¿™æ ·ï¼Œç©ºç±»çš„å¤§å°é€šå¸¸æ˜¯ 1 å­—èŠ‚ï¼Œä½†ä¹Ÿå¯ä»¥æ›´å¤§ï¼Œå…·ä½“å–å†³äºç¼–è¯‘å™¨çš„å®ç°ã€‚

>[! note] è™šå‡½æ•°çš„å†…å­˜å ç”¨
>åœ¨ C++ä¸­ï¼Œæ— è®ºç±»ä¸­æœ‰å¤šå°‘ä¸ªè™šå‡½æ•°ï¼Œé€šå¸¸åªä¼šé¢å¤–å ç”¨ä¸€ä¸ªæŒ‡å‘è™šå‡½æ•°è¡¨ï¼ˆvtableï¼‰çš„æŒ‡é’ˆç©ºé—´ã€‚è¿™ä¸ªæŒ‡é’ˆè¢«ç§°ä¸ºè™šè¡¨æŒ‡é’ˆï¼ˆvptrï¼‰ã€‚
>
>è™šè¡¨æŒ‡é’ˆæ˜¯ä¸€ä¸ªæŒ‡å‘è™šå‡½æ•°è¡¨çš„æŒ‡é’ˆï¼Œè™šå‡½æ•°è¡¨æ˜¯ä¸€ä¸ªå­˜å‚¨äº†ç±»ä¸­è™šå‡½æ•°åœ°å€çš„è¡¨æ ¼ã€‚è™šè¡¨æŒ‡é’ˆçš„å¤§å°é€šå¸¸æ˜¯ä¸€ä¸ªæœºå™¨å­—ï¼ˆé€šå¸¸ä¸º 4 å­—èŠ‚æˆ– 8 å­—èŠ‚ï¼‰ï¼Œå®ƒæŒ‡å‘è™šå‡½æ•°è¡¨ï¼Œè€Œä¸æ˜¯å­˜å‚¨å®é™…çš„å‡½æ•°ä»£ç ã€‚è™šè¡¨æŒ‡é’ˆå­˜åœ¨äºæ¯ä¸ªç±»çš„å®ä¾‹ä¸­ï¼Œç”¨äºæ”¯æŒåŠ¨æ€ç»‘å®šï¼ˆè¿è¡Œæ—¶å¤šæ€æ€§ï¼‰ã€‚
>
>æ— è®ºç±»ä¸­æœ‰å¤šå°‘ä¸ªè™šå‡½æ•°ï¼Œåªä¼šæœ‰ä¸€ä¸ªè™šè¡¨æŒ‡é’ˆã€‚è¿™æ˜¯å› ä¸ºè™šå‡½æ•°è¡¨æ˜¯ç”±ç±»çš„æ•´ä¸ªç»§æ‰¿å±‚æ¬¡ç»“æ„å…±äº«çš„ï¼Œæ¯ä¸ªç±»å®ä¾‹ä¸­åªéœ€è¦ä¸€ä¸ªæŒ‡é’ˆæ¥å¼•ç”¨è™šå‡½æ•°è¡¨ã€‚
>
>å…¶ä»–çš„éè™šå‡½æ•°å’Œé™æ€å‡½æ•°ä¸ä¼šå ç”¨é¢å¤–çš„å†…å­˜ç©ºé—´ï¼Œå®ƒä»¬æ˜¯ç±»çš„å…±äº«æˆå‘˜ï¼Œä¸ä¼šåœ¨æ¯ä¸ªç±»çš„å®ä¾‹ä¸­å¤åˆ¶ã€‚
>
>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™šè¡¨æŒ‡é’ˆçš„å­˜åœ¨ä¼šå¢åŠ ç±»çš„å¤§å°ï¼Œå¹¶ä¸”è™šå‡½æ•°çš„è°ƒç”¨ä¼šåœ¨è¿è¡Œæ—¶è¿›è¡ŒæŸ¥æ‰¾å’Œè§£æï¼Œå› æ­¤ä¼šç•¥å¾®å½±å“æ€§èƒ½ã€‚ä½†è¿™ç§å¼€é”€é€šå¸¸æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå¹¶ä¸”ä¸ºå®ç°è¿è¡Œæ—¶å¤šæ€æ€§æä¾›äº†é‡è¦çš„æœºåˆ¶ã€‚

>[!note] å­ç±»å†…å­˜å ç”¨å¤§å°ä¸çˆ¶ç±»å†…å­˜å¤§å°çš„å…³ç³»
>å­ç±»çš„å†…å­˜å¤§å°é€šå¸¸æ˜¯çˆ¶ç±»çš„å†…å­˜å¤§å°åŠ ä¸Šå­ç±»æ–°å¢çš„æˆå‘˜å˜é‡çš„å¤§å°ã€‚è¿™æ˜¯å› ä¸ºå­ç±»ä¼šç»§æ‰¿çˆ¶ç±»çš„æˆå‘˜å˜é‡ï¼Œå¹¶åœ¨å…¶åŸºç¡€ä¸Šæ·»åŠ è‡ªå·±çš„æˆå‘˜å˜é‡ã€‚
>
>å­ç±»ç»§æ‰¿äº†çˆ¶ç±»çš„æˆå‘˜å˜é‡ï¼ŒåŒ…æ‹¬ç»§æ‰¿è¿‡æ¥çš„ç§æœ‰æˆå‘˜å˜é‡ã€‚ç„¶è€Œï¼Œåœ¨å†…å­˜ä¸­ï¼Œå­ç±»çš„å®ä¾‹åŒ…å«äº†çˆ¶ç±»çš„æˆå‘˜å˜é‡çš„å†…å­˜ç©ºé—´ï¼Œè€Œä¸æ˜¯ç®€å•åœ°å¼•ç”¨å®ƒä»¬ã€‚
>
>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨å¯èƒ½å¯¹å­ç±»çš„å†…å­˜å¸ƒå±€è¿›è¡Œä¼˜åŒ–ï¼Œä¾‹å¦‚é€šè¿‡é‡æ’æˆå‘˜å˜é‡çš„é¡ºåºæ¥å‡å°‘å†…å­˜ç©ºé—´çš„æµªè´¹ã€‚è¿™æ„å‘³ç€å­ç±»çš„å†…å­˜å¤§å°å¯èƒ½ä¸ç­‰äºçˆ¶ç±»çš„å†…å­˜å¤§å°åŠ ä¸Šå­ç±»æ–°å¢æˆå‘˜å˜é‡çš„å¤§å°ã€‚
>
>æ­¤å¤–ï¼Œå¦‚æœå­ç±»é‡å†™äº†çˆ¶ç±»çš„è™šå‡½æ•°ï¼Œå¹¶ä¸”çˆ¶ç±»ä¸­çš„è™šå‡½æ•°ä½¿ç”¨äº†è™šè¡¨æŒ‡é’ˆï¼ˆvptrï¼‰ï¼Œé‚£ä¹ˆå­ç±»å®ä¾‹ä¸­ä¹Ÿä¼šå­˜åœ¨ä¸€ä¸ªæŒ‡å‘å­ç±»çš„è™šå‡½æ•°è¡¨çš„è™šè¡¨æŒ‡é’ˆã€‚è¿™ä¼šå¢åŠ å­ç±»çš„å†…å­˜å¤§å°
>
>æ€»ç»“èµ·æ¥ï¼Œå­ç±»çš„å†…å­˜å¤§å°ä¸ä»…å–å†³äºæ–°å¢çš„æˆå‘˜å˜é‡çš„å¤§å°ï¼Œè¿˜å¯èƒ½å—åˆ°ç¼–è¯‘å™¨çš„ä¼˜åŒ–å’Œè™šå‡½æ•°è¡¨æŒ‡é’ˆçš„å½±å“ã€‚å› æ­¤ï¼Œç®€å•åœ°å°†å­ç±»çš„å†…å­˜å¤§å°å®šä¹‰ä¸ºçˆ¶ç±»çš„å†…å­˜å¤§å°åŠ ä¸Šå­ç±»æ–°å¢æˆå‘˜å˜é‡çš„å¤§å°æ˜¯ä¸å‡†ç¡®çš„ã€‚åœ¨å®é™…æƒ…å†µä¸­ï¼Œå­ç±»çš„å†…å­˜å¤§å°å¯èƒ½ä¼šæœ‰æ‰€å˜åŒ–ã€‚

### é™æ€æˆå‘˜
1. ä¸‹åˆ—å…³äºé™æ€æˆå‘˜çš„æè¿°æ­£è¯¯æ€§åˆ¤æ–­ï¼š
- é™æ€æˆå‘˜ä¸å±äºå¯¹è±¡ï¼Œæ˜¯ç±»çš„å…±äº«æˆå‘˜ (âŒ)
- Cpp 11 ä¹‹å‰ï¼Œé const çš„é™æ€æ•°æ®æˆå‘˜è¦åœ¨ç±»å¤–å®šä¹‰å’Œåˆå§‹åŒ– (âœ…)
- é™æ€æˆå‘˜å‡½æ•°ä¸æ‹¥æœ‰ this æŒ‡é’ˆï¼Œéœ€è¦é€šè¿‡ç±»å‚æ•°è®¿é—®å¯¹è±¡æˆå‘˜ (âœ…)
- åªæœ‰é™æ€æˆå‘˜å‡½æ•°å¯ä»¥æ“ä½œé™æ€æ•°æ®æˆå‘˜ (âŒ)   _å½“ç„¶ä¸æ˜¯ï¼Œé™æ€æ•°æ®æˆå‘˜å±äºç±»ï¼Œéé™æ€æˆå‘˜å‡½æ•°ä¹Ÿå¯ä»¥è®¿é—®_

![[Cpp 11å‰å é™æ€æˆå‘˜çš„å®šä¹‰ä¸åˆå§‹åŒ–é—®é¢˜#ä¸ºä»€ä¹ˆéè¦åœ¨ç±»å¤–å®šä¹‰å’Œåˆå§‹åŒ–ï¼Ÿ]]

![[Cpp 11å‰å é™æ€æˆå‘˜çš„å®šä¹‰ä¸åˆå§‹åŒ–é—®é¢˜#Cpp 11 ä¿®æ”¹äº†ä»€ä¹ˆï¼Ÿ]]

2. static ç±»å‹çš„å˜é‡ï¼Œé»˜è®¤åˆå§‹åŒ–çš„å€¼æ˜¯ï¼Ÿ
>[!note] é™æ€ç±»å‹åˆå§‹åŒ–
>é™æ€å˜é‡åœ¨æ²¡æœ‰æ˜¾å¼åˆå§‹åŒ–çš„æ—¶å€™ä¼šè¢«åˆå§‹åŒ–ä¸º0æˆ–è€…null

### ç±»å‹å®‰å…¨
1. MFC ä¸­ CString æ˜¯ç±»å‹å®‰å…¨çš„ç±»å—ï¼Ÿ

>[! note] ç±»çš„ç±»å‹å®‰å…¨
>åœ¨ C++ä¸­ï¼Œç±»çš„ç±»å‹å®‰å…¨æ˜¯æŒ‡ç±»åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­èƒ½å¤Ÿä¿è¯ç±»å‹çš„æ­£ç¡®æ€§ï¼Œé˜²æ­¢æ„å¤–ç±»å‹è½¬æ¢å’Œç±»å‹ä¸åŒ¹é…çš„é”™è¯¯ã€‚C++é€šè¿‡è®¸å¤šæœºåˆ¶æ¥å®ç°ç±»çš„ç±»å‹å®‰å…¨ï¼ŒåŒ…æ‹¬
>1. å¼ºç±»å‹ç³»ç»Ÿï¼šC++æ˜¯ä¸€ç§å¼ºç±»å‹çš„è¯­è¨€ï¼Œè¦æ±‚å˜é‡åœ¨ä½¿ç”¨å‰å¿…é¡»å£°æ˜å…¶ç±»å‹ï¼Œå¹¶ä¸”ä¸å…è®¸éšå¼çš„ç±»å‹è½¬æ¢ã€‚è¿™å¯ä»¥é¿å…æ„å¤–çš„ç±»å‹è½¬æ¢å’Œç±»å‹ä¸åŒ¹é…ã€‚
>2. ç±»çš„æˆå‘˜è®¿é—®æ§åˆ¶ï¼šC++å…è®¸åœ¨ç±»ä¸­ä½¿ç”¨å…¬æœ‰ï¼ˆpublicï¼‰ã€ç§æœ‰ï¼ˆprivateï¼‰å’Œä¿æŠ¤ï¼ˆprotectedï¼‰æˆå‘˜æ¥æ§åˆ¶å¯¹ç±»çš„æˆå‘˜çš„è®¿é—®æƒé™ã€‚è¿™æ ·å¯ä»¥é™åˆ¶å¤–éƒ¨ä»£ç å¯¹ç±»çš„ç§æœ‰æˆå‘˜çš„è®¿é—®ï¼Œå¢å¼ºç±»å‹å®‰å…¨æ€§ã€‚
>3. æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ï¼šæ„é€ å‡½æ•°å’Œææ„å‡½æ•°æ˜¯åœ¨å¯¹è±¡åˆ›å»ºå’Œé”€æ¯æ—¶è‡ªåŠ¨è°ƒç”¨çš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œå®ƒä»¬ç¡®ä¿å¯¹è±¡çš„åˆå§‹åŒ–å’Œèµ„æºçš„é‡Šæ”¾ï¼Œé¿å…æœªåˆå§‹åŒ–å’Œèµ„æºæ³„æ¼çš„æƒ…å†µã€‚
>4. è¿ç®—ç¬¦é‡è½½ï¼šC++å…è®¸ç±»é€šè¿‡è¿ç®—ç¬¦é‡è½½æ¥å®šä¹‰è‡ªå·±çš„æ“ä½œè¡Œä¸ºï¼Œé¿å…ä¸åˆç†çš„è¿ç®—ç¬¦ä½¿ç”¨ï¼Œæé«˜ç±»å‹å®‰å…¨æ€§ã€‚

å…³äº MFC ä¸­çš„ CString ç±»ï¼ŒCString è¢«è®¤ä¸ºæ˜¯ç±»å‹å®‰å…¨çš„ç±»ã€‚CString æ˜¯ MFCï¼ˆMicrosoft Foundation Classesï¼‰ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²ç±»ï¼Œå®ƒæä¾›äº†è®¸å¤šå­—ç¬¦ä¸²æ“ä½œåŠŸèƒ½ï¼Œå¹¶ä¸”åœ¨å†…éƒ¨ç»´æŠ¤äº†å­—ç¬¦ä¸²çš„é•¿åº¦å’Œç¼“å†²åŒºã€‚CString ç±»é€šè¿‡ä½¿ç”¨ C++çš„ç‰¹æ€§ï¼Œå¦‚è¿ç®—ç¬¦é‡è½½å’Œæˆå‘˜å‡½æ•°ï¼Œæ¥ç¡®ä¿åœ¨å­—ç¬¦ä¸²æ“ä½œä¸­ç±»å‹å®‰å…¨ã€‚

ç”±äº CString ç±»åœ¨å†…éƒ¨ç®¡ç†å­—ç¬¦ä¸²çš„é•¿åº¦å’Œå†…å­˜åˆ†é…ï¼Œå®ƒå¯ä»¥é˜²æ­¢ç¼“å†²åŒºæº¢å‡ºç­‰å¸¸è§çš„å­—ç¬¦ä¸²å¤„ç†é”™è¯¯ã€‚åŒæ—¶ï¼ŒCString ç±»è¿˜æä¾›äº†ç±»å‹å®‰å…¨çš„å­—ç¬¦ä¸²æ“ä½œæ¥å£ï¼Œå¦‚ `GetLength()` å’Œ `Left()` ç­‰æˆå‘˜å‡½æ•°ï¼Œé¿å…äº†ç›´æ¥æ“ä½œå­—ç¬¦æ•°ç»„çš„é£é™©ã€‚

### å‹å…ƒå‡½æ•°
1. åˆ¤æ–­å…³äº C++ä¸­çš„å‹å…ƒå‡½æ•°è¯´æ³•çš„æ­£è¯¯ï¼š
- å‹å…ƒå‡½æ•°éœ€è¦é€šè¿‡å¯¹è±¡æˆ–æŒ‡é’ˆè°ƒç”¨ âŒ
- å‹å…ƒå‡½æ•°æ˜¯ä¸èƒ½è¢«ç»§æ‰¿çš„         âœ…
- å‹å…ƒå‡½æ•°æ²¡æœ‰ this æŒ‡é’ˆ         âœ…
- å‹å…ƒå‡½æ•°ç ´ç¯äº†ç»§æ‰¿æ€§æœºåˆ¶       âŒ

> [! note] å‹å…ƒå‡½æ•°
> å‹å…ƒå‡½æ•°æ˜¯ä¸€ç§åœ¨ç±»å¤–å®šä¹‰ï¼Œåœ¨ç±»å†…ç‰¹æ®Šå£°æ˜ (åŠ å…³é”®å­— friend)ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ç±»å¤–è®¿é—®ç±»çš„æ‰€æœ‰æˆå‘˜çš„éæˆå‘˜å‡½æ•°ã€‚å‹å…ƒå‡½æ•°ç›¸å¯¹äºæ™®é€šå‡½æ•°ï¼Œå¢åŠ äº†è®¿é—®ç±»æˆå‘˜çš„æƒåˆ©ã€‚
> - å‹å…ƒå‡½æ•°å¯ä»¥åƒæ™®é€šå‡½æ•°ä¸€æ ·ç›´æ¥è°ƒç”¨ï¼Œä¸éœ€è¦é€šè¿‡å¯¹è±¡æˆ–æŒ‡é’ˆï¼›
> - å…ƒå‡½æ•°ä¸æ˜¯æˆå‘˜å‡½æ•°ï¼Œæ‰€ä»¥ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä¹ŸåŒæ ·æ²¡æœ‰ this æŒ‡é’ˆï¼›
> - ç”±äºå‹å…ƒå‡½æ•°å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«ä»…ä»…æ˜¯å…·æœ‰è®¿é—®ç±»æˆå‘˜çš„æƒåˆ©ï¼Œå’Œç»§æ‰¿æ€§æœºåˆ¶æ²¡æœ‰å…³ç³»

### ç±»çš„å®ä¾‹åŒ–
1. åˆ¤æ–­ä¸‹é¢è¯­å¥æ‰§è¡Œåï¼Œåœ¨å†…å­˜ä¸­åˆ›å»ºäº†å¤šå°‘ä¸ªå¯¹è±¡ï¼š
```cpp
CSomething a();
CSomething b(2);
CSomething c[3];
CSomething &ra = b;
CSomething d = b;
CSomething *pA = c;
CSomething *p = new CSomething(4);
```

**ANSWER**ï¼š6

- `CSomething a ();` æ²¡æœ‰åˆ›å»ºå¯¹è±¡ï¼Œè¿™é‡Œä¸æ˜¯ä½¿ç”¨é»˜è®¤æ„é€ å‡½æ•°ï¼Œè€Œæ˜¯å£°æ˜äº†ä¸€ä¸ªå‡½æ•°ï¼Œ[[10-Class(I)#^00dfc6|é»˜è®¤æ„é€ å‡½æ•°å¦‚ä½•è°ƒç”¨ï¼Ÿ]]ã€‚
- `CSomething b (2);` ä½¿ç”¨ä¸€ä¸ªå‚æ•°çš„æ„é€ å‡½æ•°ï¼Œåˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ã€‚ 
- `CSomething c[3];` ä½¿ç”¨æ— å‚æ„é€ å‡½æ•°ï¼Œåˆ›å»ºäº† 3 ä¸ªå¯¹è±¡ã€‚
- `CSomething &ra=b;` ra å¼•ç”¨ bï¼Œæ²¡æœ‰åˆ›å»ºæ–°å¯¹è±¡ã€‚
- `CSomething d=b;` ä½¿ç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ dã€‚ 
- `CSomething *pA = c;` åˆ›å»ºæŒ‡é’ˆï¼ŒæŒ‡å‘å¯¹è±¡ cï¼Œæ²¡æœ‰æ„é€ æ–°å¯¹è±¡ã€‚ 
- `CSomething *p = new CSomething(4);` æ–°å»ºä¸€ä¸ªå¯¹è±¡ã€‚ 

ç»¼ä¸Šï¼Œä¸€å…±åˆ›å»ºäº†6ä¸ªå¯¹è±¡ã€‚

### å¸¸å¯¹è±¡
1. åˆ¤æ–­ä»¥ä¸‹ç¨‹åºçš„è¾“å‡ºï¼š
```cpp
#include<iostream>
using namespace std;
class R
{
public:
    R(int r1,int r2)
    {
        R1=r1;
        R2=r2;
    }
    void print()
    void print() const;
private:
    int R1,R2;
};
void R::print()
{
    cout<<R2<<","<<R1<<endl;
}
void R::print() const
{
    cout<<R1<<","<<R2<<endl;
}
int main()
{
    R a(6,8);
    const R b(56,88);
    b.print();
    return 0;
}
```

**ANSWER**ï¼š56,88

1) æœ‰ const ä¿®é¥°çš„æˆå‘˜å‡½æ•°ï¼ˆæŒ‡ const æ”¾åœ¨å‡½æ•°å‚æ•°è¡¨çš„åé¢ï¼Œè€Œä¸æ˜¯åœ¨å‡½æ•°å‰é¢æˆ–è€…å‚æ•°è¡¨å†…ï¼‰ï¼Œåªèƒ½è¯»å–æ•°æ®æˆå‘˜ï¼Œä¸èƒ½æ”¹å˜æ•°æ®æˆå‘˜ï¼›æ²¡æœ‰ const ä¿®é¥°çš„æˆå‘˜å‡½æ•°ï¼Œå¯¹æ•°æ®æˆå‘˜åˆ™æ˜¯å¯è¯»å¯å†™çš„ã€‚
2) å¸¸é‡ï¼ˆå³ constï¼‰å¯¹è±¡å¯ä»¥è°ƒç”¨ const æˆå‘˜å‡½æ•°ï¼Œè€Œä¸èƒ½è°ƒç”¨éconstä¿®é¥°çš„å‡½æ•°ã€‚

ç»¼ä¸Šï¼šÂ `const R b(56,88)`ï¼Œæ˜¯å¸¸å¯¹è±¡ï¼Œåªèƒ½è°ƒç”¨ const ä¿®é¥°çš„å¸¸æˆå‘˜å‡½æ•°ï¼Œå³è°ƒç”¨
`voidR::print()Â const{cout<<R1<<","<<R2<<endl;}`


## é¢å‘å¯¹è±¡
### å¤šæ€
1. åˆ†æé‡è½½ overload å’Œé‡å†™ override çš„åŒºåˆ«ã€‚
- **å‡½æ•°çš„é‡è½½**ï¼šC++å…è®¸åœ¨åŒä¸€èŒƒå›´ä¸­å£°æ˜å‡ ä¸ªåŠŸèƒ½ç±»ä¼¼çš„åŒåå‡½æ•°ï¼Œä½†æ˜¯è¿™äº›åŒåå‡½æ•°çš„å½¢å¼å‚æ•°ï¼ˆæŒ‡å‚æ•°çš„ä¸ªæ•°ã€ç±»å‹æˆ–è€…é¡ºåºï¼‰å¿…é¡»ä¸åŒï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨åŒä¸€ä¸ªå‡½æ•°å®Œæˆä¸åŒçš„åŠŸèƒ½ã€‚è¿™å°±æ˜¯é‡è½½å‡½æ•°ã€‚*é‡è½½å‡½æ•°å¸¸ç”¨æ¥å®ç°åŠŸèƒ½ç±»ä¼¼è€Œæ‰€å¤„ç†çš„æ•°æ®ç±»å‹ä¸åŒçš„é—®é¢˜ã€‚ä¸èƒ½åªæœ‰å‡½æ•°è¿”å›å€¼ç±»å‹ä¸åŒã€‚*
	ä¸¤ä¸ªé‡è½½å‡½æ•°å¿…é¡»åœ¨ä¸‹åˆ—ä¸€ä¸ªæˆ–ä¸¤ä¸ªæ–¹é¢æœ‰æ‰€åŒºåˆ«ï¼š 
	- å‡½æ•°çš„å‚æ•°ä¸ªæ•°ä¸åŒã€‚
	- å‡½æ•°çš„å‚æ•°ç±»å‹ä¸åŒæˆ–è€…å‚æ•°ç±»å‹é¡ºåºä¸åŒï¼Œ  
  
- **å‡½æ•°çš„é‡å†™**ï¼šå¤šæ€ä¸­æåˆ°çš„ï¼Œä¸€èˆ¬çˆ¶ç±»å‡½æ•°ä¸­æœ‰è™šå‡½æ•°ï¼Œè™šå‡½æ•°åŒ…å«è™šå‡½æ•°æŒ‡é’ˆï¼ŒæŒ‡å‘è™šå‡½æ•°è¡¨ã€‚åœ¨å­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œä¼šä¸€åŒæŠŠè™šå‡½æ•°ç»§æ‰¿ä¸‹æ¥ï¼ŒåŒæ—¶ä¹Ÿä¼šæŠŠè™šå‡½æ•°æŒ‡é’ˆä»¥åŠæŒ‡é’ˆæŒ‡å‘çš„è™šå‡½æ•°è¡¨ç»§æ‰¿ä¸‹æ¥ï¼Œå¦‚æœåœ¨å­ç±»ä¸­å¯¹çˆ¶ç±»ä¸­çš„è™šå‡½æ•°é‡å†™ä¸€éï¼Œå‡½æ•°è¡¨ä¸­çš„å†…å®¹å°±ä¼šè¢«å­ç±»è¦†ç›–ã€‚  *é‡å†™åªæœ‰å‡½æ•°ä½“å†…çš„è¯­å¥ä¸åŒï¼Œå…¶ä»–éƒ½ä¸€æ ·*ã€‚

### ç»§æ‰¿
1. åˆ¤æ–­ï¼šè™šåŸºç±»çš„æ„é€ å‡½æ•°åœ¨éè™šåŸºç±»ä¹‹å‰è°ƒç”¨
**ANSWER**ï¼šâŒ
#è™šåŸºç±» --->>  [[ä»€ä¹ˆæ˜¯è™šç»§æ‰¿ã€è™šåŸºç±»ï¼Ÿ]]

C++20 å¼•å…¥äº†æ–°çš„åˆå§‹åŒ–é¡ºåºè§„åˆ™, è§„å®šè™šåŸºç±»çš„æ„é€ å‡½æ•°æ€»æ˜¯å…ˆäºéè™šåŸºç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨ã€‚è¿™æ˜¯ä¸ºäº†è§£å†³å¤šç»§æ‰¿æ—¶åˆå§‹åŒ–é¡ºåºå¯èƒ½å¼•èµ·çš„ä¸€äº›é—®é¢˜ã€‚

å…·ä½“æ¥è¯´, C++20 ä¸­çš„æ„é€ å‡½æ•°è°ƒç”¨é¡ºåºå¦‚ä¸‹:
1. å¦‚æœç±» A ç»§æ‰¿è‡ªç±» B, ä¸” B æ˜¯è™šåŸºç±», åˆ™å…ˆè°ƒç”¨ B çš„æ„é€ å‡½æ•°
2. ç„¶åæŒ‰ç»§æ‰¿çš„é¡ºåºè°ƒç”¨æ¯ä¸ªéè™šåŸºç±»çš„æ„é€ å‡½æ•°
3. æœ€åè°ƒç”¨æœ€æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°

ä¸¾ä¸ªä¾‹å­:
```cpp
struct V {
  V() { std::cout << "V"; }
};

struct A : virtual V {
  A() { std::cout << "A"; }  
};

struct B : virtual V {
  B() { std::cout << "B"; }
};

struct C : A, B {
  C() { std::cout << "C"; }
};

int main() {
  C c; // è¾“å‡ºç»“æœ:VABCC
}
```

å¯ä»¥çœ‹åˆ°, è™šåŸºç±» V çš„æ„é€ å‡½æ•°å…ˆäº A å’Œ B è¢«è°ƒç”¨, è¿™åœ¨ C++20 ä¹‹å‰æ˜¯ä¸ç¡®å®šçš„, å–å†³äºç¼–è¯‘å™¨çš„å®ç°ã€‚

æ‰€ä»¥åœ¨ C++20 ä¸­,â€œè™šåŸºç±»çš„æ„é€ å‡½æ•°åœ¨éè™šåŸºç±»ä¹‹å‰è°ƒç”¨â€è¿™å¥è¯æ˜¯æ­£ç¡®çš„ã€‚è¿™è®©åˆå§‹åŒ–é¡ºåºæ›´åŠ æ˜ç¡®, æé«˜äº†ä»£ç çš„å¯ç†è§£æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

2. å¦ä¸€é“æœ‰å…³ç»§æ‰¿æ—¶è°ƒç”¨é¡ºåºçš„é¢˜ï¼Œåˆ¤æ–­è¾“å‡ºï¼š
```cpp
#include <iostream>
using namespace std;
 
class A{
  public:
    A ():m_iVal(0){test();}
    virtual void func() { std::cout<<m_iVal<<' ';}
    void test(){func();}
  public:
      int m_iVal;
};
class B : public A{
  public:
    B(){test();}
    virtual void func(){
      ++m_iVal;
      std::cout << m_iVal << ' ';
      }
};
int main(int argc ,char* argv[]){
  A*p = new B;
  p->test();
  return 0;
}
```

**ANSWER**ï¼š0 1 2

å‚è€ƒç­”æ¡ˆï¼šæœ¬é—®é¢˜æ¶‰åŠåˆ°ä¸¤ä¸ªæ–¹é¢ï¼š 1.C++ç»§æ‰¿ä½“ç³»ä¸­æ„é€ å‡½æ•°çš„è°ƒç”¨é¡ºåºã€‚ 2.æ„é€ å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°é—®é¢˜ã€‚ 

C++ç»§æ‰¿ä½“ç³»ä¸­ï¼Œåˆå§‹åŒ–æ—¶æ„é€ å‡½æ•°çš„è°ƒç”¨é¡ºåºå¦‚ä¸‹ï¼š
1. ä»»ä½•è™šæ‹ŸåŸºç±»çš„æ„é€ å‡½æ•°æŒ‰ç…§ä»–ä»¬è¢«ç»§æ‰¿çš„é¡ºåºæ„é€  
2. ä»»ä½•éè™šæ‹ŸåŸºç±»çš„æ„é€ å‡½æ•°æŒ‰ç…§ä»–ä»¬è¢«ç»§æ‰¿çš„é¡ºåºæ„é€ 
3. ä»»ä½•æˆå‘˜å¯¹è±¡çš„å‡½æ•°æŒ‰ç…§ä»–ä»¬å£°æ˜çš„é¡ºåºæ„é€  
4. ç±»è‡ªå·±çš„æ„é€ å‡½æ•° 

æ®æ­¤å¯çŸ¥Â `A* p =Â newB;` å…ˆè°ƒç”¨ A ç±»çš„æ„é€ å‡½æ•°å†è°ƒç”¨ B ç±»çš„æ„é€ å‡½æ•°ã€‚ æ„é€ å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°,è™šå‡½æ•°è¡¨ç°ä¸ºè¯¥ç±»ä¸­è™šå‡½æ•°çš„è¡Œä¸ºï¼Œå³åœ¨çˆ¶ç±»æ„é€ å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°ï¼Œè™šå‡½æ•°çš„è¡¨ç°å°±æ˜¯çˆ¶ç±»å®šä¹‰çš„å‡½æ•°çš„è¡¨ç°ã€‚whyï¼ŸåŸå› å¦‚ä¸‹ï¼š å‡è®¾æ„é€ å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°ï¼Œè¡¨ç°ä¸ºæ™®é€šçš„è™šå‡½æ•°è°ƒç”¨è¡Œä¸ºï¼Œå³è™šå‡½æ•°ä¼šè¡¨ç°ä¸ºç›¸åº”çš„å­ç±»å‡½æ•°è¡Œä¸ºï¼Œå¹¶ä¸”å‡è®¾å­ç±»å­˜åœ¨ä¸€ä¸ªæˆå‘˜å˜é‡ int aï¼›å­ç±»å®šä¹‰çš„è™šå‡½æ•°çš„æ–°çš„è¡Œä¸ºä¼šæ“ä½œ a å˜é‡ï¼Œåœ¨å­ç±»åˆå§‹åŒ–æ—¶æ ¹æ®æ„é€ å‡½æ•°è°ƒç”¨é¡ºåºä¼šé¦–å…ˆè°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆè™šå‡½æ•°å›å»æ“ä½œ aï¼Œè€Œå› ä¸º a æ˜¯å­ç±»æˆå‘˜å˜é‡ï¼Œè¿™æ—¶ a å°šæœªåˆå§‹åŒ–ï¼Œè¿™æ˜¯ä¸€ç§å±é™©çš„è¡Œä¸ºï¼Œä½œä¸ºä¸€ç§æ˜æ™ºçš„é€‰æ‹©åº”è¯¥ç¦æ­¢è¿™ç§è¡Œä¸ºã€‚æ‰€ä»¥è™šå‡½æ•°ä¼šè¢«è§£é‡Šåˆ°åŸºç±»è€Œä¸æ˜¯å­ç±»ã€‚ æ®æ­¤å¯ä»¥å¾—åˆ°ç­”æ¡ˆ 0 1 2

## å®
### å¼ºåˆ¶åˆ†éš”ç¬¦
1. æœ‰å¦‚ä¸‹å®å®šä¹‰ï¼Œåˆ™å°†å…¶æ›¿æ¢ `DECLARE (val, int)` çš„ç»“æœæ˜¯ï¼Ÿ
```cpp
#define DECLARE(name, type) type name##_##type##_type
```

##æ˜¯ä¸€ç§åˆ†éš”è¿æ¥æ–¹å¼ï¼Œå®ƒçš„ä½œç”¨æ˜¯**å…ˆåˆ†éš”ï¼Œç„¶åè¿›è¡Œå¼ºåˆ¶è¿æ¥**ã€‚
â€œ`name`â€å’Œç¬¬ä¸€ä¸ªâ€œ` _ `â€ä¹‹é—´è¢«åˆ†éš”äº†ï¼Œæ‰€ä»¥é¢„å¤„ç†å™¨ä¼šæŠŠ ` name##_##type##_type ` è§£é‡Šæˆ4æ®µï¼šâ€œ` name `â€ã€â€œ` _ `â€ã€â€œ` type `â€ä»¥åŠâ€œ` _type `â€ï¼Œname å’Œ type ä¼šè¢«æ›¿æ¢ï¼Œè€Œ_type ä¸ä¼šè¢«æ›¿æ¢

## æ¨¡æ¿
### å£°æ˜å’Œå®šä¹‰
1. åœ¨ C++é‡Œï¼ŒåŒä¸€ä¸ªæ¨¡æ¿çš„å£°æ˜å’Œå®šä¹‰æ˜¯ä¸èƒ½åœ¨ä¸åŒæ–‡ä»¶ä¸­åˆ†åˆ«æ”¾ç½®çš„ï¼Œå¦åˆ™ä¼šæŠ¥ç¼–è¯‘é”™è¯¯ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹åŠæ³•æœ‰ï¼ˆï¼‰
A. æ¨¡æ¿çš„å£°æ˜å’Œå®šä¹‰éƒ½æ”¾åœ¨ä¸€ä¸ª.h æ–‡ä»¶ä¸­ã€‚
B. æ¨¡æ¿çš„å£°æ˜å’Œå®šä¹‰å¯ä»¥åˆ†åˆ«æ”¾åœ¨.h å’Œ.cpp æ–‡ä»¶ä¸­ï¼Œåœ¨ä½¿ç”¨çš„åœ°æ–¹ï¼Œå¼•ç”¨å®šä¹‰è¯¥æ¨¡æ¿çš„ cpp æ–‡ä»¶ã€‚
C. ä½¿ç”¨ export ä½¿æ¨¡æ¿çš„å£°æ˜å®ç°åˆ†ç¦»ã€‚
D. ä»¥ä¸Šè¯´æ³•éƒ½ä¸å¯¹

>[!note] å„é€‰é¡¹è§£é‡Š
>A. 
>B. æ¨¡æ¿çš„å£°æ˜å’Œå®šä¹‰ä¸èƒ½åˆ†åˆ«å•ç‹¬çš„æ”¾åœ¨. h å’Œ. cpp æ–‡ä»¶ä¸­çš„åŸå› æ˜¯**å½“å®ä¾‹åŒ–ä¸€ä¸ªæ¨¡æ¿æ—¶ï¼Œç¼–è¯‘å™¨å¿…é¡»çœ‹åˆ°æ¨¡æ¿ç¡®åˆ‡çš„å®šä¹‰ï¼Œè€Œä¸ä»…ä»…æ˜¯å®ƒçš„å£°æ˜**ã€‚è‹¥åœ¨ main ()å‡½æ•°ä¸­åŒ…å«. h æ–‡ä»¶ï¼Œåˆ™ç¼–è¯‘å™¨æ— æ³•çŸ¥é“æ¨¡æ¿çš„ç¡®åˆ‡å®šä¹‰ï¼Œ**æ‰€ä»¥è¦åœ¨ main ()ä¸­åŒ…å«. cpp æ–‡ä»¶ï¼Œ. cpp æ–‡ä»¶ä¸­åˆä¼šåŒ…å«. h æ–‡ä»¶ï¼Œè¿™æ ·ä¸€æ¥é€šè¿‡åœ¨ main å‡½æ•°ä¸­åŒ…å«. cpp æ–‡ä»¶å°±ä¼šå°†ç±»çš„å®šä¹‰å’Œå£°æ˜éƒ½åŒ…å«è¿›æ¥ï¼Œç¼–è¯‘å™¨è‡ªç„¶èƒ½æ‰¾åˆ°æ¨¡æ¿çš„ç¡®åˆ‡å®šä¹‰ã€‚**ï¼ˆåœ¨ main å‡½æ•°ä¸­å¼•ç”¨ï¼‰
>
>ã€ŠC++ Templateã€‹ç¬¬å…­ç« è®²è¿‡è¿™ä¸ªé—®é¢˜  
> ç»„ç»‡æ¨¡æ¿ä»£ç æœ‰ä¸‰ç§æ–¹å¼  
> 1. åŒ…å«æ¨¡å‹ï¼ˆå¸¸è§„å†™æ³• å°†å®ç°å†™åœ¨å¤´æ–‡ä»¶ä¸­ï¼‰  
> 2. æ˜¾å¼å®ä¾‹åŒ–ï¼ˆå®ç°å†™åœ¨ cpp æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨ template class è¯­æ³•è¿›è¡Œæ˜¾å¼å®ä¾‹åŒ–ï¼‰  
> 3. åˆ†ç¦»æ¨¡å‹ï¼ˆä½¿ç”¨ C++ export å…³é”®å­—å£°æ˜å¯¼å‡ºï¼‰
> 
> ç¬¬ä¸‰ç§æ–¹å¼ç†è®ºæœ€ä¼˜ï¼Œä½†æ˜¯å®é™…ä»C++æ ‡å‡†æå‡ºä¹‹åä¸»æµç¼–è¯‘å™¨æ²¡æœ‰æ”¯æŒè¿‡ï¼Œå¹¶ä¸”åœ¨æœ€æ–°çš„C++11æ ‡å‡†ä¸­å·²ç»åºŸé™¤æ­¤ç‰¹æ€§ï¼Œexportå…³é”®å­—ä¿ç•™å¾…ç”¨ã€‚é‚£ä¹ˆå®é™…ä¸Šèƒ½å¤Ÿä½¿ç”¨çš„å®ç°åˆ†ç¦»ä¹Ÿå°±åªæœ‰æ˜¾å¼å®ä¾‹åŒ–


## æ•°æ®ç»“æ„

### å †ã€æ ˆ
1. Cpp ä¸­å…³äºå †æ ˆè¯´æ³•çš„æ­£è¯¯åˆ¤æ–­ï¼š

A. å †çš„å¤§å°ä»…å—æ“ä½œç³»ç»Ÿçš„é™åˆ¶ï¼Œæ ˆçš„å¤§å°ä¸€èˆ¬ä¸€èˆ¬è¾ƒå°  âœ…
B. åœ¨å †ä¸Šé¢‘ç¹çš„è°ƒç”¨ new/delete å®¹æ˜“äº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œæ ˆæ²¡æœ‰è¿™ä¸ªé—®é¢˜ âœ…
C. å †å’Œæ ˆéƒ½å¯ä»¥é™æ€åˆ†é… âŒ
D. å †å’Œæ ˆéƒ½å¯ä»¥åŠ¨æ€åˆ†é… âœ…

>[! note] å †æ ˆçš„å†…å­˜åˆ†é…
>é€‰ Cï¼Œé™æ€åˆ†é…æ˜¯æŒ‡åœ¨ç¼–è¯‘é˜¶æ®µå°±èƒ½ç¡®å®šå¤§å°ï¼Œç”±ç¼–è¯‘å™¨è¿›è¡Œåˆ†é…ï¼Œå †ä¸å¯ä»¥è¿›è¡Œé™æ€åˆ†é…ï¼Œå †çš„ç”³è¯·éƒ½æ˜¯åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­è¿›è¡Œçš„ã€‚ 
>
>Aï¼Œå †å’Œæ ˆçš„å¤§å°éƒ½å¯ä»¥è®¾ç½®ï¼Œæ ˆä¸€èˆ¬åªæœ‰å‡  KBã€‚å †çš„å¤§å°é€šå¸¸å—é™äºè®¡ç®—æœºçš„å¯ç”¨ç‰©ç†å†…å­˜ï¼ˆRAMï¼‰å’Œæ“ä½œç³»ç»Ÿçš„è®¾ç½®ã€‚
>- å½“ç¨‹åºè¯·æ±‚ä»å †ä¸­åˆ†é…å†…å­˜ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡åŠ¨æ€å†…å­˜åˆ†é…å‡½æ•°å¦‚ C++ ä¸­çš„ `malloc` æˆ– `new`ï¼‰ï¼Œæ“ä½œç³»ç»Ÿä¼šä»å¯ç”¨çš„ RAM ä¸­åˆ†é…å†…å­˜ã€‚å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—²å†…å­˜ï¼Œå †åˆ†é…å¯èƒ½å¤±è´¥ã€‚
>- æ ˆæ˜¯ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡ã€å‡½æ•°è°ƒç”¨ä¿¡æ¯å’Œå…¶ä»–æ‰§è¡Œç›¸å…³æ•°æ®çš„å†…å­˜åŒºåŸŸã€‚ç¨‹åºä¸­çš„æ¯ä¸ªçº¿ç¨‹é€šå¸¸æœ‰è‡ªå·±çš„æ ˆã€‚æ ˆçš„å¤§å°é€šå¸¸æ˜¯å›ºå®šçš„ï¼Œå¹¶ç”±æ“ä½œç³»ç»Ÿæˆ–ç¼–è¯‘å™¨å®šä¹‰ï¼Œé€šå¸¸æ¯”å †å°ã€‚ç”±äºæ ˆç”¨äºè·Ÿè¸ªå‡½æ•°è°ƒç”¨å’Œå±€éƒ¨å˜é‡ï¼Œå…¶å¤§å°å¿…é¡»å—é™ï¼Œä»¥é˜²æ­¢è¿‡å¤šçš„å†…å­˜æ¶ˆè€—å’Œæ ˆæº¢å‡ºé—®é¢˜ã€‚å½“è°ƒç”¨å‡½æ•°æ—¶ï¼Œå…¶å±€éƒ¨å˜é‡å’Œä¸€äº›ç®¡ç†ä¿¡æ¯è¢«åˆ†é…åˆ°æ ˆä¸Šã€‚å¦‚æœè¶…è¿‡äº†æ ˆçš„å¤§å°ï¼Œå°†å¯¼è‡´æ ˆæº¢å‡ºï¼Œå¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒã€‚
>
>Bï¼Œå †åœ¨åŠ¨æ€åˆ†é…æ—¶ï¼Œè¦ç”³è¯·è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œé‡Šæ”¾åä¼šäº§ç”Ÿç¢ç‰‡ã€‚ 
>
>Dï¼Œå †æ˜¯ä½¿ç”¨ malloc ()ã€calloc ()ã€realloc ()ç­‰å‡½æ•°åŠ¨æ€åˆ†é…çš„ï¼Œè€Œä½¿ç”¨ alloca ()å‡½æ•°å¯ä»¥åŠ¨æ€åˆ†é…æ ˆçš„å†…å­˜ç©ºé—´ï¼Œé‡Šæ”¾çš„æ—¶å€™ç”±ç¼–è¯‘å™¨è‡ªå·±é‡Šæ”¾ã€‚

### é“¾è¡¨
1. å¦‚ä½•åœ¨ä¸‹åˆ—é“¾è¡¨ä¸­å–å¾—å€¼ä¸º 7 çš„è¡¨è¾¾å¼ï¼Ÿ
```cpp
struct st
{
    int n;
    struct st *next;
} a[3]= {5, &a[1], 7, &a [2], 9, NULL}ï¼Œ*p=a;
```

A. p->n        âŒ
B. (p->n)++    âŒ
C. (++p)->n    âœ… (å¯ä»¥ä½†ä¸å»ºè®®)
D. p->next->n  âœ…

*é¦–å…ˆï¼Œè®©æˆ‘ä»¬è§£é‡Šä¸€ä¸‹æ•°ç»„ a çš„åˆå§‹åŒ–ï¼š*

```cpp
struct st a[3] = {5, &a[1], 7, &a[2], 9, NULL};

// ç­‰ä»·äº

struct st a[3]= {{5,&a[1]},{7,&a[2]},{9,NULL}}
```

*è¿™æ˜¯ä¸€ä¸ªåŒ…å« 3 ä¸ªå…ƒç´ çš„ struct st ç±»å‹æ•°ç»„ aã€‚æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªç»“æ„ä½“å¯¹è±¡ï¼Œç»“æ„ä½“ st çš„å®šä¹‰å¦‚ä¸‹ï¼š*

```c
struct st {
    int n;
    struct st *next;
};
```

*ç°åœ¨æˆ‘ä»¬è§£é‡Šä¸€ä¸‹æ•°ç»„ a çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼š* 

1. ç¬¬ä¸€ä¸ªå…ƒç´ ï¼š`5, &a[1]`
   - `n` æˆå‘˜è¢«åˆå§‹åŒ–ä¸º 5ã€‚
   - `next` æˆå‘˜è¢«åˆå§‹åŒ–ä¸º `&a[1]`ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ ã€‚
2. ç¬¬äºŒä¸ªå…ƒç´ ï¼š`7, &a[2]`
   - `n` æˆå‘˜è¢«åˆå§‹åŒ–ä¸º 7ã€‚
   - `next` æˆå‘˜è¢«åˆå§‹åŒ–ä¸º `&a[2]`ï¼Œä¹Ÿå°±æ˜¯æŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸‰ä¸ªå…ƒç´ ã€‚
3. ç¬¬ä¸‰ä¸ªå…ƒç´ ï¼š`9, NULL`
   - `n` æˆå‘˜è¢«åˆå§‹åŒ–ä¸º 9ã€‚
   - `next` æˆå‘˜è¢«åˆå§‹åŒ–ä¸º NULLï¼Œè¡¨ç¤ºé“¾è¡¨çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ã€‚

*ç°åœ¨è®©æˆ‘ä»¬å›åˆ°ä½ çš„é—®é¢˜ï¼šå¦‚ä½•ä½¿ç”¨æŒ‡é’ˆ p è·å¾—å€¼ä¸º7ï¼Ÿ*

åœ¨åˆå§‹åŒ–æ•°ç»„åï¼ŒæŒ‡é’ˆ `p` è¢«èµ‹å€¼ä¸º `&a[0]`ï¼Œå³æŒ‡å‘æ•°ç»„ a çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚
ä¸ºäº†è·å¾—å€¼ä¸º 7ï¼Œæˆ‘ä»¬éœ€è¦æ²¿ç€é“¾è¡¨æ‰¾åˆ°æŒ‡å‘å€¼ä¸º 7 çš„èŠ‚ç‚¹ã€‚é“¾è¡¨çš„éå†å¯ä»¥é€šè¿‡ä½¿ç”¨æŒ‡é’ˆçš„ `p->next` æ¥å®ç°ã€‚

```c
struct st *p = a; // æŒ‡é’ˆpæŒ‡å‘æ•°ç»„açš„ç¬¬ä¸€ä¸ªå…ƒç´ 

// éå†é“¾è¡¨ç›´åˆ°æ‰¾åˆ°å€¼ä¸º7çš„èŠ‚ç‚¹
while (p != NULL) {
    if (p->n == 7) {
        // æ‰¾åˆ°å€¼ä¸º7çš„èŠ‚ç‚¹ï¼ŒpæŒ‡å‘è¯¥èŠ‚ç‚¹
        break;
    }
    p = p->next; // ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
}

if (p != NULL) {
    // pæŒ‡å‘å€¼ä¸º7çš„èŠ‚ç‚¹ï¼Œå¯ä»¥è®¿é—®å€¼ä¸º7çš„æˆå‘˜
    printf("Found the node with value 7: %d\n", p->n);
} else {
    printf("Node with value 7 not found.\n");
}
```

*ä¸ºä»€ä¹ˆä¸å»ºè®®ä½¿ç”¨ `(++p)->n `?*

åœ¨ Cpp 14ã€Clang++ç¯å¢ƒä¸‹ï¼Œæµ‹è¯•ç»“æœä¹Ÿæ˜¯å¯ä»¥è®¿é—®åˆ°å€¼ 7 çš„ï¼Œä½†è¿™å¹¶ä¸æ˜¯å› ä¸º Cpp å·²ç»æ™ºèƒ½åˆ°å¯ä»¥è‡ªåŠ¨æ¨æ–­é“¾è¡¨çš„æŒ‡é’ˆï¼Œè€Œæ˜¯å› ä¸ºè¿™ä¸ªç»“æ„ä½“å˜é‡ a æ˜¯ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„åœ°å€è‡ªç„¶æ˜¯çº¿æ€§é€’å¢çš„ï¼š
```cpp
# include "iostream"

using namespace std;
struct st {
    int n;
    struct st *next;
} a[3] = {5, &a[1], 7, &a[2], 9, NULL}, *p = a;

int main(){
    st * node1 = new st;
    st * node2 = new st;
    st * node3 = new st;

    node1->n=5;
    node1->next=node2;
    node2->n=7;
    node2->next=node3;
    node3->n=9;
    node3->next= nullptr;

    st * p1 = node1;

    cout<<(++p)->n<<endl;
//    cout<<(++p1)->n<<endl;
//    cout<<p->next->n<<endl;
    cout<<p1->next->n<<endl;
}
```
