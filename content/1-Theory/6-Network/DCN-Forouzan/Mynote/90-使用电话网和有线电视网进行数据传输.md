## 使用电话网和有线电视网进行数据传输

### 电话网络

- 背景：电话网络使用电路交换技术。19世纪末电话网络起源，当时是简易普通传统电话系统POTS(plain old telephone system)，使用模拟信号传输语音的模拟系统。目前电话网络是一种数字和模拟共存的网络

- 主要组成：
	
	- 本地回路local loop：将用户电话机连接到最近本地局或本地中心局的双绞线。用于语音传送时，本地回路的带宽是4kHz
		
	- 干线trunk：处理局间通信的传输介质。一条干线通过多路复用通常可以处理成百上千个连接。传输时通过光纤和卫星链路实现的
		
	- 交换局switching office：
		
		- 为了避免在任何两个用户之间存在一条永久的物理链路，电话公司在交换局内安装交换机
			
		- 一台交换机可以连接多条本地回路或者干线，并且允许不同用户间建立连接



- LATA(local access and transport area)本地接入和传送区域：
	
	- LATA内部服务：LATA内部的公用电信公司common carrier提供的服务
		
		- 处理这些服务的运营商称为本地交换电信公司LEC(local exchange carrier)。1996电信法实施之前，内部服务授权给一个单独的运营商垄断式经营
			
		- 1996年之后，有两种类型的LEC：
			
			- 之前提供服务的运营商占有电缆铺设系统（本地回路），称为责任本地交换电信公司ILEC(incumbent local exchange carrier)
				
			- 提供服务的新运营商称为竞争本地交换电信公司CLEC(competitive local exchange carrier)
				
			
		- 为了避免增加新的电缆铺设费用，一致同意由ILEC继续提供主要服务，而CLEC提供LATA内部的其他服务，如移动电话、收费长途电话等
			
		- LATA内部通信由本地局和中继局处理。只使用一个交换局就能完成的呼叫是免费的，必须通过至少一个中继局的呼叫是收费的
			
		
	- LATA间的服务：由跨区交换电信公司IXC(interexchange carrier)处理，这些公司有时称为长途电话公司long-distance company，为不同LATA的两个客户之间提供通信服务
		
		- IXC是长途电话公司，它们提供包括电话服务在内的通用数据通信服务。通过IXC的电话呼叫通常被数字化处理，电信公司使用多种类型的网络提供这一服务
			
		
	- 服务接入点POP(Points of Presence)：提供电信公司之间的交互
		
		- 所有希望在LATA中提供LATA间服务的IXC，都必须在该LATA内有一个POP
			
		- 在LATA内部提供服务的LEC，必须提供连接以使每个用户都能访问到所有的POP
			
		- 图9.3典例
			
			- 当一个用户需要与另一个用户连接时，首先被连接到本地交换机
				
			- 然后直接连接到一个POP或者通过一台中继交换机连接到POP，这时呼叫从源LATA中的IXC的POP到达目的LATA中的同一IXC的POP
				
			- 呼叫将会通过IXC的长途电话局，并且经过IXC提供的网络进行传送



- 信令
	
	- 带内信令与带外信令：
		
		- 带内信令in-band signaling：信令和通话是同一电路。电路交换网在通信双方之间为了确定与终止路径必须有建立和拆除阶段，回忆早期接线员辅助完成的电话通信
			
		- 后来信令系统成为自动系统，如旋转拨号电话发送数字信号表示多位数字电话机上的每个数字。电话公司的交换机用该数字信号建立呼叫方与被呼叫方之间的连接，同时使用带内信令和带外信令out-of-signaling
			
		- 带内信令中，4-kHz语音通道也用于提供信令；带外信令中，部分语音通道用作信令，语音通道的带宽与信令通道的带宽是分离的
			
		
	- 信令系统随着电话网络发展时增加的功能需求：
		
		- 提供拨号音、振铃和忙音
			
		- 办公室电话号码转移
			
		- 维护和监控呼叫
			
		- 保留账单信息
			
		- 维护和监控电话网络设备
			
		- 提供其他功能，如呼叫方ID和语音信箱等
			
		
	- 复杂的任务需求使得信令成为单独的网络。即目前电话网络可以认为是信令网络和数据传输网络的结合，数据传输和信令任务在现代电话网中是分开的，一个网络用来执行数据传输，另一个用来执行信令任务
		
		- 数据传输网络：目前可携带多媒体信息的数据传输网络最重要部分是电路交换网，也可能是分组交换网。这种网络和其他本书讨论的网络一样遵照同一模型和协议
			
		- 信令网络：信令的特性更适合具有不同层次的分组交换网
			
			- 需要传送电话地址的信息封装在一个具有所有差错控制和寻址信息的分组中。典例图9.4表示了数据传输网络和信令网络的关系：
				
				- 用户电话或计算机被连接到信号点SP(signal point)，电话机与信号点之间链路是两个网络公用的
					
				- 信令网络利用信号传输端口STP(signal transfer port)接收或转发信令报文
					
				- 信令网络包括服务控制点SCP(service control point)控制所有的网络操作，其他系统如数据库中心可包括有关整个信令网络提供的存储信息
					
				
			- 7号信令系统SS7(Signaling System Seven)：信令系统所用协议
				
				- 物理层：MTP1报文传输部分层次1(message transfer part level 1)，使用物理层规范，如T-1线和DC0
					
				- 数据链路层：MTP2报文传输部分层次2，提供典型的数据链路层服务，如用分组头部的源和目的地址以及差错检测的CRC打包
					
				- 网络层：MTP3报文传输部分层次3，提供端到端连接，使用数据报方法进行交换
					
				- 传输层：SCCP信令连接控制点(signaling connection control point)，用于特殊业务，如800呼叫处理
					
				- 高层：有三个协议：
					
					- 电话用户端口协议TUP(telephone user port)，负责建立语音呼叫，它接收拨号数字和按指定路线传送呼叫
						
					- 事务处理能力应用端口协议TCAP(Transaction capabilities application port)，提供远程呼叫，让一台计算机上的应用程序调用另一台计算机的过程
						
					- ISDN用户端口协议ISUP(ISDN user port)，代替TUP提供类似ISDN网络的服务


- 电话网络提供的业务
	
	- 模拟业务analog service：
		
		- 模拟交换业务analog switched service：常见的拨号呼叫业务
			
			- 本地回路中的信号是模拟信号，带宽通常是0~4kHz
				
			- 有包月制收费，或按次计费
				
			- 800业务：一个用户（通常为组织机构）需要为其他用户（客户）提供免费连接，此时呼叫方是免费的，被呼叫方付费，组织机构使用这种服务鼓励客户拨打电话。费用比正常长途电话便宜一些
				
			- 广域电话业务WATS(wide-area telephone service)：与800业务相反。800业务是由组织机构付费的入站呼叫，WATS是由组织机构付费的出站呼叫。价格较低，可代替常规长途电话，费用依据呼叫次数确定。可以指定为出站呼叫到同一个州、到多个州、或者到整个国家并收取相应费用
				
			- 900业务：与800一样是入站呼叫，但其是由呼叫方付费且贵于常规长途电话，因为运营商收取两种费用：长途电话费和付给被呼叫方的费用
				
			
		- 模拟租用业务analog leased service：为客户提供一条租用线路的机会，永久性地连接到另一个客户。尽管仍然通过了电话网络中的交换机，但交换机总是闭合的，不需要拨号
			
		
	- 数字业务digital service：对噪声和其他形式的干扰的敏感度低于模拟业务
		
		- 交换式/56业务：模拟交换线路的数字版本，是一种交换式数字业务，允许数据速率最高到56kbps
			
			- 为了通过这一业务进行通信，通信双方必须先预订这种业务。使用正常电话业务的呼叫方不能使用该业务连接到一部电话或者计算机
				
			- 由于该业务中使用的线路是数字化的，所以用户不需要调制解调器来传输数字数据。但仍需要数字业务单元DSU(digital service unit)的设备
				
			
		- 数字数据业务DDS(digital data service)：模拟租用线路的数字版本，是一条最高数据速率为64kbps的数字租用线路



### 电话调制解调器

- 背景：
	
	- 传统电话线路可以传送频率范围是300~3300Hz的信号，提供给信号的带宽是3000Hz。整个频率范围对于传输语音，在不丢失可识别性的情况下，有一些干扰和失真可以接受。但数据信号需要更高等级的准确度以确保完整性，所以处于安全性考虑，频率范围的边缘不能用与数据通信，即信号带宽小于电缆带宽
		
	- 尽管目前一些电话线路能够处理比传统线路更高的带宽，但调制解调器的设计仍然是基于传统线路容量的
		
	- 调制解调器modem，源于信号调制器modulator（从二进制数据生成带通模拟信号）和信号解调器demodulator（将调制信号中恢复为二进制数据）。典例图9.7及上方解释


- 调制解调器标准：基于ITU-T发布的V系列标准
	
	- V.32和V.32bis：
		
		- V.32调制解调器结合使用调制和编码技术，称为格码调制trellis-coded modulation
			
			- 格式结构本质上是QAM加上一位冗余位。数据流划分为多个4位部分，传输的是五位组pentable而不是四位组quadbit，额外的位值从数据位值中计算得到，用于差错检测
				
			- 需要波特率为2400的32-QAM。每个五位组只有4位表示数据，最终速度为4×2400=9600bps
				
			
		- V.32bis调制解调器是第一个支持14400bps传输的ITU-T标准
			
			- 使用的是2400boud（2400×6=14400）的128-QAM传输（7位/波特，1位用于差错控制）
				
			- 提供的附加增强功能包含了传输速度自动降低和提高等特性，使得调制解调器能够依据线路或者信号的质量调高或者调低速度



	- V.34 bis：此调制解调器为28800的比特率提供了960点的星座图，为33600bps的比特率提供了1664的星座图
		
	- V.90：比特率为56000bps的V90调制解调器（称为56K调制解调器），只有一方使用数字信号（如通过因特网提供商）时才可用
		
		- 下载速率（数据流从因特网提供商到PC）最大是56kbps，上载速率（数据流从PC到因特网提供商）最大是33.6kbps，二者不对称。传统调制解调器的最大速率为33.6kbps，如香农公式确定，但56K modem没有违反香农容量定理，在下行方向没有量化误差，SNR率较高
			
		- 上传uploading中，模拟信号仍然在交换站进行采样。这个方向上，量化噪声引入信号降低了SNR，将上载的数据速率限制在33.6kbps
			
		- 下载downloading中，没有采样，信号不受量化噪声影响，不受香农容量定理限制，56kbps=每秒采样8000次×每个采样使用8位其中1位用于控制目的
			
		
	- V.92：此调制解调器能够自己调整速度。如果噪声允许，上传数据速率可以是48kbps，下载数据速率仍是56kbps
		
		- 有一些附加特性，如，若线路有呼叫等待服务，在有电话拨入时，调制解调器可以中断因特网连接




### - 数字用户线路

- 背景：传统调制解调器达到最高数据速率，数字用户线路DSL(digital subscriber line)技术产生并提供对因特网的告诉访问。目前DSL技术是现有本地回路上支持高速数字通信的最有前途技术之一

- ADSL(asymmertrical DSL)：非对称数字用户线路，其下行速率（比特率）高于上行速率。与56K modem的非对称性不同的是，ADSL专门针对住宅客户设计，将本地回路的可用带宽进行了不均衡的划分，不适合用于在两个传输方向都需要较高带宽的商业客户
	
	- 使用现有本地回路：双绞线本地回路能够处理的带宽实际上达到了1.1MHz，但是电话公司安装在本地交换局的滤波器将带宽限制到4kHz，这样可以允许对大量语音通道进行多路复用
		
	- 自适应技术：在设定某种数据速率之前，会运用该技术测试线路的状况和可用带宽。ADSL的数据速率不是固定的，它根据本地回路电缆的状况和类型而有所变化
		
	- 离散多音频技术DMT(discrete multitone technique)：ADSL的标准调制技术，将QAM和FDM结合在一起
		
		- 系统带宽的划分没有固定的方法，每个通道使用的带宽是4.312kHz。一般情况下，将1.104MHz的可用带宽划分为256个通道，每个通道使用的带宽是4.312kHz。典例图9.10：
			
			- 语音 保留通道0用于语音通信
				
			- 空闲 通道1~5不使用，作为语音和数据通信之间的间隙
				
			- 上行数据与控制 通道6~30用于上行数据传输和控制。1条控制24条数据传输，对于24个通道每个使用4kHz带宽用QAM调制，那么上行方向有24×4000×15=1.44Mbps的传输速率。但由于某些载波在噪声大处被删除，数据速率通常在500kbps以下，即有些通道不可用
				
			- 下行数据与控制 通道31~255用于下行数据传输和控制，1条控制其他数据传输，224条通道可获得224×4000×15=13.4Mbps的传输速率。由于某些载波在噪声大处被删除，数据速率通常在8Mbps以下
			
			
		
	- 客户端：ADSL调制解调器。图9.12
		
		- 本地回路连接到分离语音（低通滤波器）和数据通信（高通滤波器）的滤波器上。ADSL调制解调器使用DMT调制数据并创建上行和下行通道
			
		- 一般分配器由电信公司技术员安装在客户端，语音线可用在房间中已有的电话线，但数据线需要专业人员安装。使得ADSL成本高昂
			
		
	- 电话公司端：DSLAM(digital subscriber line access multiplexer)
		
		- 此端有数字用户线路接入复用器DSLAM(digital subscriber line access multiplexer)来取代ADSL调制解调器。它的功能与ADSL modem相似，还负责将发送到因特网（ISP服务器）的数据进行分组
			
		- 图9.13，逆向的客户端结构



- ADSL Lite：为了应对建筑物边界处安装分配器和新数据线高昂成本的新技术
	
	- 允许ADSL Lite modem直接插入电话机插座而连接计算机。分配工作由电话公司完成，ADSL-Lite使用8位（代替15位）调制256DMT的载波
		
	- 由于语音信号产生的错误可能与他们混合，所以有些载波可能不适用
		
	- 它提供最大下行数据速率为1.5Mbps、上行数据速率为512kbps


- HDSL(high-bit-rate digital subscriber line)高速数字用户线路：为了替代T-1线路（1.544Mbps）而设计
	
	- T-1线路使用AMI编码，由于AMI在高频频段对衰减非常敏感，所以T-1线路的长度限制为1km。如果要传输更长距离，就必须有中继器，意味着成本增加
		
	- HDSL使用2B1Q编码，对衰减的敏感程度很低。不使用中继器传输距离可达3.6km，数据速率可达2Mbps
		
	- HDSL使用双绞线实现全双工传输


- SDSL(symmertric digital subscriber line)对称数字用户线路：HDSL的一种双绞线型，提供全双工对称通信，对每个方向支持速率达768kbps
	
	- ADSL提供非对称通信，下行比特率远高于上行比特率。尽管这种特性满足大多住宅用户需求，但不适用于双向都需要大容量收发数据的商业应用
		
	- SDSL对称通信可以取代ADSL


- VDSL(very-high-bit-rate digital subscriber line)甚高速数字用户线路：与ADSL相似的替代实现技术，适于短距离（300~1800m）通信
	
	- 使用同轴电缆、光纤、双绞线，采用DMT调制
		
	- 对上行通信在距离3000英尺到10000英尺提供比特率的范围是25Mbps到55Mbps，下行比特率通常是3.2Mbps



### 有线电视网cable TV network

- 传统有线网络
	
	- 原来称公共天线电视CATV(community antenna TV)，是位于高山顶或者建筑物顶端的天线从电视台接收信号，通过同轴电缆将这些信号分配给社区公用。
		
	- 图9.14是传统有线电视网络示意图：
		
		- 有线电视局称为前端head end，从广播电台接收视频信号并将信号馈送给同轴电缆。由于信号会逐渐衰弱，所以网络的通路上安装放大器对信号进行放大，多达35个放大器
			
		- 另一端，分配器分离电缆信号，通过分接头和分接电缆与用户住宅建立连接
			
		- 传统有线电视系统使用同轴电缆进行端到端的连接，且通信是单向的，视频下行传输，由前端到用户住宅



- 光纤同轴电缆混合HFC网络
	
	- HFC(hybrid fiber-coaxial)光纤同轴电缆混合，从有线电视局到光纤节点（分线盒）之间的传输介质是光纤；从光纤节点穿过相邻住户并到达房屋内部的线路仍然使用同轴电缆
		
	- 地区有线前端RCH(regional cable head)通常可为400000个用户服务，RCH将信号馈送到分配集线器distribution hub，每一台集线器可以为40000个用户服务。分配集线器负责信号的调制和分配
		
	- 经过处理的信号再通过光纤馈送到光纤节点。光纤节点将模拟信号进行分配，将相同的信号发送到每一条同轴电缆
		
	- 每一条同轴电缆为1000个用户服务，光纤的使用可以将放大器的数量减少到8个或更少
		
	- HFC有线电视网络中的通信可以是双向的


### 有线电视网络用作数据传输

- 带宽：HFC系统中网络的最后一部分即光纤节点到用户住宅之间为同轴电缆，其带宽位于5~750MHz。电缆公司将其划分为三个波段：视频、下行数据和上行数据
	
	- 三个波段
		
		- 下行视频波段downstream video band：占用的频率范围是54~550MHz。由于每个电视频道占用6MHz，因此可以满足80多个频道的需要
			
		- 下行数据波段downstream data band：频率范围是550~750MHz，也是按6MHz划分通道
			
			- 调制：使用64-QAM或256-QAM调制技术进行调制
				
			- 数据速率：64-QAM调制技术中，每一个波特使用 6位，每个波特1位用于前向纠错，5位用于数据，而标准规定每个波特为1Hz。因此理论上，下行数据能以30Mbps（5bit/Hz×6MHz）的速率接收。该标准仅指定27Mbps，而由于有线调制解调器是通过10Base-T电缆连接到计算机上的，因此数据速率限制为10Mbps
				
			
		- 上行数据波段upstream data band：占用低端波段，频率范围是5~42MHz，也是按照6MHz划分通道
			
			- 调制：使用较低的频率，对噪声和干扰更为敏感，故QAM不适合，而使用QPSK调制技术进行调制
				
			- 数据速率：QPSK中，每波特使用2位，每波特1Hz，即理论上下行数据能以12Mbps(2bit/Hz×6MHz)的速率发送，但通常小于12Mbps


- 共享
	
	上行和下行波段可以由用户共享
	
	- 上行波段共享：分时共享，以解决大量用户在仅37MHz的上行数据带宽且6条6MHz的通道上发送数据
		
		- 这一波段使用FDM划分为多条通道，这些通道必须在具有相邻关系的用户间共享
			
		- 有线提供商以静态或者动态方式，将一条通道分配给一组用户。如果某个用户要发送数据，他需要与要访问这一通道的其他用户竞争，即用户必须等待直到通道可用
			
		
	- 下行波段共享：与上行方向类似，33个6MHz下行波段通道，但用户数不止33个，所以每条通道必须在一组用户间共享
		
		- 但是这里存在多播的情况。只要存在用户组中任何一个用户的数据，这些数据就会发送到该通道，数据会发送到该用户组中的每一个用户
			
		- 但是，由于每个用户都具有与提供商提供的地址进行匹配，如果地址匹配，数据就保留下来，否则被抛弃


- CM与CMTS：为了使用有线网络进行数据传输的两种关键设备
	
	- CM(cable modem)有线调制解调器：与ADSL调制解调器类似。连接在滤波器和PC之间，通道用作传输数据
		
	- CMTS(cable modem transmission system)有线调制解调器传输系统：由有线公司安装在分配集线器中，从因特网接收数据并传递给混合器，由混合器发送给用户。也接收来自用户的数据并将其上传到因特网


- 数据传输方案：DOCSIS(Data Over System Interface Specification)有线数据系统接口规范。定义了将数据从CMTS传输到CM所必须的全部协议
	
	- 上行通信：描述了CM必须遵循的步骤：
		
		- CM检查CMTS定期发送的特定分组的下行通道。该分组要求有任何一个新的CM声明自己位于一条特定的上行通道
			
		- CMTS向CM发送一个分组，规定分配给它的下行通道和上行通道
			
		- CM随后启动一个过程，称为测距ranging，以确定CM与CMTS之间的距离。这一过程是必需的，用于所有CM与CMTS之间的同步以获取上行通道分时共享时所使用的微时隙
			
		- CM向ISP发送一个分组，请求因特网地址
			
		- CM向CMTS随后交换一些分组以建立安全参数。公用网络需要使用这些参数
			
		- CM向CMTS发送它的唯一标识符
			
		- 上行通信在所分配的上行通道中开始，CM会竞争微时隙来发送数据
			
		
	- 下行通信：只有一个发送方，没有竞争
		
		- CMTS使用所分配的下行通道，发送包含接收CM地址的分组
