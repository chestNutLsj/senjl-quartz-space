## 数据结构

### 判断

1. $(\log n)!=\Theta(n^{\log\log n})$ 

> ❌
> ![[2024-威卷I-complexity.jpg]]

5. 对随机的二进制串做匹配时，采用 KMP 算法比 BM-BC 算法通常效率更低。

> ✅
> ![[A0-String-analysis.png]]
> 随机的二进制串，意思就是 pr=0.5 处的函数值，可以看到此时 KMP 的效率是低于 BM-BC 算法的。

6. 红黑树删除节点的 BB-1 情况中，要么改变 1 个节点的颜色，要么改变 3 个。

> ✅
> [[61-Balanced-BST#双红修正|红黑树双红修正：黑高度增加的可能性]]，[[61-Balanced-BST#双黑修复|红黑树双黑修复：黑高度降低的可能性]] 
> ![[61-Balanced-BST#^a8698f]]
> ![[60E-BBST-Red-black-tree-doubleRed-flow.png]]
> ![[60E-BBST-Red-black-tree-double-black-flow.png]]

### 填空

#### 左偏率

左偏率定义为 左子树的关键码规模/右子树的关键码规模 。
则 `根节点只有 1 个关键码的 8阶 B 树`、`完全二叉堆`、`左式堆`、`AVL树`、`红黑树` 各自根节点的最小左偏率为 A、B、C、D、E。当关键码规模 n 充分大时，给出从小到大的排序。

> ![[IMG_20231124_215313.jpg]]
> 
> ![[IMG_20231124_215324.jpg]]
> - 这里 AVL 树不知道放在哪里合适，但有一点可以确定，必然是趋于 0 的。

#### 哈希表查找长度

对长度 11且初始为空的散列表 HT，散列函数是 `H(key)=key%7`，采用线性探测法解决冲突。现将关键字序列 87，40，30，6，11，22，98，20依次插入到 HT 后，HT 查找失败的平均查找长度是（  6  ）。

| index | 0   | 1   | 2   | 3   | 4   | 5   | 6   | 7   | 8   | 9   | 10  |
| ----- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| key   | 98  | 22  | 30  | 87  | 11  | 40  | 6   | 20  |     |     |     |

> 任何数 x，对该 Hash 函数的计算结果 `x%7=[0,1,2,3,4,5,6]`，即只能取到 7个结果，因此平均失败查找长度为 $\frac{1}{7}\times(9+8+7+6+5+4+3)=6$。注意，此处最后没有+2，意思是 Hash 结果不会取到 index=7 的位置，因此该处的比较次数不会计算在平均失败查找长度中。

### 算法

#### 中位数

> ![[B0-Sort#中位数选取]]

## 组成原理

### 判断

1. 流水线控制器中控制信号与单周期控制器类似，因此流水线控制器的设计可以完全按照单周期控制器设计的思路进行，而不是按照多周期的设计思路。

> ✅
> 流水线处理器中控制信号一旦在 ID 段由控制器生成就不会改变，并和数据信息同步地依次传递到后面的流水段中。显然，这和单周期控制器类似。

2. 变址寻址多用于公共子程序的浮动。

> ❌
> 所谓公共子程序的浮动，就是程序的地址不固定，根据指令的执行变化，因此应当使用相对寻址（基于当前 PC 值做偏移）
> ![[20-Intruction#寻址方式]] 

### 选择、填空

1. MIPS 异常处理中，如果异常指令处于延迟槽中，则（     ）
A. `EPC<-PC-4`
B. `EPC<-PC`
C. `EPC<-PC+4`
D. 以上说法都不对

> 答案是 A，但我倾向于 D，理由如下：
> EPC：指向发生异常的指令。而由于延迟槽是流水线 CPU 解决控制冲突的策略，其思路是通过将 Branch 指令提前，以减小分支失败的损失，而延迟槽中存放的是与分支指令无关的指令，延迟槽中的指令数应当与分支指令损失的时间片相同，如果仍不够，则插入 nop 指令。回到题目，异常指令处于延迟槽中，因此如果不指定延迟槽中指令数，则有可能在 ID、EX 等流水段中发生异常，PC 都已经完成+4、+8 不等的自增，因此我倾向于选择 D。

2. 大端方式、按字节编址的某计算机中，某条指令的操作数的机器数为 0xABCD00FF，该操作数用基址寻址方式，指令中形式地址表示为 0xFF00（补码），当前基址寄存器的内容为 0xC0000000，则该操作数的 LSB（即 0xFF）存放的地址是（      ）

> 形式地址用补码表示，因此其实际为-0x100，而由于是基址寻址的方式，因此该地址为 0xC0000000 - 0x100 = 0xBFFFFEFF。而由于大端存储，因此存放 0xFF 的地址为 0xBFFFFEFF + 0x4=0xBFFFFF03。

3. 下面哪个不是 MIPS 响应异常的硬件处理（      ）
A. 保存断点
B. 恢复断点
C. 关中断
D. 保存异常原因

> B。题解看下面操作系统部分的选择题。

4. 若计算机主存地址为 32 位，按字节编址，cache 数据区大小为 32KB，主存块大小为 32B，采用直接映射和回写策略，则 cache 行的位数至少是（      ）

> Cache 数据区大小为 32KB，主存块的大小为 32B，因此 Cache 中有 1K 个 Cache 行，物理地址中偏移量部分的长度为 $\log_{2}32 =5$ bit。
> 由于采用直接映射的方式，因此 1K 个 Cache 行映射到 1K 个分组，物理地址中组号的部分的长度为 10bit。
> 32bit 的主存地址除去 5bit 的偏移量和 10bit 的组号后，还剩 17bit 的 tag 部分。
> 又因为 Cache 采用写回法，所以 Cache 行的总位数应为 32B (数据位)+17bit (tag 位)+1bit (脏位)+1bit (有效位)=275bit

5. 若海明码 $P_{1}P_{2}D_{1}P_{3}D_{2}D_{3}P_{4}$ 为 0101100，则正确的 $D_{1}D_{2}D_{3}$ 为（  110  ）

> 海明码解码：
> 重新对 $D_{1},D_{2},D_{3}$ 编码，得到 $P_{1}=1,P_{2}=0,P_{3}=1$，这个故障字与原海明码的校验位进行异或，得到 110 ，因此码字的第 3 位出现了错。
> ![[13-Data-check-code#海明校验码]]

### 流水线周期

五级流水的 MIPS，L1 cache 采用指令缓存和数据缓存分别存放，可在一个时钟周期内完成缓存读写（与寄存器时钟周期同步），现有如下指令已经存入缓存，同一个周期内可以上升沿写、下降沿读寄存器：

```
lw  R1,0,(R2)
sub R4,R1,R5
and R6,R4,R5
or  R8,R1,R6

```

则在无数据旁路情况下，需要（    ）个时钟周期，在有数据旁路情况下，需要（     ）个时钟周期。

> 无数据旁路：14 个时钟周期。
> ![[2024-威卷I-pipeline-no-forward.png]]
> 有数据旁路：9 个时钟周期。
> ![[2024-威卷I-pipeline-forward.png]]

### 虚存与 cache 计算

某计算机存储器按字节编址，虚拟地址空间大小为 16MB，主存地址空间大小为 1MB，页面大小为 4KB；Cache 使用直接映射方式，共 8 行；主存与 Cache 之间交换的块的大小为 32 B。

系统运行到某一时刻时，页表的部分内容和 Cache 的部分内容分别如下图所示，图中页框号及标记字段的内容为 16进制。

页表内容：

| Virtual Page Number | Valid | Page Frame Number | ... |
|:-------------------:|:-----:|:-----------------:|:---:|
|          0          |   1   |        06         | ... |
|          1          |   1   |        04         | ... |
|          2          |   1   |        15         | ... |
|          3          |   1   |        02         | ... |
|          4          |   0   |        --         | ... |
|          5          |   1   |        2B         | ... |
|          6          |   0   |        --         | ... |
|          7          |   1   |        32         | ... |

Cache 内容：

| Line number | Valid | tag | ... |
|:-----------:|:-----:|:---:|:---:|
|      0      |   1   | 020 | ... |
|      1      |   0   | --  | ... |
|      2      |   1   | 01D | ... |
|      3      |   1   | 105 | ... |
|      4      |   1   | 064 | ... |
|      5      |   1   | 14D | ... |
|      6      |   0   | --  | ... |
|      7      |   1   | 27A | ... |

1. 虚拟地址共有（    ）位，物理地址中高（    ）位表示页框号。

> 虚拟空间大小 $16MB = 2^{24} B$ ，故虚拟地址有 24 位。
> 主存地址空间 1MB，而页面大小 4KB，因此共有 1MB/4KB = 256 页 = $2^8$ 页。因此物理地址中，高 8 位表示页框号，低 12 位表示页内偏移（$2^{12}$ B = 4KB）

2. 虚拟地址 0x001C60 对应的物理地址为（    ），访问该地址时，Cache 是否命中？（   ）

> 虚拟地址中，低 12 位是页内偏移，故 0xC60 不变，高 12 位是页表项，故 0x001 是所指页表，查表得页框号为 04，因此对应的物理地址为 0x04C60。
> 
> 由于是直接映射，因此 cache 中地址区域，低 12 位是块内地址，又因为 cache 有8=2^3行，因此标记行号的 index 有3 位，于是剩余的 20-3-12=5 位是 tag 位。对于物理地址 0x04C60，tag 位为 0x0，行号位为 0x4。而查表可知，tag 位不符，因此 Cache 未命中。

3. 假定为该机配置一个 4 路组相联的 TLB，共可存放 8 个页表项，若其当前内容如下图所示，则此时虚拟地址 0x024BAC 所在的页面是否在主存中？（    ）

| Group number | valid | tag | frame |     | valid | tag | frame |     | valid | tag | frame |     | valid | tag | frame |
| ------------ | ----- | --- | ----- | --- | ----- | --- | ----- | --- | ----- | --- | ----- | --- | ----- | --- | ----- |
| 0            | 0     | --  | --    |     | 1     | 001 | 15    |     | 0     | --  | --    |     | 1     | 012 | 1F    |
| 1            | 1     | 013 | 2D    |     | 0     | --  | --    |     | 1     | 008 | 7E    |     | 0     | --  | --      |

> 虚拟地址 0x024BAC 中，低 12 位是块内地址，1 位表示组号，剩余 11 位表示 tag。因此，组号为 0，tag 位为 0x012。可见，第四路中 0组有该块，故该地址所指页面在主存中。

## 操作系统

### 判断

1. SCAN 可能会磁臂黏着，C-SCAN 则不会。

> ❌
> 这两种扫描方式都会导致磁臂黏着，SCAN 类型的磁盘调度方式，若要改进磁臂黏着现象，使用 N-SCAN 或 FSCAN 策略。

2. 访问频率置换算法（Frequency-based Replacement）综合采用了 LRU 和 LFU 算法用于磁盘缓存置换，短周期使用 LFU，长周期使用 LRU。

> ❌
> ![[60-IO管理与磁盘#磁盘缓存的置换策略]]

3. RISC-V 要求实现精确异常：保证异常之前的所有指令都完整执行，后续指令都没有开始执行。

> ✅
> ![[A0-Privileged-architecture#RISC-V 异常分类]]

### 选择

1. 执行系统调用的过程中涉及下列操作，其中由操作系统完成的是（    ）
A. 保存断点和程序状态字
B. 保存通用寄存器的内容
C. 执行系统调用服务例程
D. 将 CPU 模式改为内核态

> B, C
> - 保存 breakpoint 和 PSW，是由 CPU 将对应内容压入堆栈；
> - 更改 CPU 模式修改的是 PSR (Processor Status Register)中的 CPL 字段（在 IA-32 处理器中，如果是 RISC-V 处理器，则是设置 `mstatus.MPP` 位）
> 
> 中断/异常发生时，软硬件的动作：
> > - Hardware
> > 	1. Device controller or other system hardware issues an interrupt
> > 	2. Processor finishes execution of current instruction
> > 	3. Processor signals acknowledgment of interrupt
> > 	4. Processor pushes PSW and PC onto control stack
> > 	5. Processor loads new PC value based on interrupt
> >
> > - Software
> > 	1. Save remainder of process state infomation
> > 	2. Process interrupt
> > 	3. Restore process state information
> > 	4. Restore old PSW and PC

### 自旋锁与互斥锁

Linux 的多线程应用程序使用的锁（如 `pthread_mutex_t`）不是自旋锁，当上锁失败时会切换到其它程序执行。分析它和自旋锁的优劣，并说明为什么不用自旋锁？

> ![[8-并发#互斥锁和自旋锁的差异]]

### 虚存地址转换

某计算机系统按字节编址，采用二级页表的分页存储管理方式，虚拟地址格式为高 10 位是页目录号，中间 10 位是页表索引，低 12 位是页内偏移。假定页目录项和页表项均占 4B，则
1. 进程的页目录和页表共占（    ）个页；

> 页表大小为 $2^{12}B=4KB$
> 高 10 位是页目录号，即有 $2^{10}$ 条页目录项，每条页目录项占 4B，则共 4KB，即 1 个页。
> 而每条页目录项指向 1 个页索引页，即有 $2^{10}$ 个页表索引页。故页目录和页表共 1025 页。

2. 若某指令周期内访问的虚拟地址为 0x01000000 和 0x01112048，则进行地址转换时共访问（    ）个二级页表。

> 两个虚拟地址都访问了页目录表中的 0x100 项，因此指向了同一个页表索引页。故只需要访问 1 个二级页表。

## 计算机网络

### 判断

1. OSI 模型中数据链路层会在处理协议元数据时，在数据的头部和首尾都添加信息。

> ✅
> 头部添加 MAC 地址、协议类型等信息，尾部添加 CRC 校验码。具体如下
> ![[60-Link-layer-and-LAN#以太网帧]]

2. PPP 协议采用字节填充法组帧。

> ✅ 
> ![[2024-威卷I-PPP-framing.png]]

3. VLAN 字段只有网桥和交换机才会真正用到，用户计算机并不使用。

> ✅ 
> 只有交换机和网桥在进行分组转发时，才需要考虑 VLAN 的划分，而用户计算机是看不到自己 VLAN 之外的计算机的（除非对方向它暴露IP、MAC等）
> ![[60-Link-layer-and-LAN#虚拟局域网]]

4. SDN 中控制平面和数据平面都是以软件为基础的技术。

> ❌ 其中，数据平面以硬件为主（路由器），控制平面以软件为主（中央服务器运行流表计算的软件）。
> 
> ![[50-Network-layer-Control-plane#SDN 体系结构的四个关键特征]]

### 选择、填空

2. 海明纠错码想要纠正 n 位错误，则最短码距是（    ）

> 2n+1
> ![[题目练习-hamming.png]]

3. 若路由器向 MTU=800 的链路转发一个总长度为 1580B 的 IP 数据报（首部长度为 20B），若进行分片且使每个分片尽可能大，则第 2 个分片的总长度字段和 MF 标志位的值分别是（  796  ）（  1  ）

> 题目中给出的 1580B 的 IP 数据报，首部长度 20B，因此数据长度 1560B；要进行分片，每个片的大小是 800B，即 20B+780B；但是要注意，为了对齐，IPv4 中数据部分必须是 8 的倍数，而小于 780 的是 8 的倍数的数字是 776，而总数据 1560/776=2.01，即需要分三片才可以完成。因此第一片的首部长度 20，数据长度 776，MF=1；第二片的首部长度 20，数据长度 776，MF=1；第三片的首部长度 20，数据长度 8，MF=0。
> 
> 注意 MF、总长度字段的含义：
> ![[2024-威卷I-IPv4-frame.png]]
> 
> 其中，DF 和 MF 是与 IPv4 数据报分片相关的控制位：
> ![[2024-威卷I-DF-MF.png]]
> ![[2024-威卷I-total-length.png]]
> 

### 路由表计算（DV 算法）

假设路由器 A 的路由表如下：

| Destination network | Distance | Next hop router |
| ------------------- | -------- | --------------- |
| N1                  | 4        | B               |
| N2                  | 2        | C               |
| N3                  | 2        | F               |
| N4                  | 5        | G               | 

现在 A 收到从 C 发来的路由信息：

| Destination network | Distance |
| ------------------- | -------- |
| N1                  | 2        |
| N2                  | 3        |
| N3                  | 3        |
| N4                  | 7        | 

则，A 的更新后的路由表为：

> 路由表中距离按跳数算。
> ![[2024-威卷I-router-table.png]]

### DNS 解析时间

假设下图所示网络中的本地域名服务器只提供递归查询服务，其它域名服务器均只提供迭代查询服务；局域网内的主机访问 Internet 上各服务器的往返时间 RTT 均为10ms，忽略其他各种时延。若主机 H 通过超链接 `http://www.abc.com/index.html` 请求浏览纯文本 Web 页 `index.html`，则从点击超链接开始到浏览器接收到 `index.html` 页面为止，所需的最短时间与最长时间分别是（   ）和（   ）。

![[2024-威卷I-DNS.png]]

> 20ms 50ms
> 
> - IP 地址若在本地域名服务器中可以解析得到，就不需要再请求 Internet 中的服务器，因此根据题意，一切时间在于和 `www.abc.com` 建立 TCP 连接并传输数据，因此是 10+10=20ms
> - IP 地址若不在本地域名服务器，则本地 DNS 服务器会向 Internet 发送三个查询报文，查询过程是迭代的，分别查询根 DNS 服务器、com 顶级域名服务器、`abc.com` 权威域名服务器，因此 3 * 10=30ms 后能够得到 `www.abc.com` 的 IP 地址并返回给设备，于是设备可以在 10+10=20ms 内与 `www.abc.com` 建立 TCP 连接并传送数据，故总计时间 50ms。
> 