### 1.2.5　代码优化

机器无关的代码优化步骤试图改进中间代码，以便生成更好的目标代码。“更好”通常意味着更快，但是也可能会有其他目标，如更短的或能耗更低的目标代码。比如，一个简单直接的算法会生成中间代码（1.3）。它为由语义分析器得到的树形中间表示中的每个运算符都使用一个指令。

使用一个简单的中间代码生成算法，然后再进行代码优化步骤是生成优质目标代码的一个合理方法。优化器可以得出结论：把60从整数转换为浮点数的运算可以在编译时刻一劳永逸地完成。因此，用浮点数60.0来替代整数60就可以消除相应的inttofloat运算。而且，`t3`仅被使用一次，用来把它的值传递给`id1`。因此，优化器可以把序列（1.3）转换为更短的指令序列

![021-1](../Images/image03955.jpeg)

不同的编译器所做的代码优化工作量相差很大。那些优化工作做得最多的编译器，即所谓的“优化编译器”，会在优化阶段花相当多的时间。有些简单的优化方法可以极大地提高目标程序的运行效率而不会过多降低编译的速度。从第8章开始，将详细讨论机器无关和机器相关的优化。