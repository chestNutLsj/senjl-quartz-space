### 5.2.1　依赖图

依赖图描述了某个语法分析树中的属性实例之间的信息流。从一个属性实例到另一个实例的边表示计算第二个属性实例时需要第一个属性实例的值。图中的边表示语义规则所蕴涵的约束。更详细地说：

- 对于每个语法分析树的结点，比如一个标号为文法符号X的结点，和X关联的每个属性都在依赖图中有一个结点。
- 假设和产生式p关联的语义规则通过X.c的值定义了综合属性A.b的值（这个规则定义A.b时可能还用到了X.c之外的其他属性）。那么，相应的依赖图中有一条从X.c到A.b的边。更准确地讲，在每个标号为A且应用了产生式p的结点N上，创建一条从该产生式体中的符号X的实例所对应的N的子结点上的属性c到N上的属性b的边。[^2]
- 假设和产生式p关联的一个语义规则通过X.a的值定义了继承属性B.c的值。那么，在相应的依赖图中有一条从X.a到B.c的边。对于每个标号为B、对应于产生式p中的这个B的结点N，创建一条从结点M上的属性a到N上的属性c的边。这里的M对应于这个X。请注意，M可以是N的父结点或者兄弟结点。

例5.4　考虑下面的产生式和规则：

![214-1](../Images/image04314.jpeg)

在每个标号为E，且其子结点对应于这个产生式体的结点N上，N上的综合属性val使用两个子结点（标号分别为E和T）上的val值计算得到。因此，对于每个使用了这个产生式的语法分析树，该树的依赖图中有一部分如图5-6所示。作为惯例，我们将把语法分析树的边显示为虚线，而依赖图的边显示为实线。

![214-2](../Images/image04315.jpeg)

图5-6　E.val由E1.val和T.val综合得到

例5.5　一个完整的依赖图的例子如图5-7所示。这个依赖图的结点用数字1～9表示，对应于图5-5中的注释语法分析树中的各个属性。

![214-3](../Images/image04316.jpeg)

图5-7　对应于图5-5中的注释语法分析树的依赖图

结点1和2表示和其标号为digit的两个叶子结点相关联的属性lexval。结点3和4表示和其标号为F的两个结点相关联的属性val。从结点1到结点3的边，以及从结点2到结点4的边是根据通过SDD中digit.lexval定义F.val的语义规则得到的。实际上，F.val等于digit.lexval，但依赖图中的边表示的是依赖关系，而不是等于关系。

结点5和6表示和非终结符号T′的各次出现相关联的继承属性T′.inh。从结点3到结点5的边是根据规则T′.inh=F.val得到的，这个规则根据根的左子结点上的F.val定义了右子结点上的T′.inh。我们看到了从结点5到结点6的代表T′.inh的边和从结点4到结点5的代表F.val的边，因为这两个值相乘后得到了结点6上的属性inh的值。

结点7和8表示了和T′的各次出现相关联的综合属性syn。从结点6到结点7的边是根据图5-4中的产生式3所关联的规则T′.syn=T′.inh得到的。从结点7到结点8的边是根据产生式2所关联的语义规则得到的。

最后，结点9表示属性T.val。从结点8到结点9的边是根据产生式1所关联的语义规则T.val=T′.syn而得到的。