### 5.3.2　类型的结构

当语法分析树的结构和输入的抽象语法树的结构不同时，继承属性是很有用的。在这种情况下，继承属性可以用来将信息从语法分析树的一部分传递到另一部分。下一个例子显示了这种结构上的不匹配可能是由语言设计引起的，而不是由语法分析方法的约束引起的。

例5.13　在C语言中，类型int［2］［3］可以读作：“由两个数组组成的数组，子数组中有三个整数”。相应的类型表达式array（2，array（3，integer））可以使用图5-15中的树来表示。运算符array有两个参数，一个是数字，另一个是类型。如果使用树来表示类型，那么这个运算符返回一个标号为array的结点，该结点具有两个子结点，分别表示数字和类型。

![221-1](../Images/image04330.jpeg)

图5-15　int［2］［3］的类型表达式

使用图5-16中的SDD，非终结符号T生成的是一个基本类型或一个数组类型。非终结符号B生成基本类型int和float之一。当T推导出BC且C推导出∈时，T生成一个基本类型。否则，C就生成由一个整数序列组成的数组描述分量，其中的每个整数用方括号括起。

![221-2](../Images/image04331.jpeg)

图5-16　T生成一个基本类型或一个数组类型

非终结符号B和T有一个表示类型的综合属性t。非终结符号C有两个属性：一个继承属性b和一个综合属性t。继承属性b将一个基本类型沿着树向下传播，而综合属性t则收集最终得到的结果。

输入串int［2］［3］的注释语法分析树如图5-17所示。图5-15中的相应类型表达式的构造过程如下：首先类型integer从B开始，沿着C组成的链通过继承属性b向下传递。最后的数组类型是沿着C组成的链、通过属性t不断向上传递并综合而得到的。

![221-3](../Images/image04332.jpeg)

图5-17　数组类型的语法制导的翻译

更详细地讲，在产生式T→BC对应的根结点上，非终结符号C使用继承属性C.b从B那里继承类型。在最右边的C结点上的产生式是C→∈，因此C.t等于C.b。产生式C→［num］C1的语义规则将运算符array作用到运算分量num.val和C1.t上，得到C.t的值。