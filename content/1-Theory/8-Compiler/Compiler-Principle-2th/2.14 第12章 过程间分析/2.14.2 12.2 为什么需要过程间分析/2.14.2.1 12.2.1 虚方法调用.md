### 12.2.1　虚方法调用

上面提到过，面向对象程序有很多小的方法。如果我们每次只对一个方法进行优化，那么只能找到很少的优化机会。对方法调用进行解析就可以促成更多的优化。像Java这样的程序设计语言动态地载入它的类。结果，我们在编译时刻不知道在x.m()这样的调用中对m的某次使用到底指向（可能的）多个名为m的方法中的哪一个。

很多Java语言的实现使用了一个即时编译器，在运行时刻对它的字节码进行编译。一个常见的优化技术是找出程序执行的剖面图，并确定接收对象通常是什么类型。然后，我们可以把调用最频繁的方法内联到调用代码中。相应的代码包含了对这个类型的动态检查，如果运行时刻的接收对象具有预期的类型就执行内联的方法。

只要所有的源代码都在编译时刻可用，我们就可以使用另一种方法来解析对方法名字m的使用。然后，可以进行过程间分析，确定对象类型。如果变量x的类型是唯一的，那么x.m()的使用就可以被解析。我们明确地知道在这个上下文中m指向哪个方法。在这种情况下，我们可以内联这个m的代码，编译器甚至不需要在生成的代码中加入对x的类型检查代码。