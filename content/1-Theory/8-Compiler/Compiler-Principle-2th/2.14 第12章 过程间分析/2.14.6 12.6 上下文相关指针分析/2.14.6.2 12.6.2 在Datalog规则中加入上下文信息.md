### 12.6.2　在Datalog规则中加入上下文信息

为了找出上下文相关的指针指向关系，我们可以直接把相同的上下文无关指针指向分析技术应用到克隆的调用图上。因为在这个克隆的调用图中的方法是用原方法和它的上下文来表示的，我们相应地修正了所有的Datalog规则。为简单起见，下面的规则不包括类型约束，且符号“_”表示了任何新的变量。

IDB断言pts中必须增加一个表示上下文的参数。断言pts（V, C, H）表示上下文C中的变量V可以指向堆对象H。所有这些规则都是不解自明的，但规则5是一个例外。规则5表示，如果上下文C中的调用点S调用了上下文D的方法M，那么上下文D的方法M的形式参数可能指向由上下文C中的相应实在参数指向的对象。

![615-1](../Images/image05093.jpeg)

图12-29　上下文相关的指针指向分析的Datalog图