### 12.3.4　Datalog程序的执行

每一组Datalog规则都定义了它的IDB断言的关系。这些关系是程序中的EDB断言关系表的函数。开始时假设IDB关系为空（即对于所有可能的参数，各个IDB断言为假）。然后重复应用这些规则，根据这些规则不断推导出新的事实。当推导过程收敛时，就完成了程序的运行。运行得到的IDB关系就形成了程序的输出。这个过程将在下面的算法中正式给出。这个算法和第9章中讨论的迭代算法类似。

算法12.15　Datalog程序的简单求值。

输入：一个Datalog程序和各个EDB断言的事实集合。

输出：每个IDB断言的事实集合。

方法：对于程序中的每个断言p，令Rp为使该断言为真的事实关系。如果p是一个EDB断言，那么Rp就是该断言给出的所有事实。如果p是一个IDB断言，我们将计算Rp。执行图12-16中的算法。

![602-2](../Images/image05074.jpeg)

图12-16　Datalog程序的求值

例12.16　例12.12中的程序计算一个图中的路径。应用算法12.15时，最初EDB断言edge保存了该图的所有边，而path的关系为空。第一轮的时候，规则2没有产生任何结果，因为此时还没有path的事实。但是规则1使得所有的edge事实都变成了path事实。也就是说，在第一轮过后，我们知道path（a, b）成立当且仅当有一条从a到b的边。

在第二轮中，规则1没有生成新的path事实，因为EDB关系edge没有改变。但是，现在规则2令我们把两个长度为1的路径连接到一起生成一个长度为2的路径。也就是说，在第二轮之后，path（a, b）为真当且仅当从a到b有一条长度为1或2的路径。类似地，在第三轮中，我们可以把长度不大于2的路径连接起来找到所有长度不大于4的路径。在第四轮，我们发现最大长度为8的路径，并且一般来说，在第i轮之后，path（a, b）为真当且仅当有一个从a到b且长度不大于2i-1的路径。