## 4.4　自顶向下的语法分析

自顶向下语法分析可以被看作是为输入串构造语法分析树的问题，它从语法分析树的根结点开始，按照先根次序（如2.3.4节中所讨论的，深度优先地）创建这棵语法分析树的各个结点。自顶向下语法分析也可以被看作寻找输入串的最左推导的过程。

例4.27　图4-12中对应于输入id + id * id的语法分析树序列是一个根据文法（4.2）进行的最左推导序列。这里重复一下这个文法：

E→T E′

E′→+ T E′ | ∈

T→F T′　（4.28）

T′→* F T′ | ∈

F→（E）| id

该语法分析树序列对应于这个输入的一个最左推导。

在一个自顶向下语法分析的每一步中，关键问题是确定对一个非终结符号（比如A）应用哪个产生式。一旦选择了某个A产生式，语法分析过程的其余部分负责将相应产生式体中的终结符号和输入相匹配。

本节首先给出被称为递归下降语法分析的自顶向下语法分析的通用形式，这种方法可能需要进行回溯，以找到要应用的正确A产生式。2.4.2节介绍的预测分析技术是递归下降分析技术的一个特例，它不需要进行回溯。预测分析技术通过在输入中向前看固定多个符号来选择正确的A产生式。通常情况下我们只需要向前看一个符号（即只看下一个输入符号）。

比如，考虑图4-12中的自顶向下语法分析过程，它构造出了一棵语法分析树，其中有两个标号为E′的结点。在（按照前序遍历次序的）第一个E′结点上选择的产生式是E′→+ T E′；在第二个E′结点上选择的产生式是E→∈。预测分析器通过查看下一个输入符号就可以在两个E′产生式中选择正确的产生式。

![153-1](../Images/image04177.jpeg)

图4-12　id+id*id的自顶向下分析

对于有些文法，我们可以构造出向前看k个输入符号的预测分析器，这一类文法有时也称为LL（k）文法类。我们在4.4.3节中将讨论LL（1）文法类，但是在介绍预备知识的4.4.2节中将介绍一些计算FIRST和FOLLOW集合的方法。根据一个文法的FIRST和FOLLOW集合，我们将构造出“预测分析表”，它说明了如何在自顶向下语法分析过程中选择产生式。这些集合也可以用于自底向上语法分析。

在4.4.4节中，我们给出了一个非递归的语法分析算法，它显式地维护了一个栈，而不是通过递归调用隐式地维护一个栈。最后，我们将在4.4.5节中讨论自顶向下语法分析过程中的错误恢复问题。