### 4.2.3　推导

将产生式看作重写规则，就可以从推导的角度精确地描述构造语法分析树的方法。从开始符号出发，每个重写步骤把一个非终结符号替换为它的某个产生式的体。这个推导思想对应于自顶向下构造语法分析树的过程，但是推导概念所给出的精确性在讨论自底向上的语法分析过程时尤其有用。正如我们将看到的，自底向上语法分析和一种被称为“最右”推导的推导类型相关。在这种推导过程中，每一步重写的都是最右边的非终结符号。

比如，考虑下列只有一个非终结符号E的文法。它在文法（4.3）中增加了一个产生式E→-E：

E→E + E | E * E | - E |（E）| id　（4.7）

产生式E→-E表明，如果E表示一个表达式，那么-E必然也表示一个表达式。将一个E替换为-E的过程写作

E⇒-E

上式读作“E推导出-E”。产生式E→（E）可以将任何文法符号串中出现的E的任何实例替换为（E）。比如，E * E⇒（E）* E或E * E⇒E *（E）。我们可以按照任意顺序对单个E不断地应用各个产生式，得到一个替换的序列。比如：

E⇒-E⇒-（E）⇒-（id）

我们将这个替换序列称为从E到-（id）的推导。这个推导证明了串 -（id）是表达式的一个实例。

要给出推导的一般性定义，考虑一个文法符号序列中间的非终结符号A，比如αAβ，其中α和β是任意的文法符号串。假设A→γ是一个产生式。那么我们写作αAβ⇒αγβ。符号⇒表示“通过一步推导出”。当一个推导序列α1⇒α2⇒…⇒αn将α1替换为αn，我们说α1推导出αn。我们经常说“经过零步或多步推导出”，我们可以使用符号![141-5](../Images/image04142.jpeg)来表示这种关系。因此，

1）对于任何串α，![141-1](../Images/image04143.jpeg)，并且

2）如果![141-2](../Images/image04144.jpeg)且β⇒γ，那么![141-3](../Images/image04145.jpeg)。

类似地，![141-4](../Images/image04146.jpeg)表示“经过一步或多步推导出”。

如果![142-9](../Images/image04147.jpeg)，其中S是文法G的开始符号，我们说α是G的一个句型（sentential form）。请注意，一个句型可能既包含终结符号又包含非终结符号，也可能是空串。文法G的一个句子（sentence）是不包含非终结符号的句型。一个文法生成的语言是它的所有句子的集合。因此，一个终结符号串w在G生成的语言L（G）中，当且仅当w是G的一个句子（或者说![142-10](../Images/image04148.jpeg)）。可以由文法生成的语言被称为上下文无关语言（context-free language）。如果两个文法生成相同语言，这两个文法就被称为是等价的。

串-（id+id）是文法（4.7）的一个句子，因为存在一个推导过程

E⇒- E⇒-（E）⇒-（E + E）⇒-（id + E）⇒-（id + id）　（4.8）

串E、-E、-（E）、…、-（id+id）都是这个文法的句型。我们用![142-1](../Images/image04149.jpeg)来指明-（id + id）可以从E推导得到。

在每一个推导步骤上都需要做两个选择。我们要选择替换哪个非终结符号，并且在做出这个决定之后，还必须选择一个以此非终结符号作为头的产生式。比如，下面给出的-（id +id）的另一种推导和推导（4.8）在最后两步有所不同：

E⇒- E⇒-（E）⇒-（E + E）⇒-（E + id）⇒-（id + id）　（4.9）

在这两个推导中，每个非终结符号都被替换为同一个产生式体，但替换的顺序有所不同。

为了理解语法分析器是如何工作的，我们将考虑在每个推导步骤中按照如下方式选择被替换的非终结符号的两种推导过程：

1）在最左推导（leftmost derivation）中，总是选择每个句型的最左非终结符号。如果α⇒β是一个推导步骤，且被替换的是α中的最左非终结符号，我们写作![142-2](../Images/image04150.jpeg)。

2）在最右推导（rightmost derivation）中，总是选择最右边的非终结符号，此时我们写作![142-3](../Images/image04151.jpeg)。推导（4.8）是最左推导，因此它可以写成

![142-4](../Images/image04152.jpeg)

请注意，推导（4.9）是一个最右推导。

根据我们的符号表示惯例，每个最左推导步骤都可以写成![142-5](../Images/image04153.jpeg)，其中w只包含终结符号，A→δ是被应用的产生式，而γ是一个文法符号串。为了强调α经过一个最左推导过程得到β，我们写作![142-6](../Images/image04154.jpeg)。如果![142-7](../Images/image04155.jpeg)，那么我们说α是当前文法的最左句型（left-sentential form）。

对于最右推导也有类似的定义。最右推导有时也称为规范推导（canonical derivation）。