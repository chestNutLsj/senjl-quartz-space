### 11.6.5　解决一般性的整数线性规划问题

现在我们描述一个解决整数线性规划问题的一般性方法。这个问题是NP-完全的。我们的算法使用了一个分支-界定方法，这种方法在最坏情况下花费的时间为指数级。但是，11.6.4节中的启发式规则未能解决问题的情况很少出现。并且即使我们需要应用本节中的算法，也很少需要执行算法中的分支-界定步骤。

这个方法首先检查不等式组是否存在有理数解。这个问题是标准的线性规划问题。如果不等式组不存在有理数解，问题中的数组访问所触及的数据区域就一定不相交，因此一定不存在数据依赖关系。如果存在有理数解，我们首先试图证明存在一个整数解（通常会有这样的解）。如果不能证明这一点，我们就把这个不等式组界定的多面体分割为两个较小的问题，并递归地解决问题。

例11.38　考虑下面的简单循环：

![537-1](../Images/image04931.jpeg)

访问Z［i］所触及的元素是Z［1］、…、Z［9］，而访问Z［i+10］所触及的元素是Z［11］、…、Z［19］。这两个范围并不相交，因此不存在数据依赖关系。更严格地讲，我们需要说明不存在两个动态访问i和i′满足1≤i≤9，1≤i′≤9且i=i′+10。如果存在这样的整数i和i′，那么可以用i′+10来替代i，并得到四个关于i′的约束：1≤i′≤9和1≤i′+10≤9。但是，i′+10≤9蕴含i′≤-1，这和1≤i′矛盾。因此不存在这样的整数i和i′。

算法11.39描述了如何基于Fourier-Motzkin消除算法来确定是否可以找到一组线性不等式的整数解。

算法11.39　整数线性规划问题的分支界定解法。

输入：一个变量v1，…，vn上的多面体Sn。

输出：如果Sn有一个整数解，输出“yes”，否则输出“no”。

方法：图11-22中给出的算法。

![537-2](../Images/image04932.jpeg)

图11-22　寻找不等式的整数解

第1行到第3行试图找出不等式组的一个有理数解。如果没有有理数解，就没有整数解。如果找到一个有理数解，就表明这个不等式组定义了一个非空的多面体。这样的一个多面体不包含整数解的情况相对较少——要是出现这种情况，这个多面体在某些维度上必然很薄，而且位于整数点之间。

因此，第4行到第9行试图快速检查是否存在一个整数解。Fourier-Motzkin消除算法的每一步都会产生一个多面体，其维度比前一个多面体的维度小1。我们反向考虑这些多面体。我们从只有一个变量的多面体开始，在可能的情况下，向这个变量赋予一个大概处于它的取值范围中间的整数值。然后，我们在所有其他的多面体中用这个值来替代这个变量，把这些多面体的未知量的数目减一。不断重复这个过程，直到所有的多面体都得到处理，或者找到了一个没有整数解的变量。在前一种情况下，我们可以找到一个整数解。

如果我们甚至不能为第一个变量找到整数值，那么整个不等式组就不存在整数解（第10行）。否则，我们所知道的全部情况就是没有哪个整数解会包含至今为止我们为一些变量选择的特定整数值。这个结论不是决定性的。第11行到第13行表示算法的分支-界定步骤。如果发现变量vi具有有理数解但是没有整数解，就把问题中的多面体分成两个多面体，第一个要求vi必须是小于已找到的有理数的整数，第二个要求vi必须是一个大于此有理数解的整数。如果两个多面体都没有整数解，那么就不存在依赖关系。