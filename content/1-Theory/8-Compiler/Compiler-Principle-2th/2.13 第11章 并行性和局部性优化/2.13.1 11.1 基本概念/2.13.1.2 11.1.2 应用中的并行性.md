### 11.1.2　应用中的并行性

我们使用两种高层次的度量来估计一个并行应用性能运行的好坏：并行性覆盖率和并行性粒度，前者指明了并行执行的计算过程所占的百分比；后者指出了各个处理器在不和其他处理器通信或同步的情况下能够运行的计算量。一个特别有吸引力的并行化目标是循环：一个循环可能有很多个迭代，并且如果它们之间相互独立，我们就找到了一个很大的并行性的源头。

Amdahl定律

并行性覆盖率的重要性可以用Amdahl定律简洁地表示。Amdahl定律的内容是，如果f是被并行化代码的比率，并且如果并行化版本在一个有p个处理器的机器上运行，且没有任何通信或者并行化开销，那么此时的加速比是：

![505-1](../Images/image04861.jpeg)

比如，如果有一半的计算是串行执行的，那么不管我们使用多少个处理器，计算过程最多能够以双倍速度运行。如果我们有4个处理器，可达到的加速比是1.6。即使并行化覆盖率达到90%，我们在4个处理器上最多能够得到3倍的加速比，而在无限多的处理器上得到的加速比最多为10。

并行化的粒度

理想情况是一个应用的全部计算过程能够被划分成为很多粗粒度的独立任务，因为我们可以直接把不同的任务分配给不同的处理器。这样的例子之一是SETI（Search for Extra Terrestrial Intelligence，寻找外星智慧生物）项目，这个实验使用很多通过Internet相连的家庭计算机来并行分析射电望远镜数据的不同部分。每一个工作单元只需要少量的输入并生成少量的输出，并且可以独立于所有其他单元完成。由于这些原因，虽然Internet具有相对高的通信延时和低带宽，但这样的计算工作仍然在与Internet连接的机器上运行得很好。

大部分应用要求处理器之间有更多的通信和交互，但仍然支持粗粒度的并行性。比如，考虑一个Web服务器，它负责响应大量独立的对一个公共数据库的请求。我们可以在一个多处理器机器上运行这个应用，使用一个线程来实现数据库访问，并使用其他线程来对用户请求提供服务。其他的例子包括药物设计和机翼动力学模拟。在这些例子中，人们可以独立地求解针对不同的参数的结果。在模拟的时候，有时即使对于一组参数求解也会花很长时间，因此期望能够使用并行化技术进行加速。当一个应用中的可用并行性的粒度降低时，就需要更好的处理器之间的通信支持和更多的编程工作量。

很多运行时间很长的科学及工程应用具有简单的控制结构和很大的数据集合，因此它们要比上面讨论的应用更容易实现更细粒度的并行化。因此，本章主要考虑的是那些用于数值应用的技术，特别是那些把大部分时间用于多维数组中的数据运算的应用。下面我们就探讨一下这类程序。