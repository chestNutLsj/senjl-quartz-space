### 11.4.2　实践中的仿射访问和非仿射访问

在数值计算程序中，有一些常见的数据访问模式不是仿射的。涉及稀疏矩阵的程序是一个重要的例子。稀疏矩阵的常用表示方法之一是只保存一个向量中的非零元素，并使用辅助的下标数组来记录某一行从哪里开始，以及哪些列包含非零元素。访问这样的数据时要使用间接数组访问。这种类型的访问，比如X［Y［i］］，是对数组X的非仿射访问。如果矩阵的稀疏情况是有规律的，比如在一个带状矩阵中只有在对角线周围才有非零元素，那么可以使用紧密数组来表示带有非零元素的子区域。在这样的情况下，数组访问仍可能是仿射的。

另一个常见的非仿射访问的例子是线性化的数组。程序员有时使用一个线性数组来存放一个在逻辑上多维的对象。这么做的原因之一是多维数组的维度可能在编译时刻未知。在正常情况下写成Z［i,j］形式的访问现在变成了Z［i*n+j］，其下标是一个二次函数。如果对线性化数组的每个访问都可以被分解为不同维度的分量并保证每个分量都不会超过维度界限，那么我们可以把这个线性访问转换成为一个多维的访问。最后，如例11.18所示，我们注意到可以使用归纳变量分析把一些非仿射访问转换成为仿射访问。

例11.18　我们可以把下面的代码

![523-2](../Images/image04899.jpeg)

写成

![523-3](../Images/image04900.jpeg)

这样做使得这个对矩阵Z的访问变成仿射的。