### 11.4.1　仿射访问

如果下列条件成立，我们就说一个循环中的一个数组访问是仿射的。

1）该循环的上下界被表示为外围循环变量和符号常量的仿射表达式，且

2）该数组的每个维度的下标也是外围循环变量和符号常量的仿射表达式。

例11.16　假设i和j是循环下标变量，其上下界通过仿射表达式给出。仿射数组访问的例子有Z［i］，Z［i+j+1］，Z［0］，Z［i,i］和Z［2*i+1,3*j-10］。如果n是一个循环嵌套结构中的符号常量，那么Z［3*n,n-j］是仿射数组访问的另一个例子。但是Z［i*j］和Z［n*j］不是仿射访问。

每个仿射数组访问可以用两个矩阵和两个向量来描述。第一个矩阵-向量对是B和b，它们以式（11.1）中的不等式的方式描述了该访问的迭代空间。我们通常用F和f来表示第二对矩阵-向量对。它们表示循环下标变量的函数，这些函数生成了在数组访问的不同维度中使用的数组下标。

正式地说，我们把使用了下标变量向量i的一个循环嵌套结构中的数组访问表示为一个四元组![522-5](../Images/image04897.jpeg)；它把界限

Bi+b≥0

中的向量i映射到数组元素位置

Fi +f

例11.17　图11-18中是一些常见的用矩阵表示法表示的数组访问。两个循环下标i和j组成了向量i。另外，X、Y和Z分别是维度为1、2和3的数组。

![523-1](../Images/image04898.jpeg)

图11-18　一些数组访问和它们的矩阵-向量表示

第一个数组访问X［i-1］由一个1×2的矩阵F和一个长度为1的向量f表示。请注意，当我们执行矩阵-向量乘法并加到f中时，我们得到一个函数i-1。这个函数就是前面提到的对一维数组X进行访问所使用的公式。同时请注意，第三个访问Y［j,j+1］在进行矩阵-向量乘法和加法之后，得到一个函数对（j,j+1）。它们就是这个二维数组访问的下标。

最后，我们观察第四个数组访问Y［1,2］。这个访问是一个常量，毫无疑问，矩阵F是全零矩阵。因此，循环下标的向量i没有出现在访问函数中。