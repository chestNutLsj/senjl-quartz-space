## 3.3　词法单元的规约

正则表达式是一种用来描述词素模式的重要表示方法。虽然正则表达式不能表达出所有可能的模式，但是它们可以高效地描述在处理词法单元时要用到的模式类型。在这一节中，我们将研究正则表达式的形式化表示方法。在3.5节中，我们将看到如何将这些表达式运用到词法分析器生成工具中。然后，3.7节显示了如何将正则表达式转换成能够识别所描述的词法单元的自动机，并由此建立一个词法分析器。

我们会不会用完缓冲区空间？

在大多数现代程序设计语言中，词素很短，向前看一到两个字符就能够确定一个词素，所以数千字节大小的缓冲区就已经足够了。使用3.2.1节中介绍的双缓冲区方案肯定没问题。但是仍然存在一些风险。比如，如果字符串包含很多行，那么我们就有可能面临单个词素的长度超过N的情况。为了避免长字符串引起的问题，我们可以把它们看作不同组成部分的连接，每个组成部分对应于该字符串的一行。比如，在Java语言中，人们习惯于将一个字符串写成多个部分，每个部分占一行，并在每个部分的结尾加上运算符+，将它们连接起来。

当需要向前看任意多个字符时，就会出现一个更加严重的问题。比如，像PL/I这样的语言没有将关键字作为保留字来处理，也就是说，你可以使用一个和某个关键字（比如DECLARE）同名的标识符。当词法分析器处理以`DECLARE（ARG1,ARG2,`……开头的PL/I程序的文本时，它不能确定`DECLARE`究竟是一个关键字（此时后面的`ARG1`等是被声明的变量），还是一个带有参数的过程名。因为这个原因，大多数现代程序设计语言都保留关键字。然而，如果不保留关键字，我们可以把像DECLARE这样的关键字当作一个二义性的标识符，由语法分析器来解决这个问题。此时语法分析器就需要在符号表中查询有关信息。