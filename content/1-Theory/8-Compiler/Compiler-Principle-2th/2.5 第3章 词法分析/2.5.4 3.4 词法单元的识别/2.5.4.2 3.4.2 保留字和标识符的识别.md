### 3.4.2　保留字和标识符的识别

识别关键字及标识符时有一个问题要解决。通常，像`if`或`then`这样的关键字是被保留的（在我们正在使用的例子中就是如此），因此虽然它们看起来很像标识符，但它们不是标识符。因此，尽管我们通常使用如图3-14所示的状态转换图来寻找标识符的词素，但这个图也可以识别出连续使用的例子中的关键字`if、then`及`else`。

![098-2](../Images/image04069.jpeg)

图3-14　id和关键字的状态转换图

我们可以使用两种方法来处理那些看起来很像标识符的保留字：

1）初始化时就将各个保留字填入符号表中。符号表条目的某个字段会指明这些串并不是普通的标识符，并指出它们所代表的词法单元。我们已经假设图3-14中使用了这种方法。当我们找到一个标识符时，如果该标识符尚未出现在符号表中，就会调用installID将此标识符放入符号表中，并返回一个指针，指向这个刚找到的词素所对应的符号表条目。当然，任何在词法分析时不在符号表中的标识符都不可能是一个保留字，因此它的词法单元是id。函数getToken查看对应于刚找到的词素的符号表条目，并根据符号表中的信息返回该词素所代表的词法单元名——要么是id，要么是一个在初始化时就被加入到符号表中的关键字词法单元。

2）为每个关键字建立单独的状态转换图。图3-15是关键字then的一个例子。请注意，这样的状态转换图包含的状态表示看到该关键字的各个后续字母后的情况，最后是一个“非字母或数字”的测试，也就是检查后面是否为某个不可能成为标识符一部分的字符。有必要检查该标识符是否结束，否则在碰到词素像`thenextvalue`这样以`then`为前缀的id词法单元时，我们可能会错误地返回词法单元`then`。如果采用这个方法，我们必须设定词法单元之间的优先级，使得当一个词素同时匹配id的模式和关键字的模式时，优先识别保留字词法单元，而不是id词法单元。我们并没有在例子中使用这个方法，这也是我们没有对图3-15中的状态进行编号的原因。

![098-3](../Images/image04070.jpeg)

图3-15　假想的关键字`then的状态转换图`