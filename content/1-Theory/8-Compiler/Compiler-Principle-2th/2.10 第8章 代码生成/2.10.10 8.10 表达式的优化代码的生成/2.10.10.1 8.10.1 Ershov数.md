### 8.10.1　Ershov数

一开始，我们给一个表达式树的每个结点各赋予一个数值。该数表示如果我们不把任何临时值存放回内存的话，计算该表达式需要多少个寄存器。这些数有时被称为Ershov数（Ershov number）。这是根据A.Ershov命名的，他为只有一个算术寄存器的机器使用了类似的方案。对我们的机器模型而言，计算Ershov数的规则如下：

1）所有叶子结点的标号为1。

2）只有一个子结点的内部结点的标号和其子结点的标号相同。

3）具有两个子结点的内部结点的标号按照如下方式确定：

① 如果两个子结点的标号不同，那么选择较大的标号。

② 如果两个子结点的标号相同，那么它的标号就是子结点的标号值加一。

例8.23　在图8-23中，我们可以看到一个表达式树（其中的运算符已经被省略）。这个树可能是表达式（a-b）+e×（c+d）的树，或者说是下面的三地址代码的树：

![380-1](../Images/image04614.jpeg)

![380-2](../Images/image04615.jpeg)

图8-23　一个用Ershov数标号的树

根据规则（1），该树的五个叶子结点的标号都是1。然后，我们可以给对应于`t1=a-b`的内部结点加上标号，因为它的两个子结点都已经被加上了标号。应用规则3，该结点的标号是它的子结点的标号加上1，也就是2。对应于`t2=c+d`的结点的标号的计算方式与此类似。

现在我们可以计算对应于`t3=e*t2`的结点的标号。它的子结点的标号是1和2，因此根据规则3，`t3`对应结点的标号是其中的较大值，即2。最后计算根结点，即对应于`t4=t1+t3`的结点。它的两个子结点的标号都是2，因此它的标号是3。