### 8.5.1　基本块的DAG表示

很多重要的局部优化技术首先把一个基本块转换成为一个DAG（有向无环图）。在6.11节中，我们介绍了用于表示简单表达式的DAG。这个想法被自然地扩展到在一个基本块中创建的表达式的集合。我们按照如下方式为一个基本块构造DAG：

1）基本块中出现的每个变量有一个对应的DAG的结点表示其初始值。

2）基本块中的每个语句s都有一个相关的结点N。N的子结点是基本块中的其他语句的对应结点。这些语句是在s之前、最后一个对s所使用的某个运算分量进行定值的语句。[^1]

3）结点N的标号是s中的运算符；同时还有一组变量被关联到N，表示s是在此基本块内最晚对这些变量进行定值的语句。

4）某些结点被指明为输出结点（output node）。这些结点的变量在基本块的出口处活跃。也就是说，这些变量的值可能以后会在流图的另一个基本块中被使用到。计算得到这些“活跃变量”是全局数据流分析的问题，将在9.2.5节中讨论。

基本块的DAG表示使我们可以对基本块所代表的代码进行一些转换，以改进代码的质量。

1）我们可以消除局部公共子表达式（local common subexpression）。所谓公共子表达式就是重复计算一个已经计算得到的值的指令。

2）我们可以消除死代码（dead code），即计算得到的值不会被使用的指令。

3）我们可以对相互独立的语句进行重新排序，这样的重新排序可以降低一个临时值需要保持在寄存器中的时间。

4）我们可以使用代数规则来重新排列三地址指令的运算分量的顺序。这么做有时可以简化计算过程。