### 8.4.3　流图

当将一个中间代码程序划分成为基本块之后，我们用一个流图来表示它们之间的控制流。流图的结点就是这些基本块。从基本块B到基本块C之间有一条边当且仅当基本块C的第一个指令可能紧跟在B的最后一个指令之后执行。存在这样一条边的原因有两种：

- 有一个从B的结尾跳转到C的开头的条件或无条件跳转语句。
- 按照原来的三地址语句序列中的顺序，C紧跟在B之后，且B的结尾不存在无条件跳转语句。

我们说B是C的前驱（predecessor），而C是B的一个后继（successor）。

我们通常会增加两个分别称为“入口”（entry）和“出口”（exit）的结点。它们不和任何可执行的中间指令对应。从入口到流图的第一个可执行结点（即包含了中间代码的第一个指令的基本块）有一条边。从任何包含了可能是程序的最后执行指令的基本块到出口有一条边。如果程序的最后指令不是一个无条件转移指令，那么包含了程序的最后一条指令的基本块是出口结点的一个前驱。但任何包含了跳转到程序之外的跳转指令的基本块也是出口结点的前驱。

例8.8　从例8.6中构造出的基本块可以生成图8-9中所示的流图。入口结点指向基本块B1，因为B1包含了这个程序的第一个指令。B1的唯一后继是B2，因为B1的结尾不是一个无条件跳转指令，且B2的首指令紧跟在B1的结尾指令之后。

![356-1](../Images/image04551.jpeg)

图8-9　基于图8-7构造的流图

基本块B3有两个后继。其中的一个是它本身，因为B3的首指令（即指令3）是B3结尾处的条件跳转指令（即指令9）的目标。另一个后继是B4，因为控制流可能穿越B3结尾处的条件跳转指令而到达B4的首指令。

只有B6指向流图的出口结点，因为到达紧跟在流图对应的程序之后的代码的唯一方式是穿越B6结尾处的条件跳转指令。