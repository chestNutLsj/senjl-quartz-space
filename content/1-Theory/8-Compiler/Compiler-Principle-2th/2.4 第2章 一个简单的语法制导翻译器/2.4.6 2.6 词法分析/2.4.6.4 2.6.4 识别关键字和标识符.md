### 2.6.4　识别关键字和标识符

大多数程序设计语言使用`for`、`do`、`if`这样的固定字符串作为标点符号，或者用于标识某种构造。这些字符串称为关键字（keyword）。

字符串还可以作为标识符，来为变量、数组、函数等命名。为了简化语法分析器，语言的文法通常把标识符当作终结符号进行处理。当某个标识符出现在输入中时，语法分析器都会得到相同的终结符号，如id。例如，在处理如下输入时

![064-2](../Images/image04006.jpeg)

语法分析器处理的是终结符号序列 id = id + id。词法单元id有一个属性保存它的词素。将词法单元写作元组形式，我们看到输入流（2.6）的元组序列是

![064-3](../Images/image04007.jpeg)

关键字通常也满足标识符的组成规则，因此我们需要某种机制来确定一个词素什么时候组成一个关键字，什么时候组成一个标识符。如果将关键字作为保留字，也就是说，如果它们不能被用作标识符，这个问题相对容易解决。此时，只有当一个字符串不是关键字时它才能组成一个标识符。

本节中的词法分析器使用一个表来保存字符串，从而解决了如下两个问题：

- 单一表示。一个字符串表可以将编译器的其余部分和表中字符串的具体表示隔离开，因为编译器后面的步骤可以只使用指向表中字符串的指针或引用。操作引用要比操作字符串本身更加高效。
- 保留字。要实现保留字，可以在初始化时在字符串表中加入保留的字符串以及它们对应的词法单元。当词法分析器读到一个可以组成标识符的字符串或词素时，它首先检查这个字符串表中是否有这个词素。如是，它就返回表中的词法单元，否则返回带有终结符号id的词法单元。

在Java中，使用类Hashtable可以将一个字符串表实现为一张散列表。下面的声明

Hashtable words = new Hashtable()；

将words初始化为一个将键映射到值的默认散列表。我们将使用它来实现从词素到词法单元的映射。图2-31中的伪代码使用get操作来查找保留字。这个伪代码从输入中读取一个以字母开头、由字母和数位组成的字符串s。我们假定读取的s尽可能地长，即只要词法分析器遇到字母或数位，它就不断从输入中读取字符。当它遇到的不是字母或数位，比如它遇到了空白符，已读取的词素就被复制到缓冲区b中。如果字符串表中已经有一个s的条目，它就返回由words.get得到的词法单元。这里s可能是一个关键字，在表words初始化的时候这个s就已经在表中了；它也可能是一个之前被加入到表中的标识符。如果不存在s对应的条目，那么由id和属性值s组成的词法单元将被加入到字符串表中，并被返回。

![065-1](../Images/image04008.jpeg)

图2-31　区分关键字和标识符