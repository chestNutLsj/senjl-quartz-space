### 2.4.2　预测分析法

递归下降分析方法（recursive-descent parsing）是一种自顶向下的语法分析方法，它使用一组递归过程来处理输入。文法的每个非终结符都有一个相关联的过程。这里我们考虑递归下降分析法的一种简单形式，称为预测分析法（predictive parsing）。在预测分析法中，各个非终结符号对应的过程中的控制流可以由向前看符号无二义地确定。在分析输入串时出现的过程调用序列隐式地定义了该输入串的一棵语法分析树。如果需要，还可以通过这些过程调用来构建一个显式的语法分析树。

图2-19的预测分析器包含了两个过程stmt()和optexpr()，分别对应于图2-16中文法的非终结符号stmt和optexpr。该分析器还包括一个额外的过程match。这个额外过程用来简化stmt和optexpr的代码。过程match（t）将它的参数t和向前看符号比较，如果匹配就前进到下一个输入终结符号。因此，match改变了全局变量lookhead的值，该变量存储了当前正被扫描的输入终结符号。

![055-1](../Images/image03992.jpeg)

图2-19　一个预测分析器的伪代码

分析过程开始时，首先调用文法的开始非终结符号stmt对应的过程。在处理如图2-18所示的输入时，lookhead被初始化为第一个终结符号for。过程stmt执行和如下产生式对应的代码：

stmt → for（optexpr；optexpr；optexpr）stmt

在对应于该产生式体的代码中——即图2-19的过程stmt中处理for语句的case分支——每个终结符都和向前看符号匹配，而每个非终结符都产生一个对相应过程的调用：

match（for）；match（′（′）；

optexpr()；match（′；′）；optexpr()；match（′；′）；optexpr()；

match（′）′）；stmt()；

预测分析需要知道哪些符号可能成为一个产生式体所生成串的第一个符号。更精确地说，令α是一个文法符号（终结符号或非终结符号）串。我们将FIRST（α）定义为可以由α生成的一个或多个终结符号串的第一个符号的集合。如果α就是∈或者可以生成∈，那么∈也在FIRST（α）中。

关于计算FIRST（α）的算法的详细描述将在4.4.2节中给出。这里，我们将使用不具一般性的推导方法来求出FIRST（α）中的符号。通常情况下，α要么以一个终结符号开头，此时该终结符号就是FIRST（α）中的唯一符号；要么α以一个非终结符号开头，且该非终结符的所有产生式体都以某个终结符号开头，那么这些终结符号就是FIRST（α）的所有成员。

例如，对于图2-16中的文法，其FIRST的正确计算如下：

FIRST（stmt）= {expr，if，for，other}

FIRST（expr；）= {expr}

如果有两个产生式A→α和A→β，我们就必须考虑相应的FIRST集合。如果我们不考虑∈产生式，预测分析法要求FIRST（α）和FIRST（β）不相交，那么就可以用向前看符号来确定应该使用哪个产生式。如果向前看符号在FIRST（α）中，就使用α。如果向前看符号在FIRST（β）中，就使用β。