### 10.3.2　基本块的列表调度方法

基本块调度的最简单的方法是以“带有优先级的拓扑排序”访问数据依赖图的各个结点。因为一个数据依赖图中不可能有环，因此总是至少存在一个各个结点之间的拓扑顺序。但是，在所有可能的拓扑排序中，有些排序可能比其他排序更好。我们将在10.3.3节中讨论选择拓扑排序的一些策略。但是现在我们仅仅假设存在某种算法来选择一个较好的拓扑排序。

下面我们将讨论的列表调度算法按照被选中的带优先级的拓扑排序访问各个结点。最后，这些结点并不一定按照它们被访问的顺序进行调度。但是指令被尽可能早地放置在调度方案中，因此指令被调度的顺序往往和它们被访问的顺序差不多。

更详细地讲，算法根据每个结点和之前已调度的结点之间的数据依赖约束，计算出能够执行该结点的最早时间位置。然后，算法根据一个资源预约表来检验该结点所需要的资源是否得到满足。这个资源预约表收集了至今已经分配出去的资源的信息。该结点被安排在最早的能够获得足够资源的时间位置上。

算法10.7　对一个基本块进行列表调度

输入：一个机器-资源向量R=［r1,r2,…］，其中ri是第i种资源的可用单元的数目；一个数据依赖图G=（N,E）。N中的每个运算n的标号是它的资源预约表RTn；E中的每个边e=n1→n2都有标号de，表明了n2不能在n1执行之后的de个时钟周期之内执行。

输出：一个调度方案S。它把N中的每个运算映射到时间位置中。各个运算在方案所确定的时间位置开始执行，就可以保证所有的数据依赖关系和资源约束都得到满足。

方法：执行图10-8中的程序。关于什么是“带优先级的拓扑排序”的讨论将在10.3.3节中给出。

![476-1](../Images/image04810.jpeg)

图10-8　一个列表指令调度算法