### 10.5.6　一个软件流水线化算法

软件流水线化的目标是找到一个具有最小启动间隔的调度方案。这个问题是NP完全的，并且可以被写成一个整数线性规划问题。我们已经说明，如果知道最小的启动间隔，那么调度算法可以在放置各个运算时使用模数资源预约表来避免资源冲突。但是只有当我们找到一个调度方案之后才能知道最小启动间隔是什么。我们怎样才能解开这样的循环套？

我们可以按照上面讨论的方法根据循环的资源需求和依赖环计算得到启动间隔的下界。我们已知启动间隔必须大于这个下界。如果我们可以找到一个调度方案使得启动间隔就是这个下界，那么就找到了最优的调度方案。如果我们找不到这样的调度方案，可以再使用大一点的启动间隔进行尝试，直到找到一个符合要求的调度方案为止。请注意，如果使用启发式搜索而不是穷尽搜索，那么这个过程找到的可能不是最优的调度方案。

我们能否找到接近下界的调度方案依赖于相应数据依赖图的性质以及目标机的体系结构。如果依赖图是无环的，并且每条机器指令只需要一个单元的某种资源，那么我们可以很容易地找到最优的调度方案。如果可用的硬件资源超过了有环的依赖图所需要的资源，那么也很容易找到启动间隔接近于下界的调度方案。对于这些情况，建议一开始就把下界作为初始的启动间隔目标，然后逐渐把目标增加一个时钟周期，并且每增加一次进行一次调度尝试。另一种可能性是使用二分搜索法来寻找启动间隔。我们可以把列表调度法为单次迭代生成的调度方案的长度作为启动间隔的上界。