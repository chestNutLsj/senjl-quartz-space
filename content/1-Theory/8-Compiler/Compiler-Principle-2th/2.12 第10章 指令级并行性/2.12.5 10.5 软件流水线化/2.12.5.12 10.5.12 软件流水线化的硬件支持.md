### 10.5.12　软件流水线化的硬件支持

人们提出了特殊的硬件支持机制来使软件流水线代码的大小降到最低。在Itanium体系结构中的轮转寄存器文件（rotating register file）就是这样的一个例子。轮转寄存器文件有一个基寄存器（base register），可以把基寄存器中的内容加到代码中给定的寄存器编号来得到实际被访问的寄存器。我们只需要在每个迭代的边界上改变基寄存器中的内容，就可以让一个循环中的不同迭代使用不同的寄存器。Itanium体系结构也支持广泛的带断言指令。断言不仅可以把控制依赖转换成数据依赖，它也可以用来避免生成序言代码和尾声代码。一个软件流水线化的循环体中包含了所有在序言和尾声中的指令。我们只需要为稳定状态生成代码，并适当地使用断言来抑制多余的运算，使得代码的运行效果就像是存在一个序言和一个尾声。

虽然Itanium的硬件支持机制提高了经软件流水线化的代码的密度，我们必须知道这种支持机制可不便宜。因为软件流水线化技术主要用于最内层循环，被流水线化处理的循环往往很小。原则上，对于那些预期会用于执行很多软件流水线化的循环且尽可能降低代码大小又很重要的机器，为软件流水线化提供专门的支持机制是合理的。