### 10.2.2　寻找内存访问之间的依赖关系

要检查两个内存访问之间是否有数据依赖关系，我们只需要指出它们是否可能指向同一个内存位置，而不需要知道到底访问哪个位置。比如，虽然我们可能不知道指针p到底指向哪里，但仍然可以指出两个访问`*p`和`*（p+4）`（原文为（`*p）+4`——译者注）不可能指向同一个位置。总的来说，数据依赖关系是不可能在编译时刻完全确定的。除非能够证明两个运算指向不同的位置，否则编译器必须假设它们可能会指向同一个位置。

例10.1　给定下面的代码序列

![468-1](../Images/image04792.jpeg)

除非编译器知道p不可能指向a，否则它必须决定这三个运算需要顺序执行。从语句（1）到语句（2）有一个输出依赖关系，从语句（1）、（2）到语句（3）有两个真依赖关系。

数据依赖分析对于程序所使用的程序设计语言是很敏感的。对于非类型安全的语言，比如C和C++，一个指针可以被强制转换，指向任何类型的数据对象，因此要证明任意一对基于指针的内存访问之间的独立性需要复杂的分析过程。即使对于局部变量和全局标量变量，除非可以证明它们的地址没有被程序中的指令存放到任何地方，它们也有可能通过指针被间接访问。在像Java这样的类型安全的语言中，不同类型的对象一定是相互独立的。类似地，栈中的局部简单变量不可能通过其他的变量名字进行访问。

发现正确的数据依赖关系需要多种不同类型的分析。我们将关注那些主要的问题。如果编译器想要检测一个程序中的所有数据依赖关系，它必须首先解决这些问题，并说明如何使用这些信息进行代码调度。后面的章节将说明这些分析是如何完成的。

数组的数据依赖分析

数组的数据依赖分析问题主要是区分数组元素访问中的下标值。比如，下面的循环

![468-2](../Images/image04793.jpeg)

把数组A的奇数号元素拷贝到紧靠在该元素之前的偶数号元素中去。因为这个循环中所有的读/写运算的位置互不相同，这些访问之间没有任何依赖关系，所以循环中所有的迭代都可以并行执行。数组的数据依赖分析，简称为数据依赖分析（data-dependence analysis），对于数值应用的优化来说是非常重要的。这个主题将在11.6节中详细讨论。

指针别名分析

如果两个指针指向同一个对象，我们就说它们互为别名（aliased）。指针别名的分析很困难，原因是一个程序中具有很多可能互为别名的指针。随着时间的发展，它们中的每个都可能指向无限多个动态对象。为了得到精确的信息，进行指针别名分析时必须跨越程序中的各个函数。这个主题从12.4节开始讨论。

过程间分析

对于通过引用传递参数的语言，需要使用过程间分析来确定是否同一个变量被当作两个或多个不同的参数进行传递。这类别名看起来可能会在不同的参数之间建立依赖关系。类似地，全局变量可能被用作参数，由此会建立参数访问和全局变量访问之间的依赖。在确定这些别名时，第12章中讨论的过程间分析技术是必需的。