### 10.2.5　控制依赖

对一个基本块内的运算进行调度是相对容易的。因为一旦控制流到达基本块的开头，所有的指令都必然会执行。只要满足所有的数据依赖，一个基本块内的指令可以进行任意重新排序。遗憾的是，基本块通常都很小，对非数值程序而言尤其如此。一个基本块平均只有大约五条指令。另外，同一个基本块内的运算经常是紧密相关的，因此很少有并行性。可见，利用基本块之间的并发性是至关重要的。

一个优化后的程序必须执行原程序中的所有运算。它可以比原程序执行更多的指令，前提是额外增加的指令没有改变程序所做的计算。为什么执行额外的指令能够加快一个程序的执行速度？如果我们知道一条指令可能会执行，而且有空闲的资源来“免费”执行这个指令，我们就可以先投机性地（speculatively）执行这条指令。如果这个投机是正确的，那么程序的执行速度就会变快。

如果指令i2的结果决定了指令i1是否执行，那么就说指令i1是控制依赖（control-dependent）于指令i2的。控制依赖的概念和块结构程序中的嵌套层次相对应。明确地说，在if-else语句

![471-1](../Images/image04799.jpeg)

中，`s1`和`s2`是控制依赖于c的。类似地，在while语句

![471-2](../Images/image04800.jpeg)

中，循环体s控制依赖于c。

例10.4　在代码片段

![471-3](../Images/image04801.jpeg)

中，语句`b=a*a`和`d=a+c`和此片断中的其他部分都没有数据依赖关系。语句`b=a*a`依赖于比较表达式a>t。但是，语句`d=a+c`不依赖于这个比较表达式，它可以在任何时刻运行。假设乘法运算a*a不会引起任何副作用，那么它就可以被投机地执行，前提是只有在发现a大于t之后才把结果写入b中。