### 6.5.1　类型检查规则

类型检查有两种形式：综合和推导。类型综合（type synthesis）根据子表达式的类型构造出表达式的类型。它要求名字先声明再使用。表达式E1+E2的类型是根据E1和E2的类型定义的。一个典型的类型综合规则具有如下形式：

![263-1](../Images/image04415.jpeg)

这里，f和x表示表达式，而s→t表示从s到t的函数。这个针对单参数函数的规则可以推广到带有多个参数的函数。只要稍做修改，规则（6.8）就可以用于E1+E2，我们只需要把它看作一个函数应用add（E1，E2）就可以了[^6]。

类型推导（type inference）根据一个语言结构的使用方式来确定该结构的类型。先看一下6.5.4节中的例子，令null是一个测试列表是否为空的函数。那么，根据这个函数的使用null（x），我们可以指出x必须是一个列表类型。列表x中的元素类型是未知的，我们所知道的全部信息是：x是一个列表类型，其元素类型当前未知。

代表类型表达式的变量使得我们可以考虑未知类型。我们可以用希腊字母α、β等作为类型表达式中的类型变量。

一个典型的类型推导规则具有下面的形式：

![264-3](../Images/image04416.jpeg)

在类似ML这样的语言中需要进行类型推导。ML语言会检查类型，但是不需要对名字进行声明。

在本节中，我们考虑表达式的类型检查。检查语句的规则和检查表达式类型的规则类似。例如，我们可以把条件语句“if（E）S；”看作是对E和S应用if函数。令特殊类型void表示没有值的类型，那么if函数将被应用在一个布尔型和一个void型的对象上。此函数的结果类型是void。