### 6.3.1　类型表达式

类型自身也有结构，我们使用类型表达式（type expression）来表示这种结构：类型表达式可能是基本类型，也可能通过把被称为类型构造算子的运算符作用于类型表达式而得到。基本类型的集合和类型构造算子根据被检查的具体语言而定。

例6.8　数组类型`int［2］［3］`表示“由两个数组组成的数组，其中的每个数组各包含3个整数”。它的类型表达式可以写成array（2，array（3，integer））。该类型可以用如图6-14所示的树来描述。array运算符有两个参数：一个数字和一个类型。

![253-1](../Images/image04397.jpeg)

图6-14　`int［2］［3］`的类型表达式

我们将使用如下的类型表达式的定义：

- 基本类型是一个类型表达式。一种语言的基本类型通常包括boolean、char、integer、float和void。最后一个类型表示“没有值”。
- 类名是一个类型表达式。
- 将类型构造算子array作用于一个数字和一个类型表达式可以得到一个类型表达式。
- 一个记录是包含有名字段的数据结构。将record类型构造算子应用于字段名和相应的类型可以构造得到一个类型表达式。在6.3.6节中，记录类型的实现方法是把构造算子record应用于包含了各个字段对应条目的符号表。
- 使用类型构造算子→可以构造得到函数类型的类型表达式。我们把“从类型s到类型t的函数”写成s→t。在6.5节中讨论类型检查时，函数类型是有用的。
- 如果s和t是类型表达式，则其笛卡儿积s×t也是类型表达式。引入笛卡儿积主要是为了保证定义的完整性。它可以用于描述类型的列表或元组（例如，用于表示函数参数）。我们假定×具有左结合性，并且其优先级高于→。
- 类型表达式可以包含取值为类型表达式的变量。在6.5.4节中将用到编译器产生的类型变量。

图是表示类型表达式的一种比较方便的方法。可以修改6.1.2节中给出的值编码方法，以构造一个类型表达式的DAG。图的内部结点表示类型构造算子，而叶子结点是基本类型、类型名或类型变量。6.1.4给出了一棵树的实例[^3]。

类型名和递归类型

在C++和Java中，类一旦被定义，其名字就可以被用来表示类型名。例如，考虑下列程序片段中的Node类。

![254-1](../Images/image04398.jpeg)

类型名还可以用来定义递归类型，在像链表这样的数据结构中要用到递归类型。一个列表元素的伪代码如下：

![254-2](../Images/image04399.jpeg)

它定义了一个递归类型`Cell`。这个类包括一个`info`字段和另一个`Cell`类型的字段`next`。在C中可以通过记录和指针来定义类似的递归类型。本章介绍的技术也适用于递归类型。