### 6.4.2　增量翻译

`code`属性可能是很长的字符串，因此就像5.5.2节中讨论的那样，它们通常是用增量的方式生成的。因此，我们不会像图6-19所示的那样构造E.code，我们可以设法像图6-20中那样只生成新的三地址指令。在这个增量方式中，gen不仅要构造出一个新的三地址指令，还要将它添加到至今为止已生成的指令序列之后。指令序列可以暂时放在内存中以便进一步处理，也可以增量地输出。

图6-20中的翻译方案和图6-19中的语法制导定义产生相同的代码。采用增量方式时不需再用到code属性，因为对gen的连续调用将生成一个指令序列。例如，图6-20中对应于E→E1+E2的语义规则直接调用gen产生一条加法指令。在此之前，翻译方案已经生成了计算E1的值并放入E1.addr、计算E2的值并放入E2.addr的指令序列。

![259-2](../Images/image04409.jpeg)

图6-20　增量生成表达式的三地址代码

图6-20的方法也可以用来构造语法树，对应于E→E1+E2的语义动作使用构造算子生成新的结点。规则如下：

E→E1+E2 {E.addr=new Node（′+′，E1.addr，E2.addr）；}

这里，属性addr表示的是一个结点的地址，而不是某个变量或常量。