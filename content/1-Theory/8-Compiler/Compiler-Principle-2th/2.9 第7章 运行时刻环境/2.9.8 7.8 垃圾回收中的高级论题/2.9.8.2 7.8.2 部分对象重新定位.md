### 7.8.2　部分对象重新定位

就像从7.6.4节开始讨论的，拷贝或压缩回收器的优势在于消除碎片。然而，这些回收器需要不小的开销。压缩回收器需要在垃圾回收结束时移动所有的对象并更新所有的引用。拷贝回收器在跟踪过程中就找出可达对象的位置。如果跟踪采用增量式执行方式，我们要么对增变者的每个引用进行转换，要么到最后才移动所有的对象并更新它们的引用。这两种做法都是比较昂贵的，对大型堆区来说尤其如此。

我们可以改用一个拷贝世代垃圾回收器。它在回收年轻对象并减少碎片方面很有效，但是在回收成熟对象时比较昂贵。我们可以使用列车算法来限制每次分析时处理的成熟数据的数量。然而，列车算法的代价和每个区域的被记忆集的大小相关。

有一种混合型的回收方案，它使用并发跟踪来回收所有不可达对象，同时只移动部分对象。这种方法减少了碎片，又不会因为在每个回收循环中进行重新定位而引起额外的开销。

1）在跟踪开始之前，选择将被清空的一部分堆区。

2）当标记可达对象时，记住所有指向指定区域内的对象的引用。

3）当跟踪完成时，并行地清扫存储空间以回收被不可达对象占用的空间。

4）最后，清空占据指定区域的可达对象，并修正指向被清空对象的引用。