### 9.1.5　复制传播

图9-5中的基本块B5可以通过使用两个新转换来消除x，从而得到进一步改进。其中的一个转换考虑形如`u=v`的赋值表达式，这种表达式被称为复制语句（copy statement），或者简称复制。只要我们更加细致地考虑例9.2，很快就会发现一些复制语句。因为常用的公共子表达式消除算法会引入这些复制语句，其他一些优化算法也会引入这样的语句。

例9.3　为了消除图9-6a中的公共子表达式语句`c=d+e`，我们必须使用新的变量t来存放d+e的值。在图9-6b中，赋给变量c的是变量t的值，而不是表达式d+e的值。因为控制流可能经过对a的赋值到达语句`c=b+e`处，也可能经过对b的赋值到达这里，因此把`c=d+e`替换为`c=a或c=b`都是不正确的。

![393-2](../Images/image04643.jpeg)

图9-6　在公共子表达式消除过程中引入的复制语句

隐藏在复制传播转换之后的基本思想是在复制语句`u=v`之后尽可能地用v来替代u。比如，图9-5的基本块B5中的赋值语句`x=t3`是一个复制语句。把复制传播应用于B5会生成图9-7中的代码。这个改变看起来可能不像是一个改进，但是，正如我们将在9.1.6节看到的，它给了我们消除对x赋值的语句的机会。

![394-1](../Images/image04644.jpeg)

图9-7　进行复制传播转换后的基本块B5