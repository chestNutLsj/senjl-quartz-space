### 9.1.7　代码移动

对于优化工作而言，循环（尤其内部循环）是一个重要的地方。因为程序往往会将它们的大部分运行时间花费在循环上。如果我们减少一个内部循环中的指令个数，即使因此增加了该循环外的代码，程序的运行时间也可以减少。

减少循环内部代码数量的一个重要改动是代码移动（code motion）。这个转换处理的是那些不管循环执行多少次都得到相同结果的表达式（即循环不变计算），在进入循环之前就对它们求值。请注意，“在循环之前”的说法假设了存在一个循环入口。所谓循环入口就是一个基本块，所有循环外部到循环的跳转指令都以它为目标（见8.4.5节）。

例9.5　在下面的while语句中，对limit-2的求值是一个循环不变计算：

![394-5](../Images/image04648.jpeg)

进行代码移动之后将得到如下的等价代码：

![394-6](../Images/image04649.jpeg)

现在，limit-2的计算只在进入循环之前被执行一次。之前，如果我们重复循环体n次，就会对limit-2计算n+1次。