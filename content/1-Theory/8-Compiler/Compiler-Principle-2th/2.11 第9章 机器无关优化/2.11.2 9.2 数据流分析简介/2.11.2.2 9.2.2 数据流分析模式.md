### 9.2.2　数据流分析模式

在所有的数据流分析应用中，我们都会把每个程序点和一个数据流值（data-flow value）关联起来。这个值是在该点可能观察到的所有程序状态的集合的抽象表示。所有可能的数据流值的集合称为这个数据流应用的域（domain）。比如，到达定值的数据流值的域是程序的定值集合的所有子集的集合。某个数据流值是一个定值的集合，而我们希望把程序中的每个点和可能到达该点的定值的精确集合关联起来。如上面讨论的，对于抽象方式的选择依赖于分析的目标。考虑到效率问题，我们只跟踪相关的信息。

我们把每个语句s之前和之后的数据流值分别记为IN［s］和OUT［s］。数据流问题（data-flow problem）就是要对一组约束求解。这组约束对所有的语句s限定了IN［s］和OUT［s］之间的关系。约束分为两种：基于语句语义（传递函数）的约束和基于控制流的约束。

传递函数

在一个语句之前和之后的数据流值受该语句的语义的约束。比如，假设我们的数据流分析涉及确定各个程序点上各变量的常量值。如果变量a在执行语句`b=a`之前的值为v，那么在该语句之后a和b的值都是v。一个赋值语句之前和之后的数据流值的关系被称为传递函数（transfer function）。

传递函数有两种风格：信息可能沿着执行路径向前传播，或者沿着执行路径逆向流动。在一个前向数据流问题中，一个语句s的传递函数（通常被记为fs）以语句前的数据流值作为输入，并产生语句之后的新数据流值。也就是

OUT［s］=fs（IN［s］）

反过来，在一个逆向流问题中，语句s的传递函数fs把一个语句之后的数据流值转变成为语句之前的新数据流值。也就是：

IN［s］=fs（OUT［s］）

控制流约束

第二组关于数据流值的约束是从控制流中得到的。基本块中的控制流很简单。如果一个基本块B由语句s1，s2，…，sn顺序组成，那么si输出的控制流值[^3]和输入si+1的控制流值相同。也就是

IN［si+1］=OUT［si］　i=1，2，…，n-1

基本块之间的控制流边会生成一个基本块的最后一个语句和后继基本块的第一个语句之间的约束，这些约束更加复杂。比如，如果对可能到达一个程序点的所有定值感兴趣，那么到达一个基本块的首语句的定值的集合就是到达它的各个前驱基本块的最后一个语句之后的定值集合的并集。下一节将给出基本块之间数据流的细节。