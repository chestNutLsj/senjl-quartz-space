### 6.9.5　条件转移指令

“jcc”不是一条指令，而是一个指令族（簇），功能是根据某些条件进行转移，比如前面讲过的jns，意思是SF≠1（那就是SF=0 了）则转移。方便起见，处理器一般提供相反的指令，如js，意思是SF=1 则转移。爱上网的朋友们容易把它理解成“奸商”。

在汇编语言源代码里，条件转移指令的操作数是标号。编译成机器码后，操作数是一个立即数，是相对于目标指令的偏移量。在16 位处理器上，偏移量可以是8 位（短转移）或者16 位（相对近转移）。

相似地，jz 的意思是ZF 标志为1 则转移；jnz 的意思是ZF 标志不为1（为0）则转移。

jo 的意思是OF 标志为1 则转移，jno 的意思是OF 标志不为1（为0）则转移。

jc 的意思是CF 标志为1 则转移，jnc 的意思是CF 标志不为1（为0）则转移。

jp 的意思是PF 标志为1 则转移，jnp 的意思是PF 标志不为1（为0）则转移。爱上网的朋友们注意了，jp 可不是“极品”的意思。

转移指令必须出现在影响标志的指令之后，比如：

![img](../0-Assets/Epubook/x86汇编语言从实模式到保护模式_李忠_等_Z_Library/images/00181.jpeg)

经验证明，像这种水到渠成的情况是很少的，多数时候，你会遇到一些和标志位关系不太明显的问题，比如，当AX 寄存器里的内容为0x30 的时候转移，或者当AX 寄存器里的内容小于0xf0的时候转移，再或者，当AX 寄存器里的内容大于寄存器BX 里的内容时转移，这该怎么办呢？

好在处理器提供了比较指令cmp，它需要两个操作数，目的操作数可以是8 位或者16 位通用寄存器，也可以是8 位或者16 位内存单元；源操作数可以是与目的操作数宽度一致的通用寄存器、内存单元或者立即数，但两个操作数同时为内存单元的情况除外。比如：

![img](../0-Assets/Epubook/x86汇编语言从实模式到保护模式_李忠_等_Z_Library/images/00182.jpeg)

cmp 指令在功能上和sub 指令相同，唯一不同之处在于，cmp 指令仅仅根据计算的结果设置相应的标志位，而不保留计算结果，因此也就不会改变两个操作数的原有内容。cmp 指令将会影响到CF、OF、SF、ZF、AF 和PF 标志位。

比较是拿目的操作数和源操作数比，重点关心的是目的操作数。拿指令cmp ax,bx 来说，我们关心的是AX 中的内容是否等于BX 中的内容，AX 中的内容是否大于BX 中的内容，AX 中的内容是否小于BX 中的内容，等等，AX 是被测量的对象，BX 是测量的基准。比较的结果如表6-1 所示。

表6-1　各种比较结果和相应的条件转移指令

![img](../0-Assets/Epubook/x86汇编语言从实模式到保护模式_李忠_等_Z_Library/images/00183.jpeg)

续表

![img](../0-Assets/Epubook/x86汇编语言从实模式到保护模式_李忠_等_Z_Library/images/00184.jpeg)

非常显而易见的是，如果你英语基础比较好，认识上面那些单词的话，这些指令都可以在短时间内轻松记住。英语基础不太好的人也不要灰心，事实上，根本不需要记住这些指令和它们的测试条件，因为我们平时很少用得了这么多。需要的时候再回过头来查查，这是个好办法，时间一长，自然就记住了。

最后一个要讲述的条件转移指令是jcxz（jump if CX is zero），意思是当CX 寄存器的内容为零时则转移。执行这条指令时，处理器先测试寄存器CX 是否为零。例如：

![img](../0-Assets/Epubook/x86汇编语言从实模式到保护模式_李忠_等_Z_Library/images/00185.jpeg)

这里，“show”是程序中的一个标号。执行这条指令时，如果CX 寄存器的内容为零，则转移；否则不转移，继续往下执行。

检测点6.4

1．ZF 标志位和与该标志位有关的条件转移指令用得非常频繁，但很多人容易在ZF 标志位上犯糊涂，以为计算结果为零时，ZF 为“0”。为了证明你不糊涂，请填空：当ZF=（ ）时，表明计算结果为零；jz 指令的意思是当ZF=（ ），即计算结果为（ ）时转移；je 指令的意思是当ZF=（ ），即计算结果为（ ）时转移；jnz 指令的意思是当ZF=（ ），即计算结果不为（ ）时转移；jne 指令的意思是当ZF=（ ），即计算结果不为（ ）时转移。

2．写一小段程序，先比较寄存器AX 和BX 中的数值，然后，当AX 的内容大于BX 的内容时，转移到标号lbb 处执行；AX 的内容等于AX 的内容时，转移到标lbz 处执行；AX 的内容小于BX 的内容时，转移到标号lbl 处执行。