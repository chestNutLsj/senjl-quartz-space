### 9.3.3　从键盘读字符并显示

代码清单9-2 在框架上和前面的用户程序是一致的，差别在于代码段的功能上。

代码清单9-2 第28～32 行用于初始化各个段寄存器，这和以前的做法是相同的。

第34～42 行用于在屏幕上显示字符串，采用的是循环的方法。循环用的是loop 指令，为此，第34 行用于计算字符串的长度，并传送到寄存器CX 中，以控制循环的次数。第35 行用于取得字符串的首地址。

向屏幕上写字符使用的是BIOS 中断，具体地说就是中断0x10 的0x0e 号功能，该功能用于在屏幕上的光标位置处写一个字符，并推进光标位置。第38～40 行分别按规范的要求准备各个参数，执行软中断。

第41、42 行将递增寄存器BX 中的偏移地址，以指向下一个字符在数据段中的位置。然后，loop 指令将寄存器CX 的内容减1，并在其不为零的情况下返回到循环体开始处，继续显示下一个字符。

剩下的工作内容既复杂，又简单。复杂是指，从键盘读取你按下的那个键，并把它显示在屏幕上，很复杂，需要访问硬件，写一大堆指令。简单是指，因为有了BIOS 功能调用，这只需几条语句就能完成。

第45、46 行使用软中断0x16 从键盘读字符，需要在寄存器AH 中指定0x00 号功能。该中断返回后，寄存器AL 中为字符的ASCII 码。

第48～50 行又一次使用了int 0x10 的0x0e 号功能，把从键盘取得的字符显示在屏幕上。

第52 行，执行一个无条件转移指令，重新从键盘读取新的字符并予以显示。