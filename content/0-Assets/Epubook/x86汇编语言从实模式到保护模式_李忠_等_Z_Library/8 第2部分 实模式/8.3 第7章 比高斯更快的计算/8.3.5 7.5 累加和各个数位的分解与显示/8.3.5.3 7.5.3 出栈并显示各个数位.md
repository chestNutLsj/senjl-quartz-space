### 7.5.3　出栈并显示各个数位

压栈的次数（数位的个数）取决于AX 中的数有多大，位于寄存器CX 中。数位是按“个位”、“十位”、“百位”、“千位”、“万位”的顺序依次压栈的（实际情况取决于数的大小），出栈正好相反。所以，可以顺序将它们弹出栈并显示在屏幕上。

源程序第57 行，pop dx 指令的功能是将逻辑地址SS:SP 处的一个字弹出到寄存器DX 中，然后将SP 的内容加上操作数的字长（2）。

和push 指令一样，pop 指令的操作数可以是16 位的寄存器或者内存单元。例如：

![img](../0-Assets/Epubook/x86汇编语言从实模式到保护模式_李忠_等_Z_Library/images/00211.jpeg)

pop 指令执行时，处理器将栈段寄存器SS 的内容左移4 位，再加上栈指针寄存器SP 的内容，形成20 位的物理地址访问内存，取得所需的数据。然后，将SP 的内容加操作数的字长，以指向下一个栈位置。

pop 指令不影响任何标志位。

源程序第58 行将弹出的数据写入显示缓冲区。索引寄存器DI 的内容是在前面显示字符串时用过的，期间一直没有改变过，它现在指向显示缓冲区中字符串之后的位置。

接着，源程序第59～61 行，将字符显示属性写入字符之后的单元，并再次递增DI 以指向显示缓冲区中下一个字符的位置。

源程序第62 行，每次执行loop 指令时，处理器都是先将寄存器CX 减一。当所有的数位都弹出和显示以后，CX 必定为零，这将导致退出循环。

当处理器最后一次执行出栈操作后，栈指针寄存器SP 的内容将恢复到最开始设置时的状态，即它的内容重新为0。