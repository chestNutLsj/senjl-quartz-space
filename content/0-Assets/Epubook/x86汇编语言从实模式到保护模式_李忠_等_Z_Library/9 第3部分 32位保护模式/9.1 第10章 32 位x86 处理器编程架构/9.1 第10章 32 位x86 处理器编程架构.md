   

# 第10章　32 位x86 处理器编程架构

所谓处理器架构，或者处理器编程架构，是指一整套的硬件结构，以及与之相适应的工作状态，这其中的灵魂部分就是一种设计理念，决定了处理器的应用环境和工作模式，也决定了软件开发人员如何在这种模式下解决实际问题。架构内的资源对程序员来说是可见的、可访问的，受程序的控制以改变处理器的运行状态；非架构的资源取决于具体的硬件实现。

处理器架构实际上是不断扩展的，新处理器必须延续旧的设计思路，并保持兼容性和一致性；同时还会有所扩充和增强。

Intel 32 位处理器架构简称IA-32（Intel Architecture，32-bit），是以1978 年的8086 处理器为基础发展起来的。在那个时候，他们只是想造一款特别牛的处理器，也没考虑到架构。尽管那些人是专家，但和我们一样不是千里眼，这是很正常的。

正如我们已经知道的，8086 有20 根地址线，可以寻址1MB 内存。但是，它内部的寄存器是16 位的，无法在程序中访问整个1MB 内存。所以，它也是第一款支持内存分段模型的处理器。还有，8086 处理器只有一种工作模式，即实模式。当然，在那时，还没有实模式这一说。

由于8086 处理器的成功，推动着Intel 公司不断地研发更新的处理器，32 位的时代就这样到来了。到目前为止，到底有多少种类型，我也说不清楚。尽管8086 是16 位的处理器，但它也是32 位架构内的一部分。原因在于，32 位的处理器架构是从8086 那里发展来的，是基于8086 的，具有延续性和兼容性。

就我们曾经用过的产品而言，32 位的处理器有32 根地址线，数据线的数量是32 根或者64根。特别是最近最新的处理器，都是64 根。因此，它可以访问232，即4GB 的内存，而且每次可以读写连续的4 字节或者8 字节，这称为双字（Double Word）或者4 字（Quad Word）访问。当然，如果你要按字节或者字来访问内存，也是允许的。

我总说，处理器虽小，功能却异常复杂。要想把32 位处理器的所有功能都解释清楚，不是一件简单的事情。它不单单是地址线和数据线的扩展，实际上还有更多的部分，包括高速缓存、流水线、浮点处理部件、多处理器（核）管理、多媒体扩展、乱序执行、分支预测、虚拟化、温度和电源管理等。在这本书里，我的一个基本原则是，如果你不能讲清楚，干脆就不要提它。因此，我只讲那些现在用得上的东西。