### 14.5.4　在Bochs 中调试程序的新方法

随着本书内容的深入，程序会越来越复杂，但一般不会出什么问题，因为我都调试好了。当然，你可能想在此基础上做一些改动，实现其他一些功能。在这种情况下，每一次运行时能得到预期结果的可能性微乎其微。不过不用担心，使用本书前面讲过的调试技术，你一定能够找到问题所在。比如，你可以使用“info gdt”指令察看GDT 中的段描述符和门描述符。

本章中涉及到两个新的系统寄存器LDTR 和TR，要察看它们的内容，可以使用以前讲过的Bochs 调试指令“sreg”；为了察看局部描述符表LDT 的所有内容，可以使用“info ldt”；要察看任务状态段TSS 的内容，可以使用“info tss”。注意，显示LDT 和TSS 的内容时，Bochs 要先从处理器的TR 和LDTR 寄存器获取基地址和界限信息。因此，显示的是当前任务的LDT 和TSS。如图14-26 所示，这里显示了在执行代码清单14-1 的第851 行“ltr [ecx+0x18]”之后，用“info tss”命令显示的TSS 状态。

![img](../0-Assets/Epubook/x86汇编语言从实模式到保护模式_李忠_等_Z_Library/images/00647.jpeg)

图14-26　用info tss 命令显示TSS 段的内容

检测点14.3

如图14-26，为什么该任务的TSS 中，所有段寄存器和通用寄存器的值都是0 而不影响任务的执行？