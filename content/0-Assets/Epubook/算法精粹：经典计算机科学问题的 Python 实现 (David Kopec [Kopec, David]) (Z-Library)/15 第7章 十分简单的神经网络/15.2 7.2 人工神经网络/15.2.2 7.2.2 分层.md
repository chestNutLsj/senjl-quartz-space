### 7.2.2　分层

在典型的前馈人工神经网络中，神经元被分为多个层。每层由一定数量的神经元排成行或列构成，是行还是列由示意图而定，两者是等价的。在下面将要构建的前馈网络中，信号总是从一层单向传递到下一层。每层中的神经元发送其输出信号，作为下一层神经元的输入。每层的每个神经元都与下一层的每个神经元相连。

第一层称为输入层，它从某个外部实体接收信号。最后一层称为输出层，其输出通常必须经由外部角色解释才能得出有意义的结果。输入层和输出层之间的层称为隐藏层。在本章中，我们即将构建的简单神经网络中只有一个隐藏层，但深度学习网络的隐藏层会有很多。图7-3呈现了一个简单神经网络中各层的协同工作过程。请注意某一层的输出是如何用作下一层每个神经元的输入的。

![20-0103 图\figure7_3.tif](../0-Assets/Epubook/算法精粹：经典计算机科学问题的%20Python%20实现%20(David%20Kopec%20[Kopec,%20David])%20(Z-Library)/images/00041.jpeg)

图7-3　一个简单的神经网络，这个神经网络有一个包含2个神经元的输入层、一个包含4个  
神经元的隐藏层和一个包含3个神经元的输出层。每层的神经元数量可以是任意多个

这些层只是对浮点数做一些操作。输入层的输入是浮点数，输出层的输出也是浮点数。

显然，这些数字必须代表一些有意义的东西。不妨将此神经网络想象为要对黑白的动物小图片进行分类。也许输入层有100个神经元，代表10像素×10像素的动物图片中每个像素的灰度值，而输出层则有5个神经元，代表此图片是哺乳动物、爬行动物、两栖动物、鱼类或鸟类的可能性。最终的分类可以由浮点数输出值最大的那个输出神经元来确定。假设输出数值分别为0.24、0.65、0.70、0.12和0.21，则此图片将被确定为两栖动物。