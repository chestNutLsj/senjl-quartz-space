### (define …)

The `define` keyword is used in two different syntactic forms. The simplest is:

    `# (define half (/ 1 2))`
    `case` `[``'define'``,` `Symbol``(``name``),` `value_exp``]:`
        `env``[``name``]` `=` `evaluate``(``value_exp``,` `env``)`

Subject:

List starting with `'define'`, followed by a `Symbol` and an expression.

Action:

Evaluate the expression and put its value into `env`, using `name` as key.

Example:

```
>>> 
```

The doctest for this `case` creates a `global_env` so that we can verify that `evaluate` puts `answer` into that `Environment`.

We can use that simple `define` form to create variables or to bind names to anonymous functions, using `(lambda …)` as the `value_exp`.

Standard Scheme provides a shortcut for defining named functions. That’s the second `define` form:

    `# (define (average a b) (/ (+ a b) 2))`
    `case` `[``'define'``,` `[``Symbol``(``name``),` `*``parms``],` `*``body``]` `if` `body``:`
        `env``[``name``]` `=` `Procedure``(``parms``,` `body``,` `env``)`

Subject:

List starting with `'define'`, followed by:

- A list starting with a `Symbol(name)`, followed by zero or more items collected into a list named `parms`.
    
- One or more expressions collected in `body` (the guard ensures that `body` is not empty).
    

Action:

- Create a new `Procedure` instance with the parameter names, the list of expressions as the body, and the current environment.
    
- Put the `Procedure` into `env`, using `name` as key.
    

The doctest in [Example 18-18](#test_case_defun) defines a function named `%` that computes a percentage and adds it to the `global_env`.

##### Example 18-18. Defining a function named `%` that computes a percentage

```
>>> 
```

After calling `evaluate`, we check that `%` is bound to a `Procedure` that takes two numeric arguments and returns a percentage.

The pattern for the second `define` `case` does not enforce that the items in `parms` are all `Symbol` instances. I’d have to check that before building the `Procedure`, but I didn’t—to keep the code as easy to follow as Norvig’s.